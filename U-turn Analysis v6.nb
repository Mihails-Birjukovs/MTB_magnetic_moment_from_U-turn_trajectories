(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    362437,       8236]
NotebookOptionsPosition[    340517,       7892]
NotebookOutlinePosition[    341016,       7910]
CellTagsIndexPosition[    340973,       7907]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Initialization", "Section",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 
   3.890508677778922*^9}},ExpressionUUID->"c917926f-99ec-4cc3-94b7-\
d5273eea8586"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$HistoryLength", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "MaTeX`"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fontSize", "=", "16"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "packageDirectory", ":=", 
   "\"\<D:\\\\Science\\\\NMI (VTPMML)\\\\MHD Project\\\\Image \
Processing\\\\Mathematica Libraries & Packages\\\\Quantile \
Regression\\\\\>\""}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Import", "[", 
    RowBox[{"packageDirectory", "<>", "\"\<QuantileRegression.m\>\""}], "]"}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetOptions", "[", 
    RowBox[{"ListLinePlot", ",", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Mesh", "\[Rule]", "All"}], ",", 
       RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"LabelStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Bold", ",", "fontSize"}], "}"}]}]}], 
      "\[IndentingNewLine]", "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetOptions", "[", 
    RowBox[{"ListPlot", ",", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"LabelStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Bold", ",", "fontSize"}], "}"}]}]}], 
      "\[IndentingNewLine]", "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetOptions", "[", 
    RowBox[{"Plot", ",", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"LabelStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Bold", ",", "fontSize"}], "}"}]}]}], 
      "\[IndentingNewLine]", "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetOptions", "[", 
    RowBox[{"Histogram", ",", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
       RowBox[{"ChartElementFunction", "\[Rule]", "\"\<GlassRectangle\>\""}], 
       ",", 
       RowBox[{"ChartBaseStyle", "\[Rule]", "LightGray"}], ",", 
       RowBox[{"LabelStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Bold", ",", "fontSize"}], "}"}]}]}], 
      "\[IndentingNewLine]", "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetOptions", "[", 
    RowBox[{"SmoothDensityHistogram", ",", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
       RowBox[{"LabelStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Bold", ",", "fontSize"}], "}"}]}]}], 
      "\[IndentingNewLine]", "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"launchNukes", "[", "useKernels_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", 
          RowBox[{"Kernels", "[", "]"}]}], "<", "#"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"#", "-", 
          RowBox[{"Length", "@", 
           RowBox[{"Kernels", "[", "]"}]}]}], "//", "LaunchKernels"}], ",", 
        "\[IndentingNewLine]", "Nothing"}], "\[IndentingNewLine]", "]"}], 
      "&"}], "@", "useKernels"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"progress", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"TableForm", "@", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"\"\<Processing...\>\"", ",", "\[IndentingNewLine]", 
      RowBox[{"ProgressIndicator", "@", 
       RowBox[{"Dynamic", "[", 
        RowBox[{
         RowBox[{"x", "/", "y"}], "//", "N"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ToString", "@", 
        RowBox[{"Round", "@", "x"}]}], "<>", "\"\</\>\"", "<>", 
       RowBox[{"ToString", "@", "y"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"ToString", "@", 
       RowBox[{"PercentForm", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "/", "y"}], "//", "N"}], ",", 
         RowBox[{"DefaultPrintPrecision", "\[Rule]", "1"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"useKernels", "=", 
   RowBox[{"2", "*", "$ProcessorCount"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"launchNukes", "@", "useKernels"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetSharedVariable", "@", "monitorCounter"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9173665382274404`*^9, 3.9173666259831038`*^9}, {
   3.9173666595548496`*^9, 3.9173666708565016`*^9}, {3.917366710199241*^9, 
   3.917366715439083*^9}, {3.9174451063401346`*^9, 3.9174451295833926`*^9}, {
   3.917445187949226*^9, 3.9174452536025276`*^9}, {3.917448655573845*^9, 
   3.9174486868859277`*^9}, {3.917730291136475*^9, 3.9177302931156316`*^9}, {
   3.9177308149044333`*^9, 3.91773082228448*^9}, 3.9288094439923587`*^9, {
   3.939282587870109*^9, 3.9392825884318485`*^9}, {3.939283803148593*^9, 
   3.9392838306763334`*^9}, {3.9392859107184267`*^9, 
   3.9392859273110204`*^9}, {3.9393075815172644`*^9, 
   3.9393075819098516`*^9}, {3.940180693058421*^9, 3.9401806996255083`*^9}, {
   3.9401819828031893`*^9, 3.940182015144519*^9}, {3.9402247923955097`*^9, 
   3.9402248107396946`*^9}, {3.9402280393941727`*^9, 
   3.9402280466304936`*^9}, {3.940257691979974*^9, 3.940257692236169*^9}, {
   3.9402633340560045`*^9, 3.9402633344244623`*^9}, {3.940263495728216*^9, 
   3.940263496381483*^9}, {3.940510411275902*^9, 3.940510424634573*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"d8bfe76c-e101-44b5-bc53-db823bfbcde6"]
}, Closed]],

Cell[CellGroupData[{

Cell["Functions", "Section",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.917385243111943*^9}},ExpressionUUID->"b6d1af6e-d128-4453-a93e-\
468d160f228b"],

Cell[CellGroupData[{

Cell["Data Analysis", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852707680645`*^9}, {3.9392819692971716`*^9, 
   3.939281971310283*^9}},ExpressionUUID->"888d5458-5331-4700-9276-\
a934792c66d9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"getTrackCoordinates", "[", "trackData_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Transpose", "@", 
      RowBox[{"#", "[", 
       RowBox[{"[", 
        RowBox[{"2", ";;", "3"}], "]"}], "]"}]}], "&"}], "@", 
    RowBox[{"Transpose", "@", "trackData"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getTrackAspectRatio", "[", "track_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"input", "=", "track"}], ",", "region", ",", "area"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"region", "=", 
       RowBox[{"BoundingRegion", "[", 
        RowBox[{"input", ",", "\"\<MinOrientedRectangle\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"area", "=", 
       RowBox[{"Area", "@", "region"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Divide", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Reverse", "@", 
           RowBox[{"MinMax", "[", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{"#", ",", 
              RowBox[{"area", "/", "#"}]}], "\[IndentingNewLine]", "}"}], 
            "]"}]}], "&"}], "@", 
         RowBox[{"Norm", "@", 
          RowBox[{"Differences", "@", 
           RowBox[{"Last", "@", "region"}]}]}]}], ")"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getFilteredTrack", "[", "track_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Transpose", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"MeanFilter", "[", 
           RowBox[{"#", ",", "meanFilterScale"}], "]"}], "&"}], "@", 
         RowBox[{"MedianFilter", "[", 
          RowBox[{"#", ",", "medianFilterScale"}], "]"}]}], "&"}], "/@", 
       RowBox[{"Transpose", "@", "#"}]}], "\[IndentingNewLine]", "]"}], "&"}],
     "@", "track"}]}], "\n", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mergeTrackData", "[", 
    RowBox[{"data_", ",", "coordinates_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Transpose", "@", 
          RowBox[{"Flatten", "[", 
           RowBox[{"#", ",", "1"}], "]"}]}], "&"}], "@", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"First", "@", "#"}], "}"}], ",", 
          RowBox[{"Transpose", "@", "coordinates"}], ",", 
          RowBox[{"{", 
           RowBox[{"Last", "@", "#"}], "}"}]}], "\[IndentingNewLine]", 
         "}"}]}], "&"}], "@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"First", "@", "#"}], ",", 
        RowBox[{"Last", "@", "#"}]}], "}"}]}], "&"}], "@", 
    RowBox[{"Transpose", "@", "data"}]}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getCurvatureProfile", "[", 
    RowBox[{"boundaryPoints_", ",", "windowFactor_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "adaptiveWindow", ",", "dx1", ",", "dy1", ",", "dx2", ",", "dy2"}], 
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"adaptiveWindow", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"#", "<", "1"}], ",", "1", ",", "#"}], "]"}], "&"}], "@", 
         RowBox[{"(", 
          RowBox[{"windowFactor", "*", 
           RowBox[{"Length", "@", "boundaryPoints"}]}], ")"}]}], "//", 
        "Round"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"dx1", ",", "dy1"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"dx2", ",", "dy2"}], "}"}]}], "\[IndentingNewLine]", "}"}], 
       "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"GaussianFilter", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"boundaryPoints", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "dimensions"}], "]"}], "]"}], ",", 
           "adaptiveWindow", ",", "derivatives"}], "\[IndentingNewLine]", 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"derivatives", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"dimensions", ",", "2"}], "}"}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dx1", "*", "dy2"}], "-", 
         RowBox[{"dx2", "*", "dy1"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"dx1", "^", "2"}], "+", 
           RowBox[{"dy1", "^", "2"}]}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"3", "/", "2"}], ")"}]}], ")"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\n", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"resolveSplitNodeOverlaps", "[", 
    RowBox[{"inputTrack_", ",", "inputNodes_", ",", "distanceThreshold_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"splitNodes", "=", "inputNodes"}], ",", 
       RowBox[{"threshold", "=", "distanceThreshold"}], ",", 
       RowBox[{"track", "=", "inputTrack"}], ",", "\[IndentingNewLine]", 
       "distanceMatrix", ",", "criticalProximityMap", ",", "overlappingPairs",
        ",", "\[IndentingNewLine]", "overlappingGroups", ",", 
       "redundantNodeIDs", ",", "splitNodeIDs"}], "\[IndentingNewLine]", 
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"splitNodeIDs", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"track", ",", "#"}], "]"}], "&"}], "/@", "splitNodes"}], "//",
         "Flatten"}]}], ";", "\n", 
      RowBox[{"distanceMatrix", "=", 
       RowBox[{"DistanceMatrix", "[", 
        RowBox[{"splitNodeIDs", ",", 
         RowBox[{"DistanceFunction", "\[Rule]", "EuclideanDistance"}]}], 
        "]"}]}], ";", "\n", 
      RowBox[{"criticalProximityMap", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "<", "threshold"}], "&"}], ",", "distanceMatrix", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\n", 
      RowBox[{"overlappingPairs", "=", 
       RowBox[{
        RowBox[{"Sort", "/@", 
         RowBox[{"Last", "@", 
          RowBox[{"GatherBy", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"criticalProximityMap", ",", "True"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Length", "@", 
              RowBox[{"Union", "[", "#", "]"}]}], "&"}]}], 
           "\[IndentingNewLine]", "]"}]}]}], "//", "DeleteDuplicates"}]}], 
      ";", "\n", "\[IndentingNewLine]", 
      RowBox[{"overlappingGroups", "=", 
       RowBox[{
        RowBox[{"Sort", "/@", 
         RowBox[{"Union", "/@", 
          RowBox[{"Flatten", "/@", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Select", "[", 
               RowBox[{
                RowBox[{"!", 
                 RowBox[{"FreeQ", "[", 
                  RowBox[{"#", ",", "k"}], "]"}]}], "&"}], "]"}], "[", 
              "overlappingPairs", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"k", ",", 
               RowBox[{"DeleteDuplicates", "@", 
                RowBox[{"Flatten", "@", "overlappingPairs"}]}]}], "}"}]}], 
            "\[IndentingNewLine]", "]"}]}]}]}], "//", "DeleteDuplicates"}]}], 
      ";", "\n", "\[IndentingNewLine]", 
      RowBox[{"redundantNodeIDs", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;", "All"}], "]"}], "]"}], "&"}], "/@", 
         "overlappingGroups"}], "//", "Flatten"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Sort", "@", 
       RowBox[{"Delete", "[", 
        RowBox[{"splitNodeIDs", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "#", "}"}], "&"}], "/@", "redundantNodeIDs"}]}], 
        "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"n", " ", "sublists"}], ",", " ", 
    RowBox[{"overlapping", " ", "k", " ", "elements"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"partitionRagged", "[", 
     RowBox[{"list_", ",", "n_", ",", 
      RowBox[{"k_", ":", "0"}]}], "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"dl", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Length", "@", "list"}], "-", "k"}], ")"}], "/", "n"}]}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Take", "[", 
          RowBox[{"list", ",", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Round", "[", 
              RowBox[{"1", "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"j", "-", "1"}], ")"}], "*", "dl"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"Round", "[", 
                RowBox[{"k", "+", 
                 RowBox[{"j", "*", "dl"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Length", "@", "list"}]}], "]"}]}], 
            "\[IndentingNewLine]", "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "n"}], "}"}]}], "]"}], "/;", 
       RowBox[{"dl", ">", "0"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getTurningPointCurvesAll", "[", "data_", "]"}], ":=", 
   RowBox[{"N", "[", 
    RowBox[{"Rescale", "/@", 
     RowBox[{"Transpose", "@", 
      RowBox[{"Abs", "@", "data"}]}]}], "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getTrackUturns", "[", "track_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"inputTrack", "=", "track"}], ",", "testTrack", ",", 
       "testTrackTurningCurves", ",", "testTrackTurningLaplacian", ",", 
       "\[IndentingNewLine]", "testTrackTurningPointsIDs", ",", 
       "trackTurningPoints", ",", "\[IndentingNewLine]", "testTrackCurvature",
        ",", "curvaturePeakPositions", ",", "curvaturePeakValues", ",", 
       "curvaturePeaks", ",", "trackEndPoints", ",", "trackUturnPoints", ",", 
       "\[IndentingNewLine]", "curvaturePeakPoints", ",", "trackSplitNodes", 
       ",", "trackSplitIDs", ",", "trackUturns", ",", "\[IndentingNewLine]", 
       "trackUturnsClean", ",", "curvaturePeakPointsClean"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"testTrack", "=", "inputTrack"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Get", " ", "Track", " ", "Turning", " ", "Points"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"===", "===", "===", "===", "===", "===", "===", 
         RowBox[{"\[Equal]", 
          RowBox[{"===", "===", 
           RowBox[{"==", 
            RowBox[{"===", "===", "===", "===", "===", "==="}]}]}]}]}], "="}],
        "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"testTrackTurningCurves", "=", 
       RowBox[{"getTurningPointCurvesAll", "@", "testTrack"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"testTrackTurningLaplacian", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"DerivativeFilter", "[", "\[IndentingNewLine]", 
           RowBox[{"#", ",", 
            RowBox[{"{", "2", "}"}], ",", "derivativeGaussKernelScale"}], 
           "\[IndentingNewLine]", "]"}], "&"}], "/@", 
         "testTrackTurningCurves"}], "//", "Abs"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"testTrackTurningPointsIDs", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Flatten", "@", 
            RowBox[{"Position", "[", 
             RowBox[{"#", ",", 
              RowBox[{"_", "?", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"#", "\[Equal]", "1"}], "&"}], ")"}]}]}], "]"}]}], 
           "&"}], "@", 
          RowBox[{"PeakDetect", "[", "\[IndentingNewLine]", 
           RowBox[{
           "#", ",", "peakSmoothingKernelScale", ",", "Automatic", ",", 
            RowBox[{"turningPeakThreshold", "*", 
             RowBox[{"Max", "@", "#"}]}]}], "\[IndentingNewLine]", "]"}]}], 
         "&"}], "/@", "testTrackTurningLaplacian"}]}], ";", "\n", "\n", 
      RowBox[{"trackTurningPoints", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"testTrack", "[", 
            RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
          RowBox[{"Flatten", "[", 
           RowBox[{"#", ",", "1"}], "]"}]}], "&"}], "@", 
        "testTrackTurningPointsIDs"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Get", " ", "U"}], "-", 
        RowBox[{"turn", " ", "Peak", " ", "Points"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"===", "===", "===", "===", "===", "===", "===", 
         RowBox[{"\[Equal]", 
          RowBox[{"===", "===", 
           RowBox[{"==", 
            RowBox[{"===", "===", "===", "===", "===", "==="}]}]}]}]}], "="}],
        "*)"}], "\[IndentingNewLine]", "\n", 
      RowBox[{"testTrackCurvature", "=", 
       RowBox[{"getCurvatureProfile", "[", 
        RowBox[{"testTrack", ",", "smoothingWindowSize"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"curvaturePeakPositions", "=", 
       RowBox[{"Flatten", "@", 
        RowBox[{"Position", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"PeakDetect", "[", 
           RowBox[{
            RowBox[{"Abs", "@", "testTrackCurvature"}], ",", 
            "gaussianFilterScale"}], "\[IndentingNewLine]", "]"}], ",", 
          RowBox[{"_", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#", "\[Equal]", "1"}], "&"}], ")"}]}]}], 
         "\[IndentingNewLine]", "]"}]}]}], ";", "\[IndentingNewLine]", "\n", 
      RowBox[{"curvaturePeakValues", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"testTrackCurvature", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "&"}], "@", 
        "curvaturePeakPositions"}]}], ";", "\n", "\[IndentingNewLine]", 
      RowBox[{"curvaturePeaks", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Select", "[", "\[IndentingNewLine]", 
          RowBox[{"#", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "@", 
              RowBox[{"Last", "@", "#"}]}], ">", 
             RowBox[{"peakThreshold", "*", 
              RowBox[{"Max", "@", 
               RowBox[{"Abs", "@", 
                RowBox[{"Last", "@", "#"}]}]}]}]}], "&"}]}], 
          "\[IndentingNewLine]", "]"}], "&"}], "@", 
        RowBox[{"Transpose", "@", 
         RowBox[{"{", 
          RowBox[{"curvaturePeakPositions", ",", "curvaturePeakValues"}], 
          "}"}]}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Get", " ", "U"}], "-", 
        RowBox[{"turn", " ", "Split", " ", "Points"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"===", "===", "===", "===", "===", "===", "===", 
         RowBox[{"\[Equal]", 
          RowBox[{"===", "===", 
           RowBox[{"==", 
            RowBox[{"===", "===", "===", "===", "===", "==="}]}]}]}]}], "="}],
        "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"trackEndPoints", "=", 
       RowBox[{"testTrack", "[", 
        RowBox[{"[", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"curvaturePeakPoints", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"curvaturePeakPointPadding", ";;", "All"}], "]"}], "]"}],
            "&"}], "@", 
          RowBox[{"testTrack", "[", 
           RowBox[{"[", "#", "]"}], "]"}]}], "&"}], "@", 
        RowBox[{"First", "@", 
         RowBox[{"Transpose", "@", "curvaturePeaks"}]}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"trackUturnPoints", "=", 
       RowBox[{"Complement", "[", 
        RowBox[{"curvaturePeakPoints", ",", "trackEndPoints"}], "]"}]}], ";", 
      "\n", "\n", 
      RowBox[{"trackSplitNodes", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"testTrack", "[", 
            RowBox[{"[", "#", "]"}], "]"}], "&"}], "@", 
          RowBox[{"resolveSplitNodeOverlaps", "[", 
           RowBox[{"testTrack", ",", "#", ",", "3"}], "]"}]}], "&"}], "@", 
        RowBox[{"DeleteDuplicates", "@", 
         RowBox[{"Join", "[", "\[IndentingNewLine]", 
          RowBox[{"curvaturePeakPoints", ",", "trackEndPoints", ",", 
           RowBox[{"Complement", "[", 
            RowBox[{"trackTurningPoints", ",", "trackUturnPoints"}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Get", " ", "Pruned", " ", "U"}], "-", "turns"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"===", "===", "===", "===", "===", "===", "===", 
         RowBox[{"\[Equal]", 
          RowBox[{"===", "===", 
           RowBox[{"==", 
            RowBox[{"===", "===", "===", "===", "===", "==="}]}]}]}]}], "="}],
        "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"trackSplitIDs", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"MinMax", "/@", 
          RowBox[{"partitionRagged", "[", 
           RowBox[{"#", ",", 
            RowBox[{
             RowBox[{"Length", "@", "#"}], "-", "2"}], ",", "2"}], "]"}]}], 
         "&"}], "@", 
        RowBox[{"Sort", "@", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"testTrack", ",", "#"}], "]"}], "&"}], "/@", 
           "trackSplitNodes"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"trackUturns", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"getPrunedUturn", "@", 
          RowBox[{"Take", "[", 
           RowBox[{"testTrack", ",", "#"}], "]"}]}], "&"}], "/@", 
        "trackSplitIDs"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"trackUturnsClean", "=", 
       RowBox[{"trackUturns", "//", 
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{"#", ",", 
           RowBox[{
            RowBox[{"ContainsAny", "[", 
             RowBox[{"#", ",", "curvaturePeakPoints"}], "]"}], "&"}]}], "]"}],
          "&"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"curvaturePeakPointsClean", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"#", ",", "1"}], "]"}], "&"}], "@", 
          RowBox[{"Intersection", "[", 
           RowBox[{"#", ",", "curvaturePeakPoints"}], "]"}]}], "&"}], "/@", 
        "trackUturnsClean"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"trackUturnsClean", ",", "curvaturePeakPointsClean"}], 
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getMatchingIndex", "[", 
    RowBox[{"list_", ",", "checkedElement_"}], "]"}], ":=", 
   RowBox[{"Position", "[", "\[IndentingNewLine]", 
    RowBox[{"list", ",", 
     RowBox[{"_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"#", "==", "checkedElement"}], "&"}], ")"}]}], ",", 
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"Heads", "\[Rule]", "False"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getPrunedUturn", "[", "uturn_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"input", "=", "uturn"}], ",", "nodePruningDepth"}], "}"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nodePruningDepth", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Max", "[", 
          RowBox[{"minimumPruningDepth", ",", "#"}], "]"}], "&"}], "@", 
        RowBox[{"Round", "[", 
         RowBox[{"nodePruningScale", "*", 
          RowBox[{"Length", "@", "input"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"input", "[", 
         RowBox[{"[", 
          RowBox[{"#", ";;", 
           RowBox[{"-", "#"}]}], "]"}], "]"}], "&"}], "@", 
       RowBox[{"(", 
        RowBox[{"1", "+", "nodePruningDepth"}], ")"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"getSymmetricUturn", "[", 
     RowBox[{"data_", ",", "curvaturePeakPoint_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"inputdata", "=", "data"}], ",", 
        RowBox[{"referencePoint", "=", "curvaturePeakPoint"}], ",", 
        "\[IndentingNewLine]", "branchLeft", ",", "branchRight", ",", 
        "branchLengthDifference"}], "\[IndentingNewLine]", "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"branchLeft", ",", "branchRight"}], "}"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"inputdata", "[", 
               RowBox[{"[", 
                RowBox[{"1", ";;", 
                 RowBox[{"#", "-", "1"}]}], "]"}], "]"}], ",", 
              RowBox[{"inputdata", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"#", "+", "1"}], ";;", "All"}], "]"}], "]"}]}], 
             "\[IndentingNewLine]", "}"}], "&"}], "@", 
           RowBox[{"First", "@", 
            RowBox[{"Flatten", "@", 
             RowBox[{"Position", "[", 
              RowBox[{"#", ",", 
               RowBox[{"_", "?", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"#", "\[Equal]", "referencePoint"}], "&"}], 
                 ")"}]}]}], "]"}]}]}]}], "&"}], "@", "inputdata"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"branchLengthDifference", "=", 
        RowBox[{
         RowBox[{"Subtract", "@@", 
          RowBox[{"Length", "/@", 
           RowBox[{"{", 
            RowBox[{"branchLeft", ",", "branchRight"}], "}"}]}]}], "//", 
         "Abs"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "branchLeft"}], "\[GreaterEqual]", 
          RowBox[{"Length", "@", "branchRight"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"branchLeft", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"branchLengthDifference", "+", "1"}], ";;", "All"}], 
             "]"}], "]"}], ",", 
           RowBox[{"{", "referencePoint", "}"}], ",", "branchRight"}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"Join", "[", 
          RowBox[{"branchLeft", ",", 
           RowBox[{"{", "referencePoint", "}"}], ",", 
           RowBox[{"branchRight", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", 
              RowBox[{
               RowBox[{"-", "1"}], "-", "branchLengthDifference"}]}], "]"}], 
            "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getPhysicallySymmetrizedUturn", "[", 
    RowBox[{"data_", ",", "curvaturePeakPoint_", ",", "branchCutFactor_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"inputdata", "=", "data"}], ",", 
       RowBox[{"referencePoint", "=", "curvaturePeakPoint"}], ",", 
       RowBox[{"cutFactor", "=", "branchCutFactor"}], ",", 
       "\[IndentingNewLine]", "branchLeft", ",", "branchRight", ",", 
       "initialPhysicalLengths", ",", "longBranchID", ",", "shortBranchID", 
       ",", "\[IndentingNewLine]", "longBranch", ",", "shortBranch", ",", 
       "cutThreshold"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"branchLeft", ",", "branchRight"}], "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"inputdata", "[", 
              RowBox[{"[", 
               RowBox[{"1", ";;", 
                RowBox[{"#", "-", "1"}]}], "]"}], "]"}], ",", 
             RowBox[{"inputdata", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"#", "+", "1"}], ";;", "All"}], "]"}], "]"}]}], 
            "\[IndentingNewLine]", "}"}], "&"}], "@", 
          RowBox[{"First", "@", 
           RowBox[{"Flatten", "@", 
            RowBox[{"Position", "[", 
             RowBox[{"#", ",", 
              RowBox[{"_", "?", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"#", "\[Equal]", "referencePoint"}], "&"}], 
                ")"}]}]}], "]"}]}]}]}], "&"}], "@", "inputdata"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"initialPhysicalLengths", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Norm", "[", 
             RowBox[{"referencePoint", "-", "#"}], "]"}], "&"}], "/@", "#"}], 
          "]"}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{"branchLeft", ",", "branchRight"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"cutThreshold", "=", 
       RowBox[{
        RowBox[{"cutFactor", "*", 
         RowBox[{"Abs", "@", 
          RowBox[{"Differences", "@", "initialPhysicalLengths"}]}]}], "//", 
        "First"}]}], ";", "\n", "\[IndentingNewLine]", 
      RowBox[{"longBranchID", "=", 
       RowBox[{"First", "@", 
        RowBox[{"Flatten", "@", 
         RowBox[{"Position", "[", "\[IndentingNewLine]", 
          RowBox[{"initialPhysicalLengths", ",", 
           RowBox[{"_", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"#", "\[Equal]", 
               RowBox[{"Max", "@", "initialPhysicalLengths"}]}], "&"}], ")"}]}
            ]}], "\[IndentingNewLine]", "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"shortBranchID", "=", 
       RowBox[{"First", "@", 
        RowBox[{"Complement", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}], ",", 
          RowBox[{"{", "longBranchID", "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"longBranch", ",", "shortBranch"}], "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"{", 
            RowBox[{"branchLeft", ",", "branchRight"}], "}"}], ")"}], "[", 
          RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{"longBranchID", ",", "shortBranchID"}], "}"}]}]}], ";", "\n",
       "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"longBranch", "\[Equal]", "branchLeft"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"branchLeft", "=", 
         RowBox[{"branchLeft", "[", 
          RowBox[{"[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"1", "+", 
               RowBox[{"LengthWhile", "[", 
                RowBox[{"#", ",", 
                 RowBox[{
                  RowBox[{"#", ">", "cutThreshold"}], "&"}]}], "]"}]}], "&"}],
              "@", 
             RowBox[{"(", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Norm", "[", 
                  RowBox[{"referencePoint", "-", "#"}], "]"}], "&"}], "/@", 
                "longBranch"}], "-", 
               RowBox[{"initialPhysicalLengths", "[", 
                RowBox[{"[", "shortBranchID", "]"}], "]"}]}], 
              "\[IndentingNewLine]", ")"}]}], ";;", "All"}], 
           "\[IndentingNewLine]", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"branchRight", "=", 
         RowBox[{"branchRight", "[", 
          RowBox[{"[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"1", ";;", 
              RowBox[{"-", 
               RowBox[{"LengthWhile", "[", 
                RowBox[{
                 RowBox[{"Reverse", "@", "#"}], ",", 
                 RowBox[{
                  RowBox[{"#", ">", "cutThreshold"}], "&"}]}], "]"}]}]}], 
             "&"}], "@", 
            RowBox[{"(", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Norm", "[", 
                 RowBox[{"referencePoint", "-", "#"}], "]"}], "&"}], "/@", 
               "longBranch"}], "-", 
              RowBox[{"initialPhysicalLengths", "[", 
               RowBox[{"[", "shortBranchID", "]"}], "]"}]}], 
             "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", "]"}], 
          "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", "\n", 
      "\[IndentingNewLine]", 
      RowBox[{"Join", "[", 
       RowBox[{"branchLeft", ",", 
        RowBox[{"{", "referencePoint", "}"}], ",", "branchRight"}], "]"}]}]}],
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getUturnImage", "[", "uturn_", "]"}], ":=", 
   RowBox[{"Image", "@", 
    RowBox[{"Graphics", "@", 
     RowBox[{"Line", "@", "uturn"}]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"checkSelfIntersection", "[", "uturnImage_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"#", "-", "1"}], ")"}], "&"}], "@", 
        RowBox[{"Length", "@", 
         RowBox[{"ComponentMeasurements", "[", 
          RowBox[{"#", ",", "\"\<Count\>\""}], "]"}]}]}], "&"}], "@", 
      RowBox[{"Binarize", "@", "\[IndentingNewLine]", 
       RowBox[{"ImageAdjust", "@", 
        RowBox[{"ColorNegate", "@", 
         RowBox[{"GaussianFilter", "[", 
          RowBox[{"#", ",", "lineImageSmoothFactor"}], "]"}]}]}]}]}], "&"}], 
    "@", 
    RowBox[{"ColorNegate", "@", "uturnImage"}]}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getUturnArea", "[", "uturn_", "]"}], ":=", 
   RowBox[{"Area", "@", 
    RowBox[{"BoundingRegion", "[", 
     RowBox[{"uturn", ",", "\"\<MinOrientedRectangle\>\""}], "]"}]}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"buildCurveSpline", "[", 
     RowBox[{"curvePoints_", ",", "splineOrder_"}], "]"}], ":=", 
    RowBox[{"BSplineFunction", "[", "\[IndentingNewLine]", 
     RowBox[{"curvePoints", ",", 
      RowBox[{"SplineDegree", "\[Rule]", "splineOrder"}], ",", 
      RowBox[{"SplineClosed", "\[Rule]", "False"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"arcIncrement", "[", 
    RowBox[{
     RowBox[{"t_", "?", "NumericQ"}], ",", "spline_"}], "]"}], ":=", 
   RowBox[{"If", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"t", "-", "1."}], "\[LessEqual]", "0"}], ",", 
     RowBox[{
      RowBox[{"spline", "'"}], "[", "t", "]"}], ",", 
     RowBox[{
      RowBox[{"spline", "'"}], "[", "1", "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getCheckpoints", "[", "spline_", "]"}], ":=", 
    RowBox[{"NDSolveValue", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"t", "'"}], "[", "s", "]"}], "\[Equal]", 
         RowBox[{"1", "/", 
          RowBox[{"Norm", "@", 
           RowBox[{"arcIncrement", "[", 
            RowBox[{
             RowBox[{"t", "[", "s", "]"}], ",", "spline"}], "]"}]}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"t", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"WhenEvent", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"t", "[", "s", "]"}], "\[Equal]", "1"}], ",", 
          "\"\<StopIntegration\>\""}], "]"}]}], "\[IndentingNewLine]", "}"}], 
      ",", "t", ",", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"s", ",", "0", ",", 
        RowBox[{"1", "+", 
         RowBox[{"NIntegrate", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Norm", "[", 
            RowBox[{
             RowBox[{"spline", "'"}], "[", "t", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", "1"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Method", "\[Rule]", "\"\<LocalAdaptive\>\""}], ",", 
           RowBox[{"MaxRecursion", "\[Rule]", "2000"}]}], 
          "\[IndentingNewLine]", "]"}]}]}], "}"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uniformlySampleSpline", "[", 
     RowBox[{"spline_", ",", "pointCount_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "arcCheckpoints", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"arcCheckpoints", "=", 
        RowBox[{"getCheckpoints", "@", "spline"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Map", "[", "\[IndentingNewLine]", 
        RowBox[{"spline", ",", "\[IndentingNewLine]", 
         RowBox[{"arcCheckpoints", "@", 
          RowBox[{"Rescale", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"0", ",", "1", ",", 
              RowBox[{"1", "/", "pointCount"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"First", "@", 
             RowBox[{"arcCheckpoints", "[", "\"\<Domain\>\"", "]"}]}]}], 
           "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}],
      "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uniformlyUpsampleCurve", "[", 
     RowBox[{"curvePoints_", ",", "splineOrder_", ",", "samplingPoints_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "spline", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"spline", "=", 
        RowBox[{"buildCurveSpline", "[", 
         RowBox[{"curvePoints", ",", "splineOrder"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Drop", "[", 
          RowBox[{"#", ",", 
           RowBox[{"-", "1"}]}], "]"}], "&"}], "@", 
        RowBox[{"uniformlySampleSpline", "[", 
         RowBox[{"spline", ",", "samplingPoints"}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getRefinedCurvaturePoints", "[", 
    RowBox[{
    "trajectory_", ",", "trajectoryUpsampled_", ",", 
     "curvaturePointFilterParameters_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"inputTrack", "=", "trajectory"}], ",", 
       RowBox[{"inputTrackUpsampled", "=", "trajectoryUpsampled"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"inputParameters", "=", "curvaturePointFilterParameters"}], 
       ",", "\[IndentingNewLine]", "curvatureProfile", ",", 
       "curvaturePeakPositions", ",", "curvaturePeakValues", ",", 
       "curvaturePeaks", ",", "\[IndentingNewLine]", 
       "peaksUpsampledTrajectory"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"curvatureProfile", "=", 
       RowBox[{"getCurvatureProfile", "[", 
        RowBox[{"inputTrackUpsampled", ",", 
         RowBox[{"inputParameters", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"curvaturePeakPositions", "=", 
       RowBox[{"Flatten", "@", 
        RowBox[{"Position", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"PeakDetect", "[", 
           RowBox[{
            RowBox[{"Abs", "@", "curvatureProfile"}], ",", 
            RowBox[{"inputParameters", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"_", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#", "\[Equal]", "1"}], "&"}], ")"}]}]}], 
         "\[IndentingNewLine]", "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"curvaturePeakValues", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"curvatureProfile", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "&"}], "@", 
        "curvaturePeakPositions"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"curvaturePeaks", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{"#", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "@", 
              RowBox[{"Last", "@", "#"}]}], ">", 
             RowBox[{"inputParameters", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "&"}]}], "]"}], "&"}], "@", 
        RowBox[{"Transpose", "@", 
         RowBox[{"{", 
          RowBox[{"curvaturePeakPositions", ",", "curvaturePeakValues"}], 
          "}"}]}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"peaksUpsampledTrajectory", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"inputTrackUpsampled", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "&"}], "@", 
        RowBox[{"First", "@", 
         RowBox[{"Transpose", "@", "curvaturePeaks"}]}]}]}], ";", 
      RowBox[{
       RowBox[{
        RowBox[{"First", "@", 
         RowBox[{"Nearest", "[", 
          RowBox[{"inputTrack", ",", "#", ",", "1"}], "]"}]}], "&"}], "/@", 
       "peaksUpsampledTrajectory"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getTranslatedSymmetrizedUturn", "[", 
    RowBox[{"uturn_", ",", "peakPoint_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "peakPoint"}], "+", 
     RowBox[{"Transpose", "@", 
      RowBox[{"getPhysicallySymmetrizedUturn", "[", "\[IndentingNewLine]", 
       RowBox[{"uturn", ",", "peakPoint", ",", "branchCutFactor"}], 
       "\[IndentingNewLine]", "]"}]}]}], "//", "Transpose"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"===", "===", "===", "===", "===", "    ", 
     RowBox[{"UTURN", "    ", "FITTING"}], "    ", "===", "===", "==="}], "=", 
    RowBox[{"=", 
     RowBox[{
      RowBox[{"===", "==="}], "="}]}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"penaltyFunctionSignY", "[", "data_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"transformedData", "=", "data"}], ",", "dataValuesY"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dataValuesY", "=", 
       RowBox[{"Last", "@", 
        RowBox[{"Transpose", "@", "transformedData"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Total", "@", "#"}], "^", "2"}], "&"}], "@", 
          RowBox[{"Select", "[", 
           RowBox[{"dataValuesY", ",", 
            RowBox[{
             RowBox[{"#", ">", "0"}], "&"}]}], "]"}]}], "/", 
         RowBox[{
          RowBox[{"Total", "@", "#"}], "^", "2"}]}], "&"}], "@", 
       RowBox[{"Abs", "@", "dataValuesY"}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getTheoryValues", "[", 
    RowBox[{"x0_", ",", "y0_", ",", "L_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"zeroPointX", "=", "x0"}], ",", 
       RowBox[{"zeroPointY", "=", "y0"}], ",", 
       RowBox[{"branchLengh", "=", "L"}], ",", "functionLimiter"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"functionLimiter", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "epsilonX"}], ")"}], "*", "branchLengh"}], "//", 
        "N"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"#", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"trackTheoryFunction", "[", 
               RowBox[{"#", ",", "zeroPointX", ",", "zeroPointY", ",", 
                RowBox[{"2", "*", "branchLengh"}]}], "]"}], "&"}], "/@", 
             "#"}]}], "\[IndentingNewLine]", "}"}], "&"}], "@", 
         RowBox[{"Range", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"-", "functionLimiter"}], ",", "functionLimiter", ",", 
           RowBox[{"functionLimiter", "/", "theorySampleCount"}]}], 
          "\[IndentingNewLine]", "]"}]}], "//", "N"}], "//", 
       "Transpose"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fitnessFunctionNearestNeigbor", "[", 
    RowBox[{"data_", ",", "x0_", ",", "y0_", ",", "L_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Total", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"#", "^", "2"}], "&"}], "/@", 
        RowBox[{"Norm", "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"First", "/@", 
              RowBox[{"Nearest", "[", 
               RowBox[{
                RowBox[{"getTheoryValues", "[", 
                 RowBox[{"x0", ",", "y0", ",", "L"}], "]"}], ",", "#", ",", 
                "1"}], "]"}]}], "&"}], "@", "#"}], "-", "#"}], ")"}]}]}], 
       "&"}], "@", "data"}], "\[IndentingNewLine]", "]"}], "/", 
    RowBox[{"Total", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "^", "2"}], "&"}], "/@", 
      RowBox[{"Norm", "/@", "data"}]}], "]"}]}]}], "\n", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fitnessFunctionTotal", "[", 
    RowBox[{
    "inputData_", ",", "phi_", ",", "x0_", ",", "y0_", ",", "L_", ",", "w_"}],
     "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"data", "=", "inputData"}], ",", "dataRotated", ",", 
       RowBox[{"penaltyWeight", "=", "w"}], ",", "\[IndentingNewLine]", 
       RowBox[{"rotationAngle", "=", "phi"}], ",", 
       RowBox[{"zeroPointX", "=", "x0"}], ",", 
       RowBox[{"zeroPointY", "=", "y0"}], ",", 
       RowBox[{"branchWidth", "=", "L"}]}], "\[IndentingNewLine]", "}"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dataRotated", "=", 
       RowBox[{"data", ".", 
        RowBox[{"RotationMatrix", "@", "rotationAngle"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"penaltyWeight", "*", 
        RowBox[{"penaltyFunctionSignY", "@", "dataRotated"}]}], "+", 
       RowBox[{"fitnessFunctionNearestNeigbor", "[", 
        RowBox[{
        "dataRotated", ",", "zeroPointX", ",", "zeroPointY", ",", 
         "branchWidth"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getUturnShapeFit", "[", "uturn_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"inputUturn", "=", "uturn"}], ",", "\[IndentingNewLine]", 
       "uturnBoxSize", ",", "widthRange", ",", "angleRange", ",", 
       "\[IndentingNewLine]", "firstEstimateAngle", ",", "firstEstimateWidth",
        ",", "fitnessRange", ",", "\[IndentingNewLine]", "optimalInstances", 
       ",", "optimalAngles", ",", "optimalWidths", ",", "\[IndentingNewLine]",
        "optimalWidth", ",", "optimalAngle", ",", "optimalRotationMatrix", 
       ",", "optimalRotatedData", ",", "\[IndentingNewLine]", 
       "fitnessFunction", ",", "penaltyFunction", ",", 
       "fitnessFunctionCombined", ",", "uturnWidthMicrometers"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"uturnBoxSize", "=", 
           RowBox[{
            RowBox[{"Times", "@@", 
             RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"Differences", "/@", 
                 RowBox[{"Sort", "/@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"First", "@", "#"}], ",", 
                    RowBox[{"Last", "@", "#"}]}], "}"}]}]}], "&"}], "@", 
               RowBox[{"BoundingRegion", "@", "inputUturn"}]}], 
              "\[IndentingNewLine]", "]"}]}], "//", "Sqrt"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"widthRange", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Range", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"#", ">", "0"}], ",", "#", ",", "0"}], "]"}], 
                 "&"}], "@", 
                RowBox[{"(", 
                 RowBox[{"#1", "-", 
                  RowBox[{"#2", "*", "#1"}]}], ")"}]}], ",", 
               RowBox[{"#1", "+", 
                RowBox[{"#2", "*", "#1"}]}], ",", 
               RowBox[{"2", "*", "#2", "*", 
                RowBox[{"#1", "/", "initialWidthResolution"}]}]}], 
              "\[IndentingNewLine]", "]"}], "&"}], "@@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"uturnBoxSizeFactor", "*", "uturnBoxSize"}], ",", 
              "initialRangeFactorWidth"}], "}"}]}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"angleRange", "=", 
           RowBox[{"Range", "[", 
            RowBox[{"0", ",", 
             RowBox[{"2", "*", "\[Pi]"}], ",", 
             RowBox[{"\[Pi]", "/", "initialAngleResolution"}]}], "]"}]}], ";",
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"fitnessRange", "=", 
           RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"fitnessFunctionTotal", "[", "\[IndentingNewLine]", 
              RowBox[{
              "inputUturn", ",", "angle", ",", "zeroX", ",", "zeroY", ",", 
               "testBranchWidth", ",", "penaltyWeight"}], 
              "\[IndentingNewLine]", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"angle", ",", "angleRange"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"testBranchWidth", ",", "widthRange"}], "}"}]}], 
            "\[IndentingNewLine]", "]"}]}], ";"}], "//", "AbsoluteTiming"}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"optimalInstances", "=", 
         RowBox[{"Position", "[", 
          RowBox[{"fitnessRange", ",", 
           RowBox[{"Min", "@", "fitnessRange"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"optimalAngles", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"angleRange", "[", 
             RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
           RowBox[{"First", "/@", "optimalInstances"}]}], "//", "N"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"optimalWidths", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"widthRange", "[", 
            RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
          RowBox[{"Last", "/@", "optimalInstances"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"firstEstimateAngle", ",", "firstEstimateWidth"}], "}"}], 
         "=", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", 
          RowBox[{"{", 
           RowBox[{"optimalAngles", ",", "optimalWidths"}], "}"}]}]}], ";", 
        "\n", "\[IndentingNewLine]", 
        RowBox[{"angleRange", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Range", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"#1", "-", 
              RowBox[{"#2", "*", "#1"}]}], ",", 
             RowBox[{"#1", "+", 
              RowBox[{"#2", "*", "#1"}]}], ",", 
             RowBox[{"2", "*", "#2", "*", 
              RowBox[{"#1", "/", "refinementAngleResolution"}]}]}], 
            "\[IndentingNewLine]", "]"}], "&"}], "@@", 
          RowBox[{"{", 
           RowBox[{"firstEstimateAngle", ",", "refinementRangeFactorAngle"}], 
           "}"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"widthRange", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Range", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"#1", "-", 
              RowBox[{"#2", "*", "#1"}]}], ",", 
             RowBox[{"#1", "+", 
              RowBox[{"#2", "*", "#1"}]}], ",", 
             RowBox[{"2", "*", "#2", "*", 
              RowBox[{"#1", "/", "refinementWidthResolution"}]}]}], 
            "\[IndentingNewLine]", "]"}], "&"}], "@@", 
          RowBox[{"{", 
           RowBox[{"firstEstimateWidth", ",", "refinementRangeFactorWidth"}], 
           "}"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"fitnessRange", "=", 
         RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"fitnessFunctionTotal", "[", "\[IndentingNewLine]", 
            RowBox[{
            "inputUturn", ",", "angle", ",", "zeroX", ",", "zeroY", ",", 
             "testBranchWidth", ",", "penaltyWeight"}], "\[IndentingNewLine]",
             "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"angle", ",", "angleRange"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"testBranchWidth", ",", "widthRange"}], "}"}]}], 
          "\[IndentingNewLine]", "]"}]}], ";"}], "//", "AbsoluteTiming"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"optimalInstances", "=", 
       RowBox[{"Position", "[", 
        RowBox[{"fitnessRange", ",", 
         RowBox[{"Min", "@", "fitnessRange"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"optimalAngles", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"angleRange", "[", 
           RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
         RowBox[{"First", "/@", "optimalInstances"}]}], "//", "N"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"optimalWidths", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"widthRange", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
        RowBox[{"Last", "/@", "optimalInstances"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"optimalWidth", ",", "optimalAngle"}], "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{"optimalWidths", ",", "optimalAngles"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"optimalRotationMatrix", "=", 
       RowBox[{"RotationMatrix", "@", "optimalAngle"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"optimalRotatedData", "=", 
       RowBox[{"inputUturn", ".", "optimalRotationMatrix"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"fitnessFunction", "=", 
       RowBox[{"fitnessFunctionNearestNeigbor", "[", "\[IndentingNewLine]", 
        RowBox[{
        "optimalRotatedData", ",", "zeroX", ",", "zeroY", ",", 
         "optimalWidth"}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"penaltyFunction", "=", 
       RowBox[{"penaltyFunctionSignY", "@", "optimalRotatedData"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fitnessFunctionCombined", "=", 
       RowBox[{
        RowBox[{"penaltyWeight", "*", "penaltyFunction"}], "+", 
        "fitnessFunction"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"uturnWidthMicrometers", "=", 
       RowBox[{
        RowBox[{"optimalWidth", "*", "pixelSizeMicroMeters"}], "//", "N"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
       "uturnWidthMicrometers", ",", "\[IndentingNewLine]", 
        "fitnessFunctionCombined", ",", "penaltyFunction", ",", 
        "fitnessFunction", ",", "\[IndentingNewLine]", "inputUturn", ",", 
        "optimalRotatedData", ",", "optimalWidth"}], "\[IndentingNewLine]", 
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"===", "===", "===", "===", "===", "    ", 
     RowBox[{"Further", " ", "data", " ", "analysis"}], "    ", "===", "===", 
     "==="}], "=", 
    RowBox[{"=", 
     RowBox[{
      RowBox[{"===", "==="}], "="}]}]}], "*)"}], "\[IndentingNewLine]", 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getUturnData", "[", "uturn_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"trackDataClean", "[", 
        RowBox[{"[", 
         RowBox[{"#1", ",", "#2"}], "]"}], "]"}], "&"}], "@@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"First", "@", 
         RowBox[{"First", "@", "#"}]}], ",", 
        RowBox[{"Last", "@", "#"}]}], "}"}]}], "&"}], "@", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{"DeleteDuplicates", "/@", 
      RowBox[{"Transpose", "@", 
       RowBox[{"Position", "[", "\[IndentingNewLine]", 
        RowBox[{"trackCoordinatesClean", ",", 
         RowBox[{"Alternatives", "@@", 
          RowBox[{"First", "@", "uturn"}]}]}], "\[IndentingNewLine]", 
        "]"}]}]}], "\[IndentingNewLine]", ")"}]}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"getTranslatedUturn", "[", 
    RowBox[{"uturn_", ",", "peakPoint_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "peakPoint"}], "+", 
     RowBox[{"Transpose", "@", "uturn"}]}], "//", "Transpose"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getUturnAlignmentFactor", "[", "uturn_", "]"}], ":=", 
   RowBox[{"Divide", "@@", 
    RowBox[{"Abs", "[", 
     RowBox[{"Total", "/@", 
      RowBox[{"Transpose", "@", "uturn"}]}], "]"}]}]}], "\n", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uturnBranchSamplingRatio", "[", "uturn_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"inputUturn", "=", "uturn"}], ",", "zeroPosition"}], "}"}], 
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"zeroPosition", "=", 
       RowBox[{"First", "@", 
        RowBox[{"Flatten", "@", 
         RowBox[{"Position", "[", 
          RowBox[{"inputUturn", ",", 
           RowBox[{"_", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"#", "\[Equal]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}]}], "&"}], ")"}]}]}], 
          "]"}]}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Divide", "@@", 
        RowBox[{"Reverse", "@", 
         RowBox[{"MinMax", "[", 
          RowBox[{"Length", "/@", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"inputUturn", "[", 
              RowBox[{"[", 
               RowBox[{"1", ";;", 
                RowBox[{"zeroPosition", "-", "1"}]}], "]"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"inputUturn", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"zeroPosition", "+", "1"}], ";;", "All"}], "]"}], 
              "]"}]}], "\[IndentingNewLine]", "}"}]}], "]"}]}]}], "//", 
       "N"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getUturnMeanVelocity", "[", 
    RowBox[{"uturn_", ",", "uturnVelocity_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"inputUturn", "=", "uturn"}], ",", 
       RowBox[{"inputVelocity", "=", "uturnVelocity"}], ",", 
       "\[IndentingNewLine]", "uturnVelocityFiltered", ",", 
       "uturnCurvatureProfile", ",", "velocityMeasurementIndices"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"uturnVelocityFiltered", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"MeanFilter", "[", 
            RowBox[{"#", ",", "velocityFilterScaleMean"}], "]"}], "&"}], "@", 
          "\[IndentingNewLine]", 
          RowBox[{"MedianFilter", "[", 
           RowBox[{"#", ",", "velocityFilterScaleMedian"}], "]"}]}], "&"}], 
        "@", "inputVelocity"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"uturnCurvatureProfile", "=", 
       RowBox[{"Rescale", "@", 
        RowBox[{"Abs", "@", 
         RowBox[{"getCurvatureProfile", "[", "\[IndentingNewLine]", 
          RowBox[{"inputUturn", ",", "smoothingWindowSizeUturn"}], 
          "\[IndentingNewLine]", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"velocityMeasurementIndices", "=", 
       RowBox[{"Flatten", "@", 
        RowBox[{"Position", "[", "\[IndentingNewLine]", 
         RowBox[{"uturnCurvatureProfile", ",", 
          RowBox[{"_", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#", ">", "velocityMeasurementCurvatureThreshold"}], 
             "&"}], ")"}]}]}], "\[IndentingNewLine]", "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Around", "@@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Mean", "@", "#"}], ",", 
             RowBox[{"StandardDeviation", "@", "#"}]}], "}"}]}], "&"}], "@", 
         RowBox[{"uturnVelocityFiltered", "[", 
          RowBox[{"[", "#", "]"}], "]"}]}], "&"}], "@", 
       RowBox[{"velocityMeasurementIndices", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", 
          RowBox[{"-", "1"}]}], "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]c", "=", 
    RowBox[{"Compile", "[", "\n", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"b", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"c", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"d", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"e", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"f", ",", "_Real"}], "}"}]}], "}"}], ",", "\n", 
      RowBox[{"With", "[", "\n", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"e1", "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"c", ",", "d"}], "}"}], "-", 
            RowBox[{"{", 
             RowBox[{"a", ",", "b"}], "}"}]}]}], ",", 
          RowBox[{"e2", "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"e", ",", "f"}], "}"}], "-", 
            RowBox[{"{", 
             RowBox[{"c", ",", "d"}], "}"}]}]}]}], "}"}], ",", "\n", 
        RowBox[{
         RowBox[{
          RowBox[{"e1", ".", "e2"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Norm", "@", "e1"}], "*", 
            RowBox[{"Norm", "@", "e2"}]}], ")"}]}], "//", "ArcCos"}]}], "\n", 
       "]"}]}], "\n", "]"}]}], ";"}], "\n", "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"kc2", "=", 
    RowBox[{"Compile", "[", "\n", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"b", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"c", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"d", ",", "_Real"}], " ", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"e", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"f", ",", "_Real"}], "}"}]}], "}"}], ",", "\n", 
      RowBox[{"With", "[", "\n", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"n1", "=", 
           RowBox[{"Norm", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"c", ",", "d"}], "}"}], "-", 
             RowBox[{"{", 
              RowBox[{"a", ",", "b"}], "}"}]}], "]"}]}], ",", 
          RowBox[{"n2", "=", 
           RowBox[{"Norm", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"e", ",", "f"}], "}"}], "-", 
             RowBox[{"{", 
              RowBox[{"c", ",", "d"}], "}"}]}], "]"}]}]}], "}"}], ",", "\n", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"\[Beta]c", "[", 
              RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "f"}],
               "]"}], "-", "\[Pi]"}], "]"}], "*", "n1", "*", "n2"}], ")"}], 
         "/", 
         RowBox[{"(", 
          RowBox[{"n1", "+", "n2"}], ")"}]}]}], "\n", "]"}]}], "\n", "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\n", "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"reductionStep", "[", 
     RowBox[{"polygon_", ",", " ", "relevanceFunction_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\n", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"segments", ",", " ", "scores", ",", " ", "worstPoint"}], 
       "}"}], ",", "\n", "\n", 
      RowBox[{
       RowBox[{"segments", "=", 
        RowBox[{"Line", "@", 
         RowBox[{"Range", "@", 
          RowBox[{"Length", "@", "polygon"}]}]}]}], ";", "\n", "\n", 
       RowBox[{"scores", "=", 
        RowBox[{
         RowBox[{"Map", "[", "\n", 
          RowBox[{
           RowBox[{
            RowBox[{"relevanceFunction", "[", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"(", 
               RowBox[{"Flatten", "@", 
                RowBox[{"polygon", "[", 
                 RowBox[{"[", "#", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], ",",
            "\n", 
           RowBox[{"Partition", "[", 
            RowBox[{
             RowBox[{"First", "@", "segments"}], ",", "3", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], "\n", "]"}], "//", 
         "Quiet"}]}], ";", "\n", "\n", 
       RowBox[{"worstPoint", "=", 
        RowBox[{"First", "@", 
         RowBox[{"Ordering", "@", "scores"}]}]}], ";", "\n", 
       RowBox[{"Delete", "[", 
        RowBox[{"polygon", ",", "worstPoint"}], "]"}]}]}], "\n", "]"}]}], 
   ";"}], "\n", "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"curveSimplificationEvolution", "[", 
     RowBox[{"polygon_", ",", "fraq_", ",", "relevanceFunction_"}], "]"}], ":=", 
    RowBox[{"Nest", "[", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"reductionStep", "[", 
        RowBox[{"#", ",", "relevanceFunction"}], "]"}], "&"}], ",", "\n", 
      "polygon", ",", 
      RowBox[{"Round", "[", 
       RowBox[{"fraq", "*", 
        RowBox[{"Length", "@", "polygon"}]}], "]"}]}], "\n", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getSimplifiedClosedCurve", "[", "points_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"inputPoints", "=", "points"}], ",", 
      "simplifiedQuantileBoundary"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"simplifiedQuantileBoundary", "=", 
      RowBox[{"curveSimplificationEvolution", "[", "\[IndentingNewLine]", 
       RowBox[{
       "inputPoints", ",", "envelopeSimplificationFactor", ",", "kc2"}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"simplifiedQuantileBoundary", "[", 
        RowBox[{"[", "#", "]"}], "]"}], "&"}], "@", 
      RowBox[{"First", "@", 
       RowBox[{"FindCurvePath", "@", "simplifiedQuantileBoundary"}]}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQ3bs/bPvhyLeO96pDr4Bp4TvfQPS7w4/AtO3GxYJH
gbTCBwk5EH3Kg2fj4ai3jmd1SzaB6HAtXqejQPrMDyk3EG18zDHlGZC+MC8Z
TL89qpsBopmyJ2WC6P+ZZ849B9LPH1+4CKK5IpcwvATSJxitGUH0halWJm+A
NNuLSjMQLfE6PxZEq4j9BNMh2w9o/ALS7vcW6oJoBedXS/Kj3zqGRaetBNPh
cetAdHHWrE0g+lvakn0gOq3mIJheISHyHUTrfUj6DaJVI/nYC4D0mtwsDhA9
y3CSYQmQVnNZAaalnN3OzgPSx3Y9OQ+iJ604fQdEy3w6B6YBqA2rCw==
  "],
 CellLabel->"In[16]:=",ExpressionUUID->"a61e590c-04a9-4cf6-a3fc-32cb5f055d6a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Plots", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852707680645`*^9}, {3.9392819731476793`*^9, 
   3.9392819836113987`*^9}},ExpressionUUID->"44edc8b1-509b-4471-921f-\
77540503fea2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"getLatexStyling", "[", "latexInput_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"MaTeX", "[", 
        RowBox[{"#", ",", 
         RowBox[{"FontSize", "\[Rule]", 
          RowBox[{"fontSize", "+", "2"}]}]}], "]"}], "&"}], "@", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{"\"\<\\\\boldsymbol{\>\"", "<>", 
        RowBox[{"ToString", "@", "#"}], "<>", "\"\<}\>\""}], 
       "\[IndentingNewLine]", ")"}]}], "&"}], "@", "latexInput"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"exportImagesTwoFormat", "[", 
   RowBox[{"image_", ",", "imageName_", ",", "imageResolution_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"#1", "<>", "imageName", "<>", "#2"}], ",", "image", ",", 
        RowBox[{"ImageResolution", "\[Rule]", "imageResolution"}]}], "]"}], 
      "&"}], "@@", "#"}], "&"}], "/@", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"output", ",", "\"\<.pdf\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"output", ",", "\"\<.svg\>\""}], "}"}]}], "}"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9173879770544786`*^9, 3.917387979902855*^9}, {
  3.9174345459138374`*^9, 3.9174345465671673`*^9}, {3.917438681462643*^9, 
  3.9174386840677614`*^9}, {3.9174447866512585`*^9, 3.917444789406278*^9}, {
  3.917730579941824*^9, 3.9177305806654997`*^9}, {3.9177308275301633`*^9, 
  3.917730827955844*^9}, {3.9287365562768607`*^9, 3.9287366250280466`*^9}, {
  3.9288073004914546`*^9, 3.928807302278285*^9}, {3.928808923404565*^9, 
  3.928808926179047*^9}, {3.939282004879294*^9, 3.9392820181625633`*^9}, {
  3.9402627560786943`*^9, 3.9402627565638056`*^9}, {3.940262888930236*^9, 
  3.9402628903852344`*^9}, {3.9402631643352637`*^9, 3.940263165670109*^9}, {
  3.9402632923440857`*^9, 3.940263294375163*^9}, {3.9402633498876195`*^9, 
  3.9402633506836777`*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"0b998fb2-a1ce-4bff-8c66-d1b106561cb9"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Trajectory Analysis", "Section",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852533120594`*^9}, {3.939282503278178*^9, 
   3.939282510338646*^9}},ExpressionUUID->"251bc731-31dd-4327-94e1-\
1c057044d74a"],

Cell[CellGroupData[{

Cell["Get Track Data & Parameters", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852707680645`*^9}, {3.9392826017876596`*^9, 3.939282627811635*^9}, {
   3.939282666920994*^9, 3.9392826766201773`*^9}, {3.9399057910005198`*^9, 
   3.939905791352308*^9}},ExpressionUUID->"2dc9e86c-4886-419f-88a7-\
99745c4a627e"],

Cell["\<\
Pixel size :\[LineSeparator]
cocci_moment:   0.11 \[Mu]m
U_turns_for_validation:   0.11 \[Mu]m
U_turns_with_MF:   0.11 \[Mu]m
 
  --------------------------------------------------
FPS/frame duration :

cocci_moment:   40 fps / 25 ms
U_turns_for_validation:   40 fps / 25 ms
U_turns_with_MF:   20 fps / 50 ms\
\>", "Abstract",
 CellChangeTimes->{{3.860734951349084*^9, 3.860735026478571*^9}, {
   3.8609146608535275`*^9, 3.8609146900929856`*^9}, 3.8609204395870028`*^9, {
   3.8609205850911922`*^9, 3.860920585251766*^9}, {3.861617003782383*^9, 
   3.861617047418807*^9}, {3.8616503848168697`*^9, 3.861650394647577*^9}, {
   3.861694332607851*^9, 3.861694365734353*^9}, {3.86169440087022*^9, 
   3.8616944709419107`*^9}, {3.861694614767084*^9, 3.861694644189275*^9}, {
   3.8616998710451202`*^9, 3.861699879369816*^9}, {3.8852939036655765`*^9, 
   3.8852939204171*^9}, {3.888395947610839*^9, 3.888395983866202*^9}, {
   3.8883964152975245`*^9, 3.888396472672748*^9}, {3.888913733747225*^9, 
   3.888913750746273*^9}, {3.8969452347374234`*^9, 3.8969452884043727`*^9}, {
   3.898162639472965*^9, 3.8981626460249853`*^9}, 3.8997981936052575`*^9, {
   3.8998709924898815`*^9, 3.899871054646696*^9}, {3.900049176114311*^9, 
   3.9000491834023952`*^9}, {3.9006757674573708`*^9, 3.900675808736613*^9}, {
   3.9006758414894085`*^9, 3.900675860241229*^9}, {3.900744452232774*^9, 
   3.9007444595306845`*^9}, {3.9156231328148594`*^9, 3.91562318337386*^9}, {
   3.917003375112545*^9, 3.9170033903040533`*^9}, {3.9170035930569696`*^9, 
   3.91700359603172*^9}, {3.917003653553728*^9, 3.917003691932147*^9}, {
   3.9170037260931644`*^9, 3.917003777433728*^9}, {3.9170388210022388`*^9, 
   3.917038861524263*^9}, {3.9174670210841994`*^9, 3.9174670467261143`*^9}, {
   3.9272892394178343`*^9, 3.927289268242099*^9}, {3.92730135573736*^9, 
   3.927301357626377*^9}, {3.927387257960538*^9, 3.9273872609211917`*^9}, {
   3.9278038369995704`*^9, 3.927803837143662*^9}, {3.927803872977233*^9, 
   3.9278038968471723`*^9}, 3.93928259281195*^9, {3.9392826375417194`*^9, 
   3.939282643732319*^9}},ExpressionUUID->"6d541f13-203d-43b4-8a26-\
d68b0a96ef9f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
   "mainDataFolder", "=", 
    "\"\<D:\\\\Science\\\\MMML\\\\Image Processing\\\\Bacteria \
Tracking\\\\Output\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pixelSizeMicroMeters", "=", "0.11"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"frameRate", "=", "20"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"frameDurationMiliSeconds", "=", 
   RowBox[{"1000", "/", "frameRate"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"frameDurationSeconds", "=", 
    RowBox[{
     RowBox[{"frameDurationMiliSeconds", "/", "1000"}], "//", "N"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"histogramBinningMethod", "=", "\"\<FreedmanDiaconis\>\""}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"trackDataFolder", "=", "\"\<MF-2\\\\Compressed Data\\\\\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fileFolder", "=", 
   RowBox[{"SetDirectory", "[", 
    RowBox[{
    "mainDataFolder", "<>", "$PathnameSeparator", "<>", "trackDataFolder"}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"trackDataRaw", "=", 
   RowBox[{"Uncompress", "@", 
    RowBox[{"Import", "[", "\[IndentingNewLine]", 
     RowBox[{
     "fileFolder", "<>", "$PathnameSeparator", "<>", 
      "\"\<Bacteria Tracks Data Unified.txt\>\""}], "\[IndentingNewLine]", 
     "]"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9392825964524465`*^9, 3.9392825964533916`*^9}, 
   3.9392826517879553`*^9, {3.9392827067152753`*^9, 3.9392828789814887`*^9}, {
   3.939283711555575*^9, 3.9392837618619947`*^9}, {3.94015130211043*^9, 
   3.940151313933134*^9}, 3.9403104473930435`*^9, 3.9403118460255084`*^9, 
   3.9403122735699263`*^9, 3.940505448855505*^9},
 CellLabel->
  "In[589]:=",ExpressionUUID->"25b72481-4ea2-4cce-b1bc-7581e71fb0c3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["[[ Preview Raw Track Data ]]", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852707680645`*^9}, {3.939283916115666*^9, 3.939283923995065*^9}, {
   3.9393072447188826`*^9, 
   3.9393072455718374`*^9}},ExpressionUUID->"658b2db2-476c-4998-9a46-\
7cf4c753e75c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"tracksRaw", "=", 
     RowBox[{"getTrackCoordinates", "/@", "trackDataRaw"}]}], ";"}], "//", 
   "AbsoluteTiming"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"GraphicsRow", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"ListLinePlot", "[", 
           RowBox[{"#", ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "@", 
         "#"}], 
        RowBox[{"(*", 
         RowBox[{",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"ListLinePlot", "[", 
             RowBox[{"#", ",", 
              RowBox[{"PlotRange", "\[Rule]", "Automatic"}]}], "]"}], "&"}], 
           "@", "#"}]}], "*)"}], "\[IndentingNewLine]", "}"}], "&"}], "@", 
      RowBox[{"tracksRaw", "[", 
       RowBox[{"[", "testID", "]"}], "]"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "\[IndentingNewLine]", 
    "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"testID", ",", "1", ",", 
     RowBox[{"Length", "@", "tracksRaw"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.939285857273695*^9, 3.939285881883772*^9}, {
  3.9402248287182274`*^9, 3.9402248311335316`*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"296a4537-12b3-41d9-9128-4d9c4fe03358"],

Cell[BoxData[{
 RowBox[{"Length", "@", "trackDataRaw"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Length", "/@", "trackDataRaw"}], "//", 
  RowBox[{
   RowBox[{"Histogram", "[", 
    RowBox[{"#", ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"ScalingFunctions", "\[Rule]", "\"\<Log10\>\""}]}], "]"}], 
   "&"}]}]}], "Input",
 CellChangeTimes->{{3.9393064717827272`*^9, 3.9393065063087482`*^9}, {
   3.9393073215597506`*^9, 3.939307322652878*^9}, {3.939307424518484*^9, 
   3.9393074340000224`*^9}, {3.939307504981305*^9, 3.9393075056097574`*^9}, 
   3.93935911081678*^9},
 CellLabel->"In[66]:=",ExpressionUUID->"1db7823c-1164-465d-b02d-12dcd28537dd"],

Cell["\<\
=== MF-2 tests ===

Notable tracks: {5, 6, 8, 9, 17, 24, 361, 372, 385, 386, 393, 396, 829}  \
[[RAW]]
24 is a nice benchmark for U-turn decomposition\[LineSeparator]Potentially \
useful for figures/visuals\
\>", "Abstract",
 CellChangeTimes->{{3.9392949906710997`*^9, 3.9392950001954107`*^9}, {
  3.939295066046317*^9, 3.9392950927342014`*^9}, {3.939307022230593*^9, 
  3.9393071606539865`*^9}, {3.939307217411355*^9, 3.9393072206830053`*^9}, {
  3.9393076234521294`*^9, 3.9393076368191233`*^9}, {3.9393078800360575`*^9, 
  3.939307900060156*^9}, {3.94031048071093*^9, 
  3.9403104971391134`*^9}},ExpressionUUID->"f83084b4-a8c7-41dd-8046-\
7b7aa30c0908"]
}, Closed]],

Cell[CellGroupData[{

Cell["Filter Track Data", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852707680645`*^9}, {3.939283916115666*^9, 3.939283923995065*^9}, {
   3.9393072447188826`*^9, 3.9393072455718374`*^9}, {3.9393119536702523`*^9, 
   3.9393119572015734`*^9}},ExpressionUUID->"03837fc2-9be2-475b-b683-\
12eba96a955d"],

Cell[CellGroupData[{

Cell["Filter By Temporal Length", "Subsubsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852707680645`*^9}, {3.939283916115666*^9, 3.939283923995065*^9}, {
   3.9393072447188826`*^9, 3.9393072455718374`*^9}, {3.9393119536702523`*^9, 
   3.9393119572015734`*^9}, {3.939363180003191*^9, 
   3.9393631830770564`*^9}},ExpressionUUID->"21f30b6f-ac38-4d12-ab13-\
5b79f46616be"],

Cell["\<\
Defaults:

trackLengthThreshold=10;\
\>", "Abstract",
 CellChangeTimes->{{3.9392949906710997`*^9, 3.9392950001954107`*^9}, {
  3.939295066046317*^9, 3.9392950927342014`*^9}, {3.939307022230593*^9, 
  3.9393071606539865`*^9}, {3.939307217411355*^9, 3.9393072206830053`*^9}, {
  3.9393076234521294`*^9, 3.9393076368191233`*^9}, {3.9393078800360575`*^9, 
  3.939307900060156*^9}, {3.9393658470997615`*^9, 3.939365854517826*^9}, {
  3.9398969926314845`*^9, 
  3.9398969926829586`*^9}},ExpressionUUID->"de03ec6b-cb52-4527-8ed1-\
bad031ee8c95"],

Cell[BoxData[
 RowBox[{
  RowBox[{"trackLengthThreshold", "=", "10"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.939307344007593*^9, 3.939307344828437*^9}, {
  3.9393079224463034`*^9, 3.9393079226935253`*^9}, {3.9398964816310644`*^9, 
  3.9398964949720078`*^9}, {3.9403105215523014`*^9, 3.9403105225352*^9}, {
  3.9405054820878477`*^9, 3.9405055085990057`*^9}, {3.940514113301551*^9, 
  3.940514114700062*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"aafec580-c6f2-4c1b-ba1b-eb8701155b7e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"trackDataThresholded", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"trackDataRaw", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "@", "#"}], ">", "trackLengthThreshold"}], "&"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Length", "@", "trackDataThresholded"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Length", "/@", "trackDataThresholded"}], "//", 
   RowBox[{
    RowBox[{"Histogram", "[", "\[IndentingNewLine]", 
     RowBox[{"#", ",", "histogramBinningMethod", ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
      RowBox[{"ScalingFunctions", "\[Rule]", "\"\<Log10\>\""}]}], 
     "\[IndentingNewLine]", "]"}], "&"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tracksThresholded", "=", 
    RowBox[{"getTrackCoordinates", "/@", "trackDataThresholded"}]}], ";"}], "//",
   "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.939307328076582*^9, 3.939307340220606*^9}, {
   3.9393074521917276`*^9, 3.9393074760040913`*^9}, {3.9393076049362426`*^9, 
   3.9393076089518957`*^9}, 3.939359106551567*^9, {3.9393634881188765`*^9, 
   3.9393634883275566`*^9}, {3.9401511899418144`*^9, 3.9401512054839654`*^9}, 
   3.9401513247756414`*^9},
 CellLabel->"In[69]:=",ExpressionUUID->"711a5b9f-4558-4a6a-bdf0-50c25b03103d"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"GraphicsRow", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"ListLinePlot", "[", 
           RowBox[{"#", ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "@", 
         "#"}], 
        RowBox[{"(*", 
         RowBox[{",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"ListLinePlot", "[", 
             RowBox[{"#", ",", 
              RowBox[{"PlotRange", "\[Rule]", "Automatic"}]}], "]"}], "&"}], 
           "@", "#"}]}], "*)"}], "\[IndentingNewLine]", "}"}], "&"}], "@", 
      RowBox[{"tracksThresholded", "[", 
       RowBox[{"[", "testID", "]"}], "]"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "\[IndentingNewLine]", 
    "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"testID", ",", "1", ",", 
     RowBox[{"Length", "@", "tracksThresholded"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.939307699557129*^9, 3.9393077022728643`*^9}, 
   3.9393077760629663`*^9, {3.939309537127639*^9, 3.9393095405795183`*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"f88b986c-9599-4772-819e-96116b81e82e"]
}, Closed]],

Cell[CellGroupData[{

Cell["Filter By Oriented Aspect Ratio", "Subsubsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852707680645`*^9}, {3.939283916115666*^9, 3.939283923995065*^9}, {
   3.9393072447188826`*^9, 3.9393072455718374`*^9}, {3.9393119536702523`*^9, 
   3.9393119572015734`*^9}, {3.939363180003191*^9, 
   3.939363199178438*^9}},ExpressionUUID->"d1b98fde-5faf-4faa-ac13-\
08f6e917b3a6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"trackAspectRatio", "=", 
     RowBox[{"getTrackAspectRatio", "/@", "tracksThresholded"}]}], ";"}], "//",
    "AbsoluteTiming"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"trackAspectRatio", "//", 
  RowBox[{
   RowBox[{"Histogram", "[", "\[IndentingNewLine]", 
    RowBox[{"#", ",", "histogramBinningMethod", ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"ScalingFunctions", "\[Rule]", "\"\<Log10\>\""}]}], 
    "\[IndentingNewLine]", "]"}], "&"}]}]}], "Input",
 CellChangeTimes->{{3.939309490717128*^9, 3.9393095044949093`*^9}, {
  3.9393096264649773`*^9, 3.9393096374020357`*^9}, {3.9393116489312315`*^9, 
  3.9393116673208127`*^9}, {3.939358889233016*^9, 3.939358890910751*^9}, {
  3.9393634560433426`*^9, 3.939363475559507*^9}, {3.9401512175648975`*^9, 
  3.9401512221400414`*^9}, {3.9401513284955463`*^9, 3.9401513429088306`*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"862f0cef-c8fa-400f-b68c-3e9f301c711d"],

Cell["\<\
Defaults:

ttrackAspectRatioThreshold=10;\
\>", "Abstract",
 CellChangeTimes->{{3.9392949906710997`*^9, 3.9392950001954107`*^9}, {
   3.939295066046317*^9, 3.9392950927342014`*^9}, {3.939307022230593*^9, 
   3.9393071606539865`*^9}, {3.939307217411355*^9, 3.9393072206830053`*^9}, {
   3.9393076234521294`*^9, 3.9393076368191233`*^9}, {3.9393078800360575`*^9, 
   3.939307900060156*^9}, {3.9393658470997615`*^9, 3.9393658751808567`*^9}, 
   3.9405141493565564`*^9},ExpressionUUID->"ed6f3c1a-4446-4905-ae27-\
6f0eb8d1a902"],

Cell[BoxData[
 RowBox[{
  RowBox[{"trackAspectRatioThreshold", "=", "10"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9393140877298994`*^9, 3.9393140944025965`*^9}, 
   3.939314618267257*^9, {3.939896506060462*^9, 3.9398965061070166`*^9}, {
   3.9398965511786427`*^9, 3.939896552371126*^9}, {3.9399099833721685`*^9, 
   3.9399100046828403`*^9}, {3.940505464927641*^9, 3.9405054649824944`*^9}, 
   3.9405119870274873`*^9, {3.9405141447096195`*^9, 3.9405141448292384`*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"7dc85ed3-957c-4d9b-afb5-fffbebd312c9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"trackDataThresholdedAspect", "=", 
    RowBox[{"First", "@", 
     RowBox[{"Transpose", "@", 
      RowBox[{"Last", "@", 
       RowBox[{"GatherBy", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Transpose", "@", 
          RowBox[{"{", 
           RowBox[{"trackDataThresholded", ",", "trackAspectRatio"}], "}"}]}],
          ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Last", "@", "#"}], "<", "trackAspectRatioThreshold"}], 
          "&"}]}], "\[IndentingNewLine]", "]"}]}]}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"trackDataThresholdedAspect", "=", 
      RowBox[{"Select", "[", "\[IndentingNewLine]", 
       RowBox[{"trackDataThresholded", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"getTrackAspectRatio", "@", 
           RowBox[{"getTrackCoordinates", "@", "#"}]}], "<", 
          "trackAspectRatioThreshold"}], "&"}]}], "\[IndentingNewLine]", 
       "]"}]}], ";"}], "//", "AbsoluteTiming"}], "*)"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"tracksThresholdedAspect", "=", 
   RowBox[{"getTrackCoordinates", "/@", "trackDataThresholdedAspect"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "@", "trackDataThresholdedAspect"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Length", "/@", "trackDataThresholdedAspect"}], "//", 
   RowBox[{
    RowBox[{"Histogram", "[", 
     RowBox[{"#", ",", "histogramBinningMethod"}], "]"}], "&"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Length", "/@", "trackDataThresholdedAspect"}], "//", 
  RowBox[{
   RowBox[{"Histogram", "[", "\[IndentingNewLine]", 
    RowBox[{"#", ",", "histogramBinningMethod", ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"ScalingFunctions", "\[Rule]", "\"\<Log10\>\""}]}], 
    "\[IndentingNewLine]", "]"}], "&"}]}]}], "Input",
 CellChangeTimes->{{3.9393143256319666`*^9, 3.9393143828487487`*^9}, {
  3.939314429451131*^9, 3.9393145201861615`*^9}, {3.9393145524991693`*^9, 
  3.93931455375212*^9}, {3.9393590143260813`*^9, 3.9393590814880767`*^9}, {
  3.9393633991411805`*^9, 3.939363435956916*^9}, {3.940151234718526*^9, 
  3.940151256412551*^9}, {3.940151329864047*^9, 3.940151330783298*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"243abe2b-25c3-48ab-a4a6-b2a2e7384404"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"GraphicsRow", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"ListLinePlot", "[", 
           RowBox[{"#", ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "@", 
         "#"}], 
        RowBox[{"(*", 
         RowBox[{",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"ListLinePlot", "[", 
             RowBox[{"#", ",", 
              RowBox[{"PlotRange", "\[Rule]", "Automatic"}]}], "]"}], "&"}], 
           "@", "#"}]}], "*)"}], "\[IndentingNewLine]", "}"}], "&"}], "@", 
      RowBox[{"tracksThresholdedAspect", "[", 
       RowBox[{"[", "testID", "]"}], "]"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "\[IndentingNewLine]", 
    "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"testID", ",", "1", ",", 
     RowBox[{"Length", "@", "tracksThresholdedAspect"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.939307699557129*^9, 3.9393077022728643`*^9}, 
   3.9393077760629663`*^9, {3.939309537127639*^9, 3.9393095405795183`*^9}, {
   3.939314591243925*^9, 3.9393145940529623`*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"47def790-f795-4b35-b558-aded6e61bc0c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Small-scale Coordinate Filtering", "Subsubsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852707680645`*^9}, {3.939283916115666*^9, 3.939283923995065*^9}, {
   3.9393072447188826`*^9, 3.9393072455718374`*^9}, {3.9393119536702523`*^9, 
   3.9393119572015734`*^9}, {3.939363180003191*^9, 
   3.939363226228035*^9}},ExpressionUUID->"e8674e99-f94f-460c-bc75-\
23c1fcfe3d18"],

Cell["\<\
Defaults:

medianFilterScale=1;
meanFilterScale=1;\
\>", "Abstract",
 CellChangeTimes->{{3.9392949906710997`*^9, 3.9392950001954107`*^9}, {
  3.939295066046317*^9, 3.9392950927342014`*^9}, {3.939307022230593*^9, 
  3.9393071606539865`*^9}, {3.939307217411355*^9, 3.9393072206830053`*^9}, {
  3.9393076234521294`*^9, 3.9393076368191233`*^9}, {3.9393078800360575`*^9, 
  3.939307900060156*^9}, {3.9393658470997615`*^9, 
  3.9393658827170153`*^9}},ExpressionUUID->"497e42e4-52e7-47e5-bbd9-\
8b6e3911afce"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"medianFilterScale", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"meanFilterScale", "=", "1"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9174383487881947`*^9, 3.9174383623526206`*^9}, 
   3.917438483836116*^9, {3.917439884238102*^9, 3.917439933600683*^9}, {
   3.917439969522348*^9, 3.9174399868412533`*^9}, 3.9287353469378767`*^9, {
   3.9287373842418747`*^9, 3.9287373944257026`*^9}, {3.9393657710611954`*^9, 
   3.939365790802004*^9}, 3.939365823644082*^9},
 CellLabel->"In[83]:=",ExpressionUUID->"21ba08e1-c778-4eaf-9a69-3b4f06612ba6"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"checkTrack", "=", 
     RowBox[{"tracksThresholdedAspect", "[", 
      RowBox[{"[", "testID", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"checkTrackSmoothed", "=", 
     RowBox[{"getFilteredTrack", "@", "checkTrack"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"GraphicsRow", "[", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ListLinePlot", "[", 
        RowBox[{"checkTrack", ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{"checkTrackSmoothed", ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
      "\[IndentingNewLine]", "}"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"testID", ",", "1", ",", 
     RowBox[{"Length", "@", "tracksThresholdedAspect"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{
  3.9392841050278025`*^9, {3.9392844611890664`*^9, 3.9392845474126825`*^9}, {
   3.939285301432496*^9, 3.939285304468599*^9}, {3.9392853596813145`*^9, 
   3.9392853684715357`*^9}, 3.9392854996714473`*^9, {3.9392859904490013`*^9, 
   3.939286018340293*^9}, {3.9392905952920103`*^9, 3.939290598713045*^9}, 
   3.9392909928510666`*^9, {3.939291422907284*^9, 3.9392914338908377`*^9}, {
   3.9392915946913023`*^9, 3.939291753257693*^9}, {3.9392919074518766`*^9, 
   3.93929193804993*^9}, {3.9392921190017495`*^9, 3.9392923505213346`*^9}, {
   3.9392924180545597`*^9, 3.9392924188502526`*^9}, {3.9392927331078076`*^9, 
   3.9392927676758027`*^9}, {3.939294525629036*^9, 3.939294526094608*^9}, {
   3.9392946990464*^9, 3.939294711364167*^9}, {3.9392947413653765`*^9, 
   3.9392947557633643`*^9}, {3.939294786125023*^9, 3.9392947973005886`*^9}, {
   3.9392951154631553`*^9, 3.9392951553021803`*^9}, {3.9392952306453314`*^9, 
   3.939295244452744*^9}, {3.9392952879922247`*^9, 3.939295312753789*^9}, {
   3.9392954167738085`*^9, 3.9392954307021775`*^9}, {3.939359157174402*^9, 
   3.9393591711110587`*^9}, {3.9393594615223193`*^9, 
   3.9393594685285997`*^9}, {3.939359499031221*^9, 3.9393595041933393`*^9}, 
   3.9393595557280416`*^9, {3.9393600006461377`*^9, 3.939360032439313*^9}, {
   3.939360118847767*^9, 3.9393601630243096`*^9}, 3.939363278620414*^9},
 CellLabel->"In[85]:=",ExpressionUUID->"742db6c7-f474-40ba-a2e8-b73176543faf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"tracksFiltered", "=", 
     RowBox[{
      RowBox[{"getFilteredTrack", "/@", "tracksThresholdedAspect"}], "//", 
      "Parallelize"}]}], ";"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"trackDataClean", "=", 
   RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"mergeTrackData", "[", 
       RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"trackDataThresholdedAspect", ",", "tracksFiltered"}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9393632308542824`*^9, 3.939363249402817*^9}, {
  3.939363364555208*^9, 3.939363387230319*^9}, {3.939364727406491*^9, 
  3.9393647345721073`*^9}},
 CellLabel->"In[86]:=",ExpressionUUID->"bb16ee16-7784-43a5-bf59-de890de9c78a"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"GraphicsRow", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"ListLinePlot", "[", 
           RowBox[{"#", ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "@", 
         "#"}], 
        RowBox[{"(*", 
         RowBox[{",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"ListLinePlot", "[", 
             RowBox[{"#", ",", 
              RowBox[{"PlotRange", "\[Rule]", "Automatic"}]}], "]"}], "&"}], 
           "@", "#"}]}], "*)"}], "\[IndentingNewLine]", "}"}], "&"}], "@", 
      RowBox[{"tracksFiltered", "[", 
       RowBox[{"[", "testID", "]"}], "]"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "\[IndentingNewLine]", 
    "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"testID", ",", "1", ",", 
     RowBox[{"Length", "@", "tracksFiltered"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.9393635320392647`*^9, 3.9393635326363797`*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"840a7cb6-0711-4c39-9ed9-758ea4c36a44"],

Cell["\<\
=== MF-2 tests ===

Notable tracks: \
{5,11,16,22,24,25,26,28,38,50,52,53,71,75,76,77,85,91,95,97,106,120,123,125}  \
[[filtered]]
16 is a nice benchmark for U-turn decomposition\[LineSeparator]Potentially \
useful for figures/visuals
Extreme negative cases: {13,14,15,17}\
\>", "Abstract",
 CellChangeTimes->{{3.9392949906710997`*^9, 3.9392950001954107`*^9}, {
  3.939295066046317*^9, 3.9392950927342014`*^9}, {3.939307022230593*^9, 
  3.9393071606539865`*^9}, {3.939307217411355*^9, 3.9393072206830053`*^9}, {
  3.9393076234521294`*^9, 3.9393076368191233`*^9}, {3.9393078800360575`*^9, 
  3.939307900060156*^9}, {3.9393595798233175`*^9, 3.9393596982149186`*^9}, {
  3.9393597301967907`*^9, 3.9393597559811115`*^9}, {3.939359811940854*^9, 
  3.9393599214414682`*^9}, {3.9403106112954254`*^9, 
  3.9403106166875505`*^9}},ExpressionUUID->"aceab945-948c-41a7-b6b1-\
c7305372d255"]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["U-turn Decomposition", "Section",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852533120594`*^9}, {3.939282491291642*^9, 3.9392824968283243`*^9}, {
   3.9393119812062926`*^9, 3.939311985870982*^9}, {3.9393638268049383`*^9, 
   3.939363828802686*^9}, {3.9393666566840653`*^9, 
   3.939366658598335*^9}},ExpressionUUID->"70fe8269-0960-4108-927f-\
c817acfabaf7"],

Cell[CellGroupData[{

Cell["Decomposition Test Module Definition (RUN)", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852842898235`*^9}, {3.939366646991769*^9, 3.9393666626603208`*^9}, {
   3.939366723532305*^9, 3.939366741053216*^9}, {3.9400757505689244`*^9, 
   3.940075752477825*^9}},ExpressionUUID->"5a663362-3005-46c7-8d7c-\
29f04fef8305"],

Cell[BoxData[
 RowBox[{
  RowBox[{"testModuleUturnDecompose", "[", "track_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"inputTrack", "=", "track"}], ",", "testTrack", ",", 
      "testTrackTurningCurves", ",", "testTrackTurningLaplacian", ",", 
      "\[IndentingNewLine]", "testTrackTurningPointsIDs", ",", 
      "trackTurningPoints", ",", "plotTurningPoints", ",", 
      "\[IndentingNewLine]", "testTrackCurvature", ",", 
      "curvaturePeakPositions", ",", "curvaturePeakValues", ",", 
      "curvaturePeaks", ",", "plotCurvaturePeaks", ",", "trackEndPoints", ",",
       "trackUturnPoints", ",", "\[IndentingNewLine]", "curvaturePeakPoints", 
      ",", "trackSplitNodes", ",", "trackSplitIDs", ",", "trackUturns", ",", 
      "\[IndentingNewLine]", "trackUturnsClean", ",", 
      "curvaturePeakPointsClean"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"testTrack", "=", "inputTrack"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"testTrack", "//", "ListLinePlot"}], "//", "Print"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Get", " ", "Track", " ", "Turning", " ", "Points"}], "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"testTrackTurningCurves", "=", 
      RowBox[{"getTurningPointCurvesAll", "@", "testTrack"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"testTrackTurningLaplacian", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"DerivativeFilter", "[", "\[IndentingNewLine]", 
          RowBox[{"#", ",", 
           RowBox[{"{", "2", "}"}], ",", "derivativeGaussKernelScale"}], 
          "\[IndentingNewLine]", "]"}], "&"}], "/@", 
        "testTrackTurningCurves"}], "//", "Abs"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"GraphicsRow", "[", 
       RowBox[{"ListLinePlot", "/@", 
        RowBox[{"{", 
         RowBox[{"testTrackTurningCurves", ",", "testTrackTurningLaplacian"}],
          "}"}]}], "]"}], "//", "Print"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"testTrackTurningPointsIDs", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Flatten", "@", 
           RowBox[{"Position", "[", 
            RowBox[{"#", ",", 
             RowBox[{"_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"#", "\[Equal]", "1"}], "&"}], ")"}]}]}], "]"}]}], 
          "&"}], "@", 
         RowBox[{"PeakDetect", "[", "\[IndentingNewLine]", 
          RowBox[{"#", ",", "peakSmoothingKernelScale", ",", "Automatic", ",", 
           RowBox[{"turningPeakThreshold", "*", 
            RowBox[{"Max", "@", "#"}]}]}], "\[IndentingNewLine]", "]"}]}], 
        "&"}], "/@", "testTrackTurningLaplacian"}]}], ";", "\n", "\n", 
     RowBox[{"trackTurningPoints", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"testTrack", "[", 
           RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
         RowBox[{"Flatten", "[", 
          RowBox[{"#", ",", "1"}], "]"}]}], "&"}], "@", 
       "testTrackTurningPointsIDs"}]}], ";", "\n", "\[IndentingNewLine]", 
     RowBox[{"plotTurningPoints", "=", 
      RowBox[{"Show", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ListLinePlot", "@", "testTrack"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{"trackTurningPoints", ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"Red", ",", 
              RowBox[{"PointSize", "@", "0.025"}]}], "]"}]}]}], "]"}]}], 
        "\[IndentingNewLine]", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Get", " ", "U"}], "-", 
       RowBox[{"turn", " ", "Peak", " ", "Points"}]}], "*)"}], 
     "\[IndentingNewLine]", "\n", 
     RowBox[{"testTrackCurvature", "=", 
      RowBox[{"getCurvatureProfile", "[", 
       RowBox[{"testTrack", ",", "smoothingWindowSize"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"curvaturePeakPositions", "=", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Position", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"PeakDetect", "[", 
          RowBox[{
           RowBox[{"Abs", "@", "testTrackCurvature"}], ",", 
           "gaussianFilterScale"}], "\[IndentingNewLine]", "]"}], ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", "\[Equal]", "1"}], "&"}], ")"}]}]}], 
        "\[IndentingNewLine]", "]"}]}]}], ";", "\[IndentingNewLine]", "\n", 
     RowBox[{"curvaturePeakValues", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"testTrackCurvature", "[", 
         RowBox[{"[", "#", "]"}], "]"}], "&"}], "@", 
       "curvaturePeakPositions"}]}], ";", "\n", "\[IndentingNewLine]", 
     RowBox[{"curvaturePeaks", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Select", "[", "\[IndentingNewLine]", 
         RowBox[{"#", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "@", 
             RowBox[{"Last", "@", "#"}]}], ">", 
            RowBox[{"peakThreshold", "*", 
             RowBox[{"Max", "@", 
              RowBox[{"Abs", "@", 
               RowBox[{"Last", "@", "#"}]}]}]}]}], "&"}]}], 
         "\[IndentingNewLine]", "]"}], "&"}], "@", 
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{"curvaturePeakPositions", ",", "curvaturePeakValues"}], 
         "}"}]}]}]}], ";", "\[IndentingNewLine]", "\n", 
     RowBox[{"plotCurvaturePeaks", "=", 
      RowBox[{"Show", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"testTrackCurvature", "//", 
          RowBox[{
           RowBox[{"ListLinePlot", "[", 
            RowBox[{"#", ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{"#", ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", "Red"}]}], "]"}], "&"}], "@", 
          "curvaturePeaks"}]}], "\[IndentingNewLine]", "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"GraphicsRow", "[", 
       RowBox[{"{", 
        RowBox[{"plotTurningPoints", ",", "plotCurvaturePeaks"}], "}"}], 
       "]"}], "//", "Print"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Get", " ", "U"}], "-", 
       RowBox[{"turn", " ", "Split", " ", "Points"}]}], "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"trackEndPoints", "=", 
      RowBox[{"testTrack", "[", 
       RowBox[{"[", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"curvaturePeakPoints", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"curvaturePeakPointPadding", ";;", "All"}], "]"}], "]"}], 
          "&"}], "@", 
         RowBox[{"testTrack", "[", 
          RowBox[{"[", "#", "]"}], "]"}]}], "&"}], "@", 
       RowBox[{"First", "@", 
        RowBox[{"Transpose", "@", "curvaturePeaks"}]}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"trackUturnPoints", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{"curvaturePeakPoints", ",", "trackEndPoints"}], "]"}]}], ";", 
     "\n", "\n", 
     RowBox[{"trackSplitNodes", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"testTrack", "[", 
           RowBox[{"[", "#", "]"}], "]"}], "&"}], "@", 
         RowBox[{"resolveSplitNodeOverlaps", "[", 
          RowBox[{"testTrack", ",", "#", ",", "3"}], "]"}]}], "&"}], "@", 
       RowBox[{"DeleteDuplicates", "@", 
        RowBox[{"Join", "[", "\[IndentingNewLine]", 
         RowBox[{"curvaturePeakPoints", ",", "trackEndPoints", ",", 
          RowBox[{"Complement", "[", 
           RowBox[{"trackTurningPoints", ",", "trackUturnPoints"}], "]"}]}], 
         "\[IndentingNewLine]", "]"}]}]}]}], ";", "\[IndentingNewLine]", "\n", 
     RowBox[{
      RowBox[{"ImageCollage", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListLinePlot", "@", "testTrack"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"ListPlot", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"PlotStyle", "\[Rule]", 
                  RowBox[{"Directive", "[", 
                   RowBox[{"Red", ",", 
                    RowBox[{"PointSize", "@", "0.02"}]}], "]"}]}]}], "]"}], 
               "&"}], "@", "trackSplitNodes"}]}], "\[IndentingNewLine]", 
            "}"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Show", "[", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListLinePlot", "@", "testTrack"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"ListPlot", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"PlotStyle", "\[Rule]", 
                  RowBox[{"Directive", "[", 
                   RowBox[{"Orange", ",", 
                    RowBox[{"PointSize", "@", "0.02"}]}], "]"}]}]}], "]"}], 
               "&"}], "@", "curvaturePeakPoints"}]}], "\[IndentingNewLine]", 
            "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Full"}], ",", 
        RowBox[{"Background", "\[Rule]", "None"}], ",", 
        RowBox[{"ImagePadding", "\[Rule]", "10"}]}], "]"}], "//", "Print"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Get", " ", "Pruned", " ", "U"}], "-", "turns"}], "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"trackSplitIDs", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"MinMax", "/@", 
         RowBox[{"partitionRagged", "[", 
          RowBox[{"#", ",", 
           RowBox[{
            RowBox[{"Length", "@", "#"}], "-", "2"}], ",", "2"}], "]"}]}], 
        "&"}], "@", 
       RowBox[{"Sort", "@", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{"testTrack", ",", "#"}], "]"}], "&"}], "/@", 
          "trackSplitNodes"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"trackUturns", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"getPrunedUturn", "@", 
         RowBox[{"Take", "[", 
          RowBox[{"testTrack", ",", "#"}], "]"}]}], "&"}], "/@", 
       "trackSplitIDs"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"trackUturnsClean", "=", 
      RowBox[{"trackUturns", "//", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"#", ",", 
          RowBox[{
           RowBox[{"ContainsAny", "[", 
            RowBox[{"#", ",", "curvaturePeakPoints"}], "]"}], "&"}]}], "]"}], 
        "&"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"curvaturePeakPointsClean", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"#", ",", "1"}], "]"}], "&"}], "@", 
         RowBox[{"Intersection", "[", 
          RowBox[{"#", ",", "curvaturePeakPoints"}], "]"}]}], "&"}], "/@", 
       "trackUturnsClean"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ImageCollage", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ListLinePlot", "/@", "trackUturnsClean"}], ",", 
        RowBox[{"Background", "\[Rule]", "None"}], ",", 
        RowBox[{"ImagePadding", "\[Rule]", "10"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Full"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Method", "\[Rule]", "\"\<Grid\>\""}]}], 
       "\[IndentingNewLine]", "]"}], "//", "Print"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9393656810739136`*^9, 3.93936575289205*^9}, {
   3.9393659002443314`*^9, 3.9393661090160646`*^9}, {3.9393661617507563`*^9, 
   3.939366275262624*^9}, {3.9393663258310614`*^9, 3.939366354000995*^9}, {
   3.939366908959118*^9, 3.9393669540647135`*^9}, 3.9393672993358803`*^9, {
   3.939368368118529*^9, 3.9393683936478367`*^9}, {3.939370406728928*^9, 
   3.9393704799776144`*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"8c9a789e-58c5-4d1d-a1e8-356445181bda"]
}, Closed]],

Cell[CellGroupData[{

Cell["[[ Preview U-turn Decomposition Stages ]]", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852842898235`*^9}, {3.939366646991769*^9, 3.9393666626603208`*^9}, {
   3.9399010723806257`*^9, 
   3.9399010738481255`*^9}},ExpressionUUID->"c3214b35-0882-4214-93c9-\
2aef917d42ec"],

Cell["\<\
Defaults :

derivativeGaussKernelScale=5;
turningPeakThreshold=0.85;
peakSmoothingKernelScale=5;

smoothingWindowSize=0.075;
gaussianFilterScale=5;
peakThreshold=0.95;

nodeIDdistanceThreshold=3;
curvaturePeakPointPadding=1;

nodePruningScale=0.075;
minimumPruningDepth=1;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.890210387568242*^9, {3.8907334164048786`*^9, 3.890733416706216*^9}, 
   3.8908439740286694`*^9, 3.8928935994938955`*^9, 3.894719975970026*^9, {
   3.894721579414159*^9, 3.894721581479768*^9}, {3.899621918573606*^9, 
   3.899621920560975*^9}, {3.9092638084608965`*^9, 3.9092638411982794`*^9}, 
   3.909400838514611*^9, 3.9094008801385665`*^9, {3.9094052035953054`*^9, 
   3.9094052073647137`*^9}, 3.909405294937552*^9, 3.909405429666588*^9, 
   3.909506661725949*^9, 3.917434506819025*^9, {3.939366813468326*^9, 
   3.9393668636494093`*^9}, 3.9393703726903296`*^9},
 FontSize->16,ExpressionUUID->"e10732a6-1782-42ac-87d2-8444dfdb929f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"derivativeGaussKernelScale", "=", "5"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"turningPeakThreshold", "=", "0.85"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"peakSmoothingKernelScale", "=", "5"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"smoothingWindowSize", "=", "0.05"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"gaussianFilterScale", "=", "2.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"peakThreshold", "=", "0.95"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nodeIDdistanceThreshold", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"curvaturePeakPointPadding", "=", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nodePruningScale", "=", "0.075"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minimumPruningDepth", "=", "1"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9173847053813944`*^9, 3.91738471541796*^9}, {
   3.917437619148343*^9, 3.917437669292778*^9}, {3.9174377107653008`*^9, 
   3.917437752947133*^9}, 3.9174378512838974`*^9, {3.917437898892047*^9, 
   3.9174379113506207`*^9}, {3.9174379550606112`*^9, 
   3.9174380136123996`*^9}, {3.917438260292615*^9, 3.9174382640915036`*^9}, {
   3.917438475523643*^9, 3.9174384974616184`*^9}, {3.9174387047368317`*^9, 
   3.917438713618451*^9}, {3.917438842559292*^9, 3.9174388514762535`*^9}, 
   3.9174394261898503`*^9, {3.9174395386183147`*^9, 3.9174395470017567`*^9}, {
   3.917439794779892*^9, 3.91743981876318*^9}, {3.9174399083544316`*^9, 
   3.9174399103865385`*^9}, 3.928735311714181*^9, {3.939296069380855*^9, 
   3.9392960695801535`*^9}, {3.9393648366152153`*^9, 
   3.9393648759530687`*^9}, {3.9393667604936104`*^9, 
   3.9393667884574366`*^9}, {3.939366845928625*^9, 3.9393668577014894`*^9}, 
   3.9393703760658717`*^9, {3.9398904516634803`*^9, 3.9398904657907333`*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"fab85ce7-190c-442a-9609-02a3342f829a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"testModuleUturnDecompose", "@", 
   RowBox[{"tracksFiltered", "[", 
    RowBox[{"[", "5", "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.939366367427853*^9, 3.939366384008108*^9}, {
   3.9393664786073666`*^9, 3.939366478676916*^9}, {3.9393670320087595`*^9, 
   3.9393670380063615`*^9}, {3.939367087263583*^9, 3.939367115132831*^9}, 
   3.939887264790312*^9, {3.9398880720164504`*^9, 3.9398880722568617`*^9}, {
   3.940310620457427*^9, 3.940310620719843*^9}, {3.9403106612658663`*^9, 
   3.9403106620323205`*^9}, 3.940311918769553*^9, 3.940312331985925*^9, {
   3.9405055512643385`*^9, 3.9405055639863167`*^9}, {3.9405141307268486`*^9, 
   3.940514132100212*^9}, {3.940514241143442*^9, 3.9405142486945333`*^9}},
 CellLabel->
  "In[102]:=",ExpressionUUID->"f6341fa8-0306-4474-b416-95421a9b4264"]
}, Closed]],

Cell[CellGroupData[{

Cell["Decompose Tracks Into U-turns", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852842898235`*^9}, {3.93937056703065*^9, 
   3.9393705764320803`*^9}},ExpressionUUID->"211cd941-583a-4169-8c53-\
fc4dd52883ba"],

Cell[CellGroupData[{

Cell["[[ Preview U-turn Decomposition ]]", "Subsubsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852707680645`*^9}, {3.939283916115666*^9, 3.939283923995065*^9}, {
   3.9393072447188826`*^9, 3.9393072455718374`*^9}, {3.9393119536702523`*^9, 
   3.9393119572015734`*^9}, {3.939363180003191*^9, 3.939363226228035*^9}, {
   3.939379600317065*^9, 3.939379604253692*^9}, {3.9399009458217173`*^9, 
   3.9399009501011815`*^9}},ExpressionUUID->"ca0bb7b1-a962-45c0-a4c0-\
b53783faa593"],

Cell["\<\
Defaults :

derivativeGaussKernelScale=5;
turningPeakThreshold=0.85;
peakSmoothingKernelScale=5;

smoothingWindowSize=0.075;
gaussianFilterScale=5;
peakThreshold=0.95;

nodeIDdistanceThreshold=3;
curvaturePeakPointPadding=1;

nodePruningScale=0.075;
minimumPruningDepth=1;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.890210387568242*^9, {3.8907334164048786`*^9, 3.890733416706216*^9}, 
   3.8908439740286694`*^9, 3.8928935994938955`*^9, 3.894719975970026*^9, {
   3.894721579414159*^9, 3.894721581479768*^9}, {3.899621918573606*^9, 
   3.899621920560975*^9}, {3.9092638084608965`*^9, 3.9092638411982794`*^9}, 
   3.909400838514611*^9, 3.9094008801385665`*^9, {3.9094052035953054`*^9, 
   3.9094052073647137`*^9}, 3.909405294937552*^9, 3.909405429666588*^9, 
   3.909506661725949*^9, 3.917434506819025*^9, {3.939366813468326*^9, 
   3.9393668636494093`*^9}, 3.9393703726903296`*^9},
 FontSize->16,ExpressionUUID->"759fdcd2-56d1-4d29-bc2b-2738e842e012"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"derivativeGaussKernelScale", "=", "5"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"turningPeakThreshold", "=", "0.85"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"peakSmoothingKernelScale", "=", "5"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"smoothingWindowSize", "=", "0.05"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"gaussianFilterScale", "=", "2.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"peakThreshold", "=", "0.95"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nodeIDdistanceThreshold", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"curvaturePeakPointPadding", "=", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nodePruningScale", "=", "0.075"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minimumPruningDepth", "=", "1"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9173847053813944`*^9, 3.91738471541796*^9}, {
   3.917437619148343*^9, 3.917437669292778*^9}, {3.9174377107653008`*^9, 
   3.917437752947133*^9}, 3.9174378512838974`*^9, {3.917437898892047*^9, 
   3.9174379113506207`*^9}, {3.9174379550606112`*^9, 
   3.9174380136123996`*^9}, {3.917438260292615*^9, 3.9174382640915036`*^9}, {
   3.917438475523643*^9, 3.9174384974616184`*^9}, {3.9174387047368317`*^9, 
   3.917438713618451*^9}, {3.917438842559292*^9, 3.9174388514762535`*^9}, 
   3.9174394261898503`*^9, {3.9174395386183147`*^9, 3.9174395470017567`*^9}, {
   3.917439794779892*^9, 3.91743981876318*^9}, {3.9174399083544316`*^9, 
   3.9174399103865385`*^9}, 3.928735311714181*^9, {3.939296069380855*^9, 
   3.9392960695801535`*^9}, {3.9393648366152153`*^9, 
   3.9393648759530687`*^9}, {3.9393667604936104`*^9, 
   3.9393667884574366`*^9}, {3.939366845928625*^9, 3.9393668577014894`*^9}, 
   3.9393703760658717`*^9, {3.9399010887823906`*^9, 3.9399010937968864`*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"0624fd88-1910-44f8-8f53-a37bf67346ac"],

Cell["\<\
=== MF-2 tests ===

checkIDs={1,3,16,100,1200}\
\>", "Abstract",
 CellChangeTimes->{{3.93989832089707*^9, 3.939898384116635*^9}, {
  3.9403107290711827`*^9, 
  3.9403107345191774`*^9}},ExpressionUUID->"8ca39f0c-d091-4b12-a275-\
a80c15711038"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"testTrack", "=", 
   RowBox[{"tracksFiltered", "[", 
    RowBox[{"[", "5", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "@", "testTrack"}]}], "Input",
 CellChangeTimes->{{3.939295560335632*^9, 3.939295577292444*^9}, {
   3.939295932446237*^9, 3.9392959431719007`*^9}, {3.939359924974036*^9, 
   3.939359925935831*^9}, {3.9393599626078033`*^9, 3.9393599698928986`*^9}, {
   3.9393647959741383`*^9, 3.9393647976340933`*^9}, 3.9398872529912586`*^9, 
   3.9398892632884893`*^9, {3.9398893086789007`*^9, 3.939889336022822*^9}, {
   3.93989012183337*^9, 3.939890160069784*^9}, {3.939898313917633*^9, 
   3.939898379182271*^9}, 3.9398984301519113`*^9, {3.939900899976631*^9, 
   3.939900901653041*^9}, {3.939905179776273*^9, 3.9399051855360746`*^9}, {
   3.940310725889489*^9, 3.9403107268071885`*^9}, 3.940311926570882*^9, 
   3.9405055781186347`*^9, {3.940514258521202*^9, 3.9405142595885553`*^9}},
 CellLabel->
  "In[115]:=",ExpressionUUID->"758a09b9-6c00-4758-b7ce-23833c7d186d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"trackUturns", ",", "trackCurvaturePoints"}], "}"}], "=", 
     RowBox[{"getTrackUturns", "@", "testTrack"}]}], ";"}], "//", 
   "AbsoluteTiming"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ImageCollage", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ListLinePlot", "/@", "trackUturns"}], ",", 
   RowBox[{"Background", "\[Rule]", "None"}], ",", 
   RowBox[{"ImagePadding", "\[Rule]", "10"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Full"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Method", "\[Rule]", "\"\<Grid\>\""}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.939370805875311*^9, 3.9393708394713373`*^9}, {
  3.9393709209434614`*^9, 3.9393709212823052`*^9}, {3.939374350035781*^9, 
  3.9393743509913874`*^9}, {3.9398970232122936`*^9, 3.939897029826109*^9}},
 CellLabel->
  "In[117]:=",ExpressionUUID->"2effeaa0-a5b1-48c8-bb83-97284221f606"]
}, Closed]],

Cell[CellGroupData[{

Cell["[[ Preview Self-Intersection Detection ]]", "Subsubsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852707680645`*^9}, {3.939283916115666*^9, 3.939283923995065*^9}, {
   3.9393072447188826`*^9, 3.9393072455718374`*^9}, {3.9393119536702523`*^9, 
   3.9393119572015734`*^9}, {3.939363180003191*^9, 3.939363226228035*^9}, {
   3.939379600317065*^9, 3.939379604253692*^9}, {3.9399009458217173`*^9, 
   3.9399009501011815`*^9}, {3.939901112494201*^9, 
   3.939901118607949*^9}},ExpressionUUID->"173bbfb4-4e5c-4764-81fd-\
38c7ddc198eb"],

Cell["\<\
Defaults :

lineImageSmoothFactor=1.5;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.890210387568242*^9, {3.8907334164048786`*^9, 3.890733416706216*^9}, 
   3.8908439740286694`*^9, 3.8928935994938955`*^9, 3.894719975970026*^9, {
   3.894721579414159*^9, 3.894721581479768*^9}, {3.899621918573606*^9, 
   3.899621920560975*^9}, {3.9092638084608965`*^9, 3.9092638411982794`*^9}, 
   3.909400838514611*^9, 3.9094008801385665`*^9, {3.9094052035953054`*^9, 
   3.9094052073647137`*^9}, 3.909405294937552*^9, 3.909405429666588*^9, 
   3.909506661725949*^9, 3.917434506819025*^9, {3.939366813468326*^9, 
   3.9393668636494093`*^9}, 3.9393703726903296`*^9, 3.9399052132960205`*^9},
 FontSize->16,ExpressionUUID->"b458be98-599a-4085-bfd2-04df9e81e661"],

Cell[BoxData[
 RowBox[{
  RowBox[{"lineImageSmoothFactor", "=", "1.5"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9399011230373077`*^9, 3.93990112321303*^9}},
 CellLabel->
  "In[119]:=",ExpressionUUID->"e539a834-41da-4679-a467-a16ce57424ae"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ImageCollage", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"getUturnImage", "/@", "trackUturns"}], ",", 
    RowBox[{"Background", "\[Rule]", "None"}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", "10"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Method", "\[Rule]", "\"\<Grid\>\""}]}], "\[IndentingNewLine]", 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"checkSelfIntersection", "@", 
    RowBox[{"getUturnImage", "@", "#"}]}], "&"}], "/@", 
  "trackUturns"}]}], "Input",
 CellChangeTimes->{{3.9399008621183634`*^9, 3.9399008816097326`*^9}, {
  3.93990114101116*^9, 3.9399011497135677`*^9}},
 CellLabel->
  "In[120]:=",ExpressionUUID->"6d27ed7c-2709-407c-8d93-c0e42955a6ce"]
}, Closed]],

Cell[CellGroupData[{

Cell["Run U-turn Decomposition", "Subsubsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852707680645`*^9}, {3.939283916115666*^9, 3.939283923995065*^9}, {
   3.9393072447188826`*^9, 3.9393072455718374`*^9}, {3.9393119536702523`*^9, 
   3.9393119572015734`*^9}, {3.939363180003191*^9, 3.939363226228035*^9}, {
   3.939379600317065*^9, 3.939379604253692*^9}, {3.9399009458217173`*^9, 
   3.9399009680610924`*^9}},ExpressionUUID->"c2a1776d-54f9-4e64-b0c2-\
721958ecf2ed"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"uturnsCurvaturePoints", "=", 
        RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Quiet", "[", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"monitorCounter", "++"}], ";", 
              RowBox[{"Transpose", "@", 
               RowBox[{"getTrackUturns", "@", "#"}]}]}], ")"}], "]"}], "&"}], 
          ",", "tracksFiltered"}], "\[IndentingNewLine]", "]"}]}], ";"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"progress", "[", 
         RowBox[{"#", ",", 
          RowBox[{"Length", "@", "tracksFiltered"}]}], "]"}], "&"}], "@", 
       RowBox[{"Refresh", "[", 
        RowBox[{"monitorCounter", ",", 
         RowBox[{"UpdateInterval", "\[Rule]", "0.25"}], ",", 
         RowBox[{"TrackedSymbols", "\[Rule]", 
          RowBox[{"{", "}"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], "//",
     "AbsoluteTiming"}], "//", "Quiet"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Length", "/@", "uturnsCurvaturePoints"}], "//", 
  "Total"}]}], "Input",
 CellChangeTimes->{{3.93988886463736*^9, 3.9398889079835825`*^9}, {
  3.9398889471527033`*^9, 3.939888954933527*^9}, {3.939889593567713*^9, 
  3.939889600208398*^9}, {3.9398897601025376`*^9, 3.9398897796824055`*^9}, {
  3.939889812820305*^9, 3.939889838366101*^9}, {3.939889900698724*^9, 
  3.939889925534381*^9}, {3.939889986607974*^9, 3.9398900127577324`*^9}, {
  3.939892151969964*^9, 3.939892179031762*^9}, {3.939892246043397*^9, 
  3.939892246832288*^9}, {3.939892465553693*^9, 3.9398924669204507`*^9}, {
  3.9398966739171953`*^9, 3.9398966742853193`*^9}, {3.9398971960906568`*^9, 
  3.9398971972344494`*^9}, {3.939899530725596*^9, 3.939899589276531*^9}, {
  3.9398996290624995`*^9, 3.939899733357004*^9}, {3.9399007425343504`*^9, 
  3.9399007690221643`*^9}, {3.9399061050171714`*^9, 3.939906110962654*^9}},
 CellLabel->
  "In[122]:=",ExpressionUUID->"e13852d0-0b68-48dd-b4b2-e87ebcc9feb2"]
}, Closed]],

Cell[CellGroupData[{

Cell["Filter By Temporal Length", "Subsubsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852707680645`*^9}, {3.939283916115666*^9, 3.939283923995065*^9}, {
   3.9393072447188826`*^9, 3.9393072455718374`*^9}, {3.9393119536702523`*^9, 
   3.9393119572015734`*^9}, {3.939363180003191*^9, 3.939363226228035*^9}, {
   3.939379600317065*^9, 3.939379604253692*^9}, {3.9399009458217173`*^9, 
   3.939900998017332*^9}, {3.9399625470457225`*^9, 3.9399625507259636`*^9}, 
   3.939962638101784*^9},ExpressionUUID->"a63b447e-c607-4dec-b27c-\
91ff84bc5956"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"uturnsCurvaturePointsFiltered", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Select", "[", "\[IndentingNewLine]", 
           RowBox[{"#", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "@", 
               RowBox[{"First", "@", "#"}]}], ">", "trackLengthThreshold"}], 
             "&"}]}], "\[IndentingNewLine]", "]"}], "&"}], "@", "#"}], "&"}], 
       "/@", "uturnsCurvaturePoints"}]}], ";"}], "//", "AbsoluteTiming"}], "//",
    "Quiet"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uturnsCurvaturePointsFiltered", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"#", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", "#"}], ">", "0"}], "&"}]}], "]"}], "&"}], "@",
     "uturnsCurvaturePointsFiltered"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Length", "/@", "uturnsCurvaturePointsFiltered"}], "//", 
  "Total"}]}], "Input",
 CellChangeTimes->{{3.9398922041130047`*^9, 3.9398923671439743`*^9}, {
  3.939892487432375*^9, 3.9398925875675583`*^9}, {3.9398929782287507`*^9, 
  3.939892991035462*^9}, {3.939896435140563*^9, 3.9398964512268534`*^9}, {
  3.9398966661472983`*^9, 3.9398966665392027`*^9}, {3.939897053299473*^9, 
  3.9398970556462154`*^9}, {3.939897188466761*^9, 3.939897231043729*^9}, {
  3.9398973819149246`*^9, 3.9398973845418816`*^9}, {3.9398995189170303`*^9, 
  3.93989952105223*^9}, {3.9398997580974407`*^9, 3.939899792042348*^9}, {
  3.9399011630402117`*^9, 3.9399011643816257`*^9}, {3.9399012230716105`*^9, 
  3.9399012237617655`*^9}, {3.9399061148511953`*^9, 3.9399061234009037`*^9}},
 CellLabel->
  "In[125]:=",ExpressionUUID->"b437a73d-072b-406a-b089-8f8ae363f7b0"]
}, Closed]],

Cell[CellGroupData[{

Cell["Filter Out Self-Intersecting U-turns", "Subsubsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852707680645`*^9}, {3.939283916115666*^9, 3.939283923995065*^9}, {
   3.9393072447188826`*^9, 3.9393072455718374`*^9}, {3.9393119536702523`*^9, 
   3.9393119572015734`*^9}, {3.939363180003191*^9, 3.939363226228035*^9}, {
   3.939379600317065*^9, 3.939379604253692*^9}, {3.9399009458217173`*^9, 
   3.939901034397509*^9}},ExpressionUUID->"f02705a5-f6a2-4904-9f4c-\
51a5161a3eda"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"uturnsPerTrack", "=", 
   RowBox[{"Length", "/@", "uturnsCurvaturePointsFiltered"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uturnsPerTrack", "//", 
   RowBox[{
    RowBox[{"Histogram", "[", 
     RowBox[{"#", ",", 
      RowBox[{"Max", "@", "#"}]}], "]"}], "&"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uturnsCurvaturePointsMerged", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"#", ",", "1"}], "]"}], "&"}], "@", 
    "uturnsCurvaturePointsFiltered"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uturnsMerged", "=", 
   RowBox[{"First", "@", 
    RowBox[{"Transpose", "@", "uturnsCurvaturePointsMerged"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.9399012297258224`*^9, {3.939906087594061*^9, 3.9399060892001767`*^9}, {
   3.939906125097603*^9, 3.9399061366816044`*^9}},
 CellLabel->
  "In[128]:=",ExpressionUUID->"23ce3ac3-ee01-4805-8029-7a84b6eaf3df"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uturnImages", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"monitorCounter", "++"}], 
          RowBox[{"getUturnImage", "@", "#"}]}], ")"}], "&"}], "/@", 
       "uturnsMerged"}]}], ";"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"progress", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Length", "@", "uturnsMerged"}]}], "]"}], "&"}], "@", 
     RowBox[{"Refresh", "[", 
      RowBox[{"monitorCounter", ",", 
       RowBox[{"UpdateInterval", "\[Rule]", "1"}], ",", 
       RowBox[{"TrackedSymbols", "\[Rule]", 
        RowBox[{"{", "}"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], "//",
   "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.939897535901479*^9, 3.939897558186619*^9}, {
   3.939898078837343*^9, 3.939898113266679*^9}, {3.9398984533243256`*^9, 
   3.939898601210003*^9}, {3.9398986414765577`*^9, 3.939898642708131*^9}, {
   3.939898688549864*^9, 3.939898748003975*^9}, {3.939899496013121*^9, 
   3.9398995089179373`*^9}, {3.9398998178881173`*^9, 3.939899823269418*^9}, {
   3.9398999297847605`*^9, 3.939899950893258*^9}, {3.93990003245658*^9, 
   3.9399000365778074`*^9}, {3.9399001387528505`*^9, 3.939900154702074*^9}, {
   3.939900219550799*^9, 3.93990022211701*^9}, {3.9399002797935843`*^9, 
   3.9399003708934355`*^9}, {3.9399005098159494`*^9, 
   3.9399005273513875`*^9}, {3.939900653783471*^9, 3.9399006825109525`*^9}, 
   3.9399060821630335`*^9, {3.939906143529822*^9, 3.9399061450168047`*^9}},
 CellLabel->
  "In[132]:=",ExpressionUUID->"0b4af3d0-8b4a-4ced-bdb3-4c5e4579395b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"selfIntersectionCount", "=", 
      RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"monitorCounter", "++"}], ";", 
           RowBox[{"checkSelfIntersection", "@", "#"}]}], ")"}], "&"}], ",", 
        "uturnImages"}], "\[IndentingNewLine]", "]"}]}], ";"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"progress", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Length", "@", "uturnImages"}]}], "]"}], "&"}], "@", 
     RowBox[{"Refresh", "[", 
      RowBox[{"monitorCounter", ",", 
       RowBox[{"UpdateInterval", "\[Rule]", "0.25"}], ",", 
       RowBox[{"TrackedSymbols", "\[Rule]", 
        RowBox[{"{", "}"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], "//",
   "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.93990344564814*^9, 3.9399035512718163`*^9}, {
  3.939903687760316*^9, 3.9399037042562246`*^9}, {3.9399061481808343`*^9, 
  3.9399061494245186`*^9}},
 CellLabel->
  "In[134]:=",ExpressionUUID->"26ee8138-f10d-4281-9877-28006f321e9e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uturnsCurvaturePointsMergedSimple", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"First", "@", 
        RowBox[{"Transpose", "@", 
         RowBox[{"Select", "[", "\[IndentingNewLine]", 
          RowBox[{"#", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Last", "@", "#"}], "\[Equal]", "0"}], "&"}]}], 
          "\[IndentingNewLine]", "]"}]}]}], "&"}], "@", 
      RowBox[{"Transpose", "@", 
       RowBox[{"{", 
        RowBox[{"uturnsCurvaturePointsMerged", ",", "selfIntersectionCount"}],
         "}"}]}]}]}], ";"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"uturnsCurvaturePointsMergedSimple", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.9399042212791367`*^9, 3.9399043382840023`*^9}, {
  3.9399044507930927`*^9, 3.939904478296317*^9}, {3.9399061594171667`*^9, 
  3.939906167584945*^9}},
 CellLabel->
  "In[136]:=",ExpressionUUID->"c08f2fb9-e8d9-4550-8445-be1738c73ab3"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"uturnsCurvaturePointsMergedSimple", "[", 
     RowBox[{"[", 
      RowBox[{"k", ",", "1"}], "]"}], "]"}], "//", "ListLinePlot"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "@", "uturnsCurvaturePointsMergedSimple"}], ",", "1"}],
     "}"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.939904781123725*^9, 3.9399048080635796`*^9}, {
  3.939906169249893*^9, 3.93990617016123*^9}},
 CellLabel->
  "In[138]:=",ExpressionUUID->"ec029f2f-7f9f-4c43-a32f-6e2c39bee5a6"]
}, Closed]],

Cell[CellGroupData[{

Cell["Filter By Oriented Aspect Ratio", "Subsubsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852707680645`*^9}, {3.939283916115666*^9, 3.939283923995065*^9}, {
   3.9393072447188826`*^9, 3.9393072455718374`*^9}, {3.9393119536702523`*^9, 
   3.9393119572015734`*^9}, {3.939363180003191*^9, 3.939363226228035*^9}, {
   3.939379600317065*^9, 3.939379604253692*^9}, {3.9399009458217173`*^9, 
   3.939901034397509*^9}, {3.9399051574155445`*^9, 3.9399051603913507`*^9}, 
   3.9399057546806483`*^9},ExpressionUUID->"4304a989-b404-45dc-b2b4-\
8fcf0e4db54a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uturnAspectRatio", "=", 
     RowBox[{"getTrackAspectRatio", "/@", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{"First", "@", 
        RowBox[{"Transpose", "@", "uturnsCurvaturePointsMergedSimple"}]}], 
       "\[IndentingNewLine]", ")"}]}]}], ";"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"uturnAspectRatio", "//", 
  RowBox[{
   RowBox[{"Histogram", "[", "\[IndentingNewLine]", 
    RowBox[{"#", ",", "histogramBinningMethod", ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"ScalingFunctions", "\[Rule]", "\"\<Log10\>\""}]}], 
    "\[IndentingNewLine]", "]"}], "&"}]}]}], "Input",
 CellChangeTimes->{{3.939309490717128*^9, 3.9393095044949093`*^9}, {
  3.9393096264649773`*^9, 3.9393096374020357`*^9}, {3.9393116489312315`*^9, 
  3.9393116673208127`*^9}, {3.939358889233016*^9, 3.939358890910751*^9}, {
  3.9393634560433426`*^9, 3.939363475559507*^9}, {3.9399087331309004`*^9, 
  3.9399087493068*^9}, {3.9399088363869553`*^9, 3.9399088529263554`*^9}, {
  3.9399098555153685`*^9, 3.939909884866068*^9}, {3.9401514804000015`*^9, 
  3.940151485261037*^9}},
 CellLabel->
  "In[139]:=",ExpressionUUID->"f3e3f6e3-27ed-4be8-8c7a-0542e8827fd8"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
      RowBox[{"#", ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"ToString", "@", 
         RowBox[{"getTrackAspectRatio", "@", "#"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], "&"}], "@", 
    RowBox[{"First", "@", 
     RowBox[{"uturnsCurvaturePointsMergedSimple", "[", 
      RowBox[{"[", "k", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "@", "uturnsCurvaturePointsMergedSimple"}], ",", "1"}],
     "}"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.9399089766046195`*^9, 3.939908980452137*^9}, {
  3.9399090713159604`*^9, 3.9399092567406883`*^9}},
 CellLabel->
  "In[141]:=",ExpressionUUID->"38636246-96f4-40ca-98ef-5f17909e1e01"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"testShitAspect", "=", 
    RowBox[{"First", "@", 
     RowBox[{"Transpose", "@", 
      RowBox[{"Select", "[", "\[IndentingNewLine]", 
       RowBox[{"uturnsCurvaturePointsMergedSimple", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"getTrackAspectRatio", "@", 
           RowBox[{"First", "@", "#"}]}], ">", "10"}], "&"}]}], 
       "\[IndentingNewLine]", "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testShitAspect", "//", 
   RowBox[{
    RowBox[{"ListLinePlot", "[", 
     RowBox[{"#", ",", 
      RowBox[{"Mesh", "\[Rule]", "None"}]}], "]"}], "&"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testShitAspect", "=", 
    RowBox[{"First", "@", 
     RowBox[{"Transpose", "@", 
      RowBox[{"Select", "[", "\[IndentingNewLine]", 
       RowBox[{"uturnsCurvaturePointsMergedSimple", ",", 
        RowBox[{
         RowBox[{"10", ">", 
          RowBox[{"getTrackAspectRatio", "@", 
           RowBox[{"First", "@", "#"}]}], ">", "5"}], "&"}]}], 
       "\[IndentingNewLine]", "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"testShitAspect", "//", 
  RowBox[{
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"#", ",", 
     RowBox[{"Mesh", "\[Rule]", "None"}]}], "]"}], "&"}]}]}], "Input",
 CellChangeTimes->{{3.9399089564770284`*^9, 3.9399089706274858`*^9}, {
  3.939909613235423*^9, 3.939909704108536*^9}, {3.939909749439616*^9, 
  3.939909751604006*^9}, {3.939909812622384*^9, 3.939909820333102*^9}, {
  3.9399098946004047`*^9, 3.939909906105186*^9}, {3.939909936912447*^9, 
  3.9399099441496153`*^9}, {3.9399620637594614`*^9, 3.939962063966962*^9}, {
  3.9399621007858276`*^9, 3.939962109552148*^9}},
 CellLabel->
  "In[142]:=",ExpressionUUID->"bf389444-2f17-4936-8c5e-0de22a21cb96"],

Cell["\<\
Defaults:

uturnAspectRatioThreshold=trackAspectRatioThreshold/2;\
\>", "Abstract",
 CellChangeTimes->{{3.9392949906710997`*^9, 3.9392950001954107`*^9}, {
   3.939295066046317*^9, 3.9392950927342014`*^9}, {3.939307022230593*^9, 
   3.9393071606539865`*^9}, {3.939307217411355*^9, 3.9393072206830053`*^9}, {
   3.9393076234521294`*^9, 3.9393076368191233`*^9}, {3.9393078800360575`*^9, 
   3.939307900060156*^9}, {3.9393658470997615`*^9, 3.9393658751808567`*^9}, {
   3.939909795004509*^9, 3.9399098078508263`*^9}, {3.9399101880842667`*^9, 
   3.9399101921159983`*^9}, {3.940511725467491*^9, 3.9405117256659613`*^9}, 
   3.9405143034801426`*^9},ExpressionUUID->"76d5189a-a202-4b61-ba43-\
9b387e0714f0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"uturnAspectRatioThreshold", "=", 
   RowBox[{"trackAspectRatioThreshold", "/", "2"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9393140877298994`*^9, 3.9393140944025965`*^9}, 
   3.939314618267257*^9, {3.939896506060462*^9, 3.9398965061070166`*^9}, {
   3.9398965511786427`*^9, 3.939896552371126*^9}, {3.939909782115879*^9, 
   3.9399097905661726`*^9}, {3.9405143000692606`*^9, 3.940514300162012*^9}},
 CellLabel->
  "In[146]:=",ExpressionUUID->"2a305bdd-ac54-45f0-88e3-36418be58c49"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uturnsCurvaturePointsMergedCleanAspect", "=", 
     RowBox[{"Select", "[", "\[IndentingNewLine]", 
      RowBox[{"uturnsCurvaturePointsMergedSimple", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"getTrackAspectRatio", "@", 
          RowBox[{"First", "@", "#"}]}], "<", "uturnAspectRatioThreshold"}], 
        "&"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "//", 
   "AbsoluteTiming"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uturnsCurvaturePointsMergedCleanAspect", "//", "Length"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"First", "@", 
    RowBox[{"Transpose", "@", "uturnsCurvaturePointsMergedCleanAspect"}]}], "//", 
   RowBox[{
    RowBox[{"Length", "/@", "#"}], "&"}]}], "//", 
  RowBox[{
   RowBox[{"Histogram", "[", "\[IndentingNewLine]", 
    RowBox[{"#", ",", "histogramBinningMethod", ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]", "]"}], 
   "&"}]}]}], "Input",
 CellChangeTimes->{{3.9399102278031187`*^9, 3.93991030058778*^9}, {
  3.9399103613395915`*^9, 3.9399103627956038`*^9}, {3.939910434484059*^9, 
  3.939910436599083*^9}, {3.939910476372551*^9, 3.9399104776976643`*^9}, {
  3.939910582683284*^9, 3.9399106047962675`*^9}, {3.940151516510318*^9, 
  3.9401515322554345`*^9}},
 CellLabel->
  "In[147]:=",ExpressionUUID->"6b26357e-baf0-4357-8c09-b80fa759747c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "750"}], "]"}], "]"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"Mesh", "\[Rule]", "None"}]}], "\[IndentingNewLine]", "]"}], 
   "&"}], "@", 
  RowBox[{"First", "@", 
   RowBox[{
   "Transpose", "@", "uturnsCurvaturePointsMergedCleanAspect"}]}]}]], "Input",
 CellChangeTimes->{{3.9399618517507687`*^9, 3.9399618869485674`*^9}, {
  3.939961945870073*^9, 3.9399619633338346`*^9}, {3.939961996966277*^9, 
  3.939962027141571*^9}, {3.9399637262551603`*^9, 3.939963726888863*^9}, {
  3.9403120480263996`*^9, 3.940312048452735*^9}, {3.9405059803512955`*^9, 
  3.94050598395584*^9}, {3.9405117554431314`*^9, 3.9405117928117723`*^9}},
 CellLabel->
  "In[150]:=",ExpressionUUID->"e1cd3fd2-89e7-45b9-90b1-db19d0189916"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ListLinePlot", "[", "#", "]"}], "&"}], "@", 
    RowBox[{"First", "@", 
     RowBox[{"uturnsCurvaturePointsMergedCleanAspect", "[", 
      RowBox[{"[", "k", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "@", "uturnsCurvaturePointsMergedCleanAspect"}], ",", 
     "1"}], "}"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.9399089766046195`*^9, 3.939908980452137*^9}, {
  3.9399090713159604`*^9, 3.9399092567406883`*^9}, {3.9399105035684443`*^9, 
  3.9399105116770477`*^9}},
 CellLabel->
  "In[151]:=",ExpressionUUID->"63fef3f6-d746-4670-81af-42915cb6d98d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Filter by U-turn Area", "Subsubsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852707680645`*^9}, {3.939283916115666*^9, 3.939283923995065*^9}, {
   3.9393072447188826`*^9, 3.9393072455718374`*^9}, {3.9393119536702523`*^9, 
   3.9393119572015734`*^9}, {3.939363180003191*^9, 3.939363226228035*^9}, {
   3.939379600317065*^9, 3.9393796243604383`*^9}, {3.9398905873274536`*^9, 
   3.939890629726925*^9}, {3.9399626686536503`*^9, 
   3.9399626737415323`*^9}},ExpressionUUID->"be6cf64c-37e5-4989-abdb-\
eea964f2e27f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"uturnArea", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"getUturnArea", "@", 
       RowBox[{"First", "@", "#"}]}], "&"}], "/@", 
     "uturnsCurvaturePointsMergedCleanAspect"}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{"uturnArea", "//", 
  RowBox[{
   RowBox[{"Histogram", "[", 
    RowBox[{"#", ",", "histogramBinningMethod", ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], 
   "&"}]}], "\[IndentingNewLine]", 
 RowBox[{"uturnArea", "//", 
  RowBox[{
   RowBox[{"Histogram", "[", 
    RowBox[{"#", ",", "histogramBinningMethod", ",", 
     RowBox[{"ScalingFunctions", "\[Rule]", "\"\<Log10\>\""}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}]}]}], "Input",
 CellChangeTimes->{{3.9399627791393085`*^9, 3.939962816273098*^9}, 
   3.939962860659871*^9, {3.939963056568579*^9, 3.939963066881824*^9}, {
   3.939963108751668*^9, 3.939963152256113*^9}, {3.9399633388343334`*^9, 
   3.939963346279599*^9}, {3.9399635424964437`*^9, 3.939963613251668*^9}, {
   3.9399670167724233`*^9, 3.9399670417322316`*^9}, {3.9399698052522097`*^9, 
   3.9399698116294994`*^9}, {3.939970417468567*^9, 3.9399704441040545`*^9}, {
   3.940151550686491*^9, 3.9401515571165447`*^9}},
 CellLabel->
  "In[152]:=",ExpressionUUID->"488172eb-099b-4160-8ce1-a7b8bfb7bf92"],

Cell[BoxData[
 RowBox[{
  RowBox[{"First", "@", 
   RowBox[{"Transpose", "@", 
    RowBox[{"Select", "[", "\[IndentingNewLine]", 
     RowBox[{"uturnsCurvaturePointsMergedCleanAspect", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"getUturnArea", "@", 
         RowBox[{"First", "@", "#"}]}], ">", "30000"}], "&"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], "//", 
  RowBox[{
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"#", ",", 
     RowBox[{"Mesh", "\[Rule]", "None"}]}], "]"}], "&"}]}]], "Input",
 CellChangeTimes->{{3.9399695754123893`*^9, 3.9399695790100684`*^9}, {
   3.9399696474695587`*^9, 3.939969659003343*^9}, 3.9399703392047586`*^9, {
   3.9401515698211813`*^9, 3.9401515715726023`*^9}},
 CellLabel->
  "In[155]:=",ExpressionUUID->"90200f4b-2c2f-4562-b1b8-e936b72672bc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"First", "@", 
   RowBox[{"Transpose", "@", 
    RowBox[{"Select", "[", "\[IndentingNewLine]", 
     RowBox[{"uturnsCurvaturePointsMergedCleanAspect", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"getUturnArea", "@", 
         RowBox[{"First", "@", "#"}]}], "<", "5000"}], "&"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], "//", 
  RowBox[{
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"#", ",", 
     RowBox[{"Mesh", "\[Rule]", "None"}]}], "]"}], "&"}]}]], "Input",
 CellChangeTimes->{{3.9399684736447625`*^9, 3.9399685262668157`*^9}, {
  3.939969278100258*^9, 3.9399693190593576`*^9}, {3.9399696670762825`*^9, 
  3.9399697034910345`*^9}, {3.939969867899895*^9, 3.9399698696217003`*^9}, {
  3.9401515791333313`*^9, 3.9401515807520504`*^9}},
 CellLabel->
  "In[156]:=",ExpressionUUID->"966d08c4-3816-405e-b74c-79278229b10f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"#", "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "All"}], "]"}], "]"}], "&"}], "@", 
   RowBox[{"First", "@", 
    RowBox[{"Transpose", "@", 
     RowBox[{"Select", "[", "\[IndentingNewLine]", 
      RowBox[{"uturnsCurvaturePointsMergedCleanAspect", ",", 
       RowBox[{
        RowBox[{"40000", ">", 
         RowBox[{"getUturnArea", "@", 
          RowBox[{"First", "@", "#"}]}], ">", "5000"}], "&"}]}], 
      "\[IndentingNewLine]", "]"}]}]}]}], "//", 
  RowBox[{
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"#", ",", 
     RowBox[{"Mesh", "\[Rule]", "None"}]}], "]"}], "&"}]}]], "Input",
 CellChangeTimes->{{3.9399697202042837`*^9, 3.939969790868715*^9}, {
  3.9399698321253552`*^9, 3.939969835612403*^9}, {3.9401515922455654`*^9, 
  3.9401515939413958`*^9}, {3.9403109120095096`*^9, 3.9403109152874084`*^9}},
 CellLabel->
  "In[157]:=",ExpressionUUID->"4eed6b90-0d2a-44ea-bdfd-a04780703092"],

Cell["\<\
Defaults:

uturnAreaThreshold=5000;\
\>", "Abstract",
 CellChangeTimes->{{3.9392949906710997`*^9, 3.9392950001954107`*^9}, {
   3.939295066046317*^9, 3.9392950927342014`*^9}, {3.939307022230593*^9, 
   3.9393071606539865`*^9}, {3.939307217411355*^9, 3.9393072206830053`*^9}, {
   3.9393076234521294`*^9, 3.9393076368191233`*^9}, {3.9393078800360575`*^9, 
   3.939307900060156*^9}, {3.9393658470997615`*^9, 3.9393658751808567`*^9}, {
   3.939909795004509*^9, 3.9399098078508263`*^9}, {3.9399101880842667`*^9, 
   3.9399101921159983`*^9}, 
   3.939971547914853*^9},ExpressionUUID->"4735dde7-f0f8-4570-9d40-\
ba4f1132b280"],

Cell[BoxData[
 RowBox[{
  RowBox[{"uturnAreaThreshold", "=", "5000"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9399714665841756`*^9, 3.9399714720355883`*^9}},
 CellLabel->
  "In[158]:=",ExpressionUUID->"62c7972f-ccaf-4028-ad93-eade7a363cbf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uturnsCurvaturePointsMergedCleanArea", "=", 
     RowBox[{"Select", "[", "\[IndentingNewLine]", 
      RowBox[{"uturnsCurvaturePointsMergedCleanAspect", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"getUturnArea", "@", 
          RowBox[{"First", "@", "#"}]}], ">", "5000"}], "&"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"uturnsCurvaturePointsMergedCleanArea", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.939971578195614*^9, 3.9399716275735645`*^9}, {
  3.939971935790805*^9, 3.9399719387608223`*^9}},
 CellLabel->
  "In[159]:=",ExpressionUUID->"37bc6a10-500f-4688-b736-9c469f2f414b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Update U-turn Peak Points & Remove Multi-Peak U-turns", "Subsubsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852707680645`*^9}, {3.939283916115666*^9, 3.939283923995065*^9}, {
   3.9393072447188826`*^9, 3.9393072455718374`*^9}, {3.9393119536702523`*^9, 
   3.9393119572015734`*^9}, {3.939363180003191*^9, 3.939363226228035*^9}, {
   3.939379600317065*^9, 3.9393796243604383`*^9}, {3.9398905873274536`*^9, 
   3.939890629726925*^9}, {3.939980817934908*^9, 3.9399808195212393`*^9}, {
   3.939983983757485*^9, 
   3.939984000388209*^9}},ExpressionUUID->"714f8f83-2a2a-4feb-9ab8-\
a2736d11a6ba"],

Cell["\<\
Defaults:

splineOrder=2;
upsampleFactor=10;\
\>", "Abstract",
 InitializationCell->True,
 CellChangeTimes->{{3.8374411840457907`*^9, 3.8374411921082387`*^9}, {
   3.8375060918433895`*^9, 3.8375061194775267`*^9}, {3.83750615485393*^9, 
   3.837506163173687*^9}, {3.8376970177353745`*^9, 3.837697056119751*^9}, {
   3.8382101989016657`*^9, 3.838210203181193*^9}, {3.8383534539483156`*^9, 
   3.8383535248038826`*^9}, {3.846769657335847*^9, 3.846769717048169*^9}, {
   3.847521947265028*^9, 3.847522000015459*^9}, {3.848042850410941*^9, 
   3.8480428593176937`*^9}, {3.8480429031813593`*^9, 
   3.8480429796669874`*^9}, {3.848043021869646*^9, 3.848043037173267*^9}, 
   3.8480430842446833`*^9, 3.855671016054467*^9, {3.85766673823547*^9, 
   3.857666738724975*^9}, 3.857667178603639*^9, {3.8576683512893324`*^9, 
   3.857668352590416*^9}, {3.8579976580052414`*^9, 3.857997663327698*^9}, {
   3.8588787271013765`*^9, 3.858878727285469*^9}, {3.9399774114087315`*^9, 
   3.939977411576844*^9}, 3.939982810692935*^9},
 FontSize->16,ExpressionUUID->"787147d0-0530-429d-8373-a221ca6fea8f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"splineOrder", "=", "2"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"upsampleFactor", "=", "10"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.857995873104424*^9, 3.857995882059126*^9}, {
   3.8579965304866495`*^9, 3.857996531726801*^9}, {3.857996571985859*^9, 
   3.857996596134353*^9}, {3.8579966369118905`*^9, 3.857996636993672*^9}, {
   3.857996733263565*^9, 3.8579967400163546`*^9}, {3.8579967707151976`*^9, 
   3.857996775783478*^9}, {3.857996816000206*^9, 3.857996928670643*^9}, {
   3.857997099479229*^9, 3.8579971061272583`*^9}, 3.8579972912957373`*^9, {
   3.8579976031129885`*^9, 3.8579976476775312`*^9}, {3.85799776028627*^9, 
   3.857997775174543*^9}, {3.8579984364299583`*^9, 3.8579984364768333`*^9}, {
   3.8579987698611*^9, 3.8579987701164675`*^9}, {3.8588787236289806`*^9, 
   3.8588787238642445`*^9}, {3.859127469316202*^9, 3.8591274707781487`*^9}, {
   3.939977189530594*^9, 3.939977191943082*^9}, {3.9399774100907707`*^9, 
   3.9399774176886516`*^9}, {3.9399789753135543`*^9, 
   3.9399789755233736`*^9}, {3.939979006945566*^9, 3.939979008616832*^9}},
 CellLabel->
  "In[161]:=",ExpressionUUID->"4cb2b20b-4eac-45dd-9e36-51d9b990712a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"uturnPoints", "=", 
   RowBox[{"First", "@", 
    RowBox[{"Transpose", "@", "uturnsCurvaturePointsMergedCleanArea"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uturnPoints", "[", 
   RowBox[{"[", 
    RowBox[{"1", ";;", "All"}], "]"}], "]"}], "//", 
  RowBox[{
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"#", ",", 
     RowBox[{"Mesh", "\[Rule]", "None"}]}], "]"}], "&"}]}]}], "Input",
 CellChangeTimes->{{3.9399765019910154`*^9, 3.939976514097885*^9}, {
  3.9399765451887536`*^9, 3.9399765488269424`*^9}, {3.939977128377035*^9, 
  3.939977139658099*^9}, {3.9399772413032527`*^9, 3.939977241943447*^9}, {
  3.940151634213725*^9, 3.940151634709141*^9}, {3.940312080683514*^9, 
  3.9403120810403357`*^9}, {3.94050593065728*^9, 3.940505966581098*^9}},
 CellLabel->
  "In[163]:=",ExpressionUUID->"38c1a576-e33f-4319-a983-5d56cfcf9263"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uturnPointsUpsampled", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"uniformlyUpsampleCurve", "[", "\[IndentingNewLine]", 
         RowBox[{"#", ",", "splineOrder", ",", 
          RowBox[{"upsampleFactor", "*", 
           RowBox[{"Length", "@", "#"}]}]}], "\[IndentingNewLine]", "]"}], 
        "&"}], "/@", "uturnPoints"}], "//", "Parallelize"}]}], ";"}], "//", 
   "Quiet"}], "//", "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.939976745448863*^9, 3.939976962791937*^9}, {
   3.939977032329233*^9, 3.93997707700793*^9}, {3.939977149049133*^9, 
   3.9399771829658313`*^9}, {3.93997802241074*^9, 3.9399780293768945`*^9}, 
   3.9399828168277903`*^9, {3.9403120833646*^9, 3.940312084297945*^9}},
 CellLabel->
  "In[165]:=",ExpressionUUID->"629ec48b-d815-4551-b17c-3acc29438c29"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Manipulator", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Dynamic", "@", "x"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"Length", "@", "uturnsCurvaturePointsMergedCleanArea"}], ",", 
        "1"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Appearance", "\[Rule]", "\"\<DownArrow\>\""}]}], 
     "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Dynamic", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"testParameters", "=", 
       RowBox[{"upsampleFactor", "*", 
        RowBox[{"{", 
         RowBox[{
         "smoothingWindowSize", ",", "gaussianFilterScale", ",", 
          "peakThreshold"}], "}"}], "*", 
        RowBox[{"{", 
         RowBox[{"0.85", ",", "0.25", ",", "0.001"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"testUturn", "=", 
       RowBox[{"uturnPoints", "[", 
        RowBox[{"[", "x", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"oldUturnPoint", "=", 
       RowBox[{"Last", "@", 
        RowBox[{"uturnsCurvaturePointsMergedCleanArea", "[", 
         RowBox[{"[", "x", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"testRefinedCurvaturePoints", "=", 
       RowBox[{"getRefinedCurvaturePoints", "[", "\[IndentingNewLine]", 
        RowBox[{"testUturn", ",", 
         RowBox[{"uturnPointsUpsampled", "[", 
          RowBox[{"[", "x", "]"}], "]"}], ",", "testParameters"}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"testTrackEndPoints", "=", 
       RowBox[{"testUturn", "[", 
        RowBox[{"[", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"testRefinedUturnPoints", "=", 
       RowBox[{"Complement", "[", 
        RowBox[{"testRefinedCurvaturePoints", ",", "testTrackEndPoints"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"testUturn", "//", "ListLinePlot"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"ListPlot", "[", 
             RowBox[{"#", ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"Directive", "[", 
                RowBox[{
                 RowBox[{"Darker", "@", "Green"}], ",", 
                 RowBox[{"PointSize", "@", "0.03"}]}], "]"}]}]}], "]"}], 
            "&"}], "@", "testRefinedUturnPoints"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"ListPlot", "[", 
             RowBox[{"#", ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"Directive", "[", 
                RowBox[{"Red", ",", 
                 RowBox[{"PointSize", "@", "0.02"}]}], "]"}]}]}], "]"}], 
            "&"}], "@", 
           RowBox[{"{", "oldUturnPoint", "}"}]}]}], "\[IndentingNewLine]", 
         "}"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "}"}], "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.9399613256973343`*^9, 3.939961400880833*^9}, {
   3.9399615356196775`*^9, 3.939961612243009*^9}, {3.9399616596509333`*^9, 
   3.939961667511138*^9}, {3.9399617131421127`*^9, 3.939961761419031*^9}, {
   3.9399628736087146`*^9, 3.9399629074069786`*^9}, {3.9399719502640076`*^9, 
   3.939971956655987*^9}, {3.939972016630646*^9, 3.939972056109325*^9}, {
   3.9399721254791517`*^9, 3.939972209188609*^9}, {3.939972309193261*^9, 
   3.939972366156869*^9}, {3.9399727100140285`*^9, 3.939972710760316*^9}, {
   3.93997274580751*^9, 3.939972780262348*^9}, {3.9399728352948856`*^9, 
   3.9399728988390822`*^9}, 3.9399773891857*^9, {3.939978441570321*^9, 
   3.9399784745216875`*^9}, {3.9399785965696735`*^9, 
   3.9399790267303843`*^9}, {3.939979060283292*^9, 3.9399790612016797`*^9}, {
   3.939979092517418*^9, 3.939979132025433*^9}, {3.9399791698112144`*^9, 
   3.939979204601454*^9}, {3.939979250700565*^9, 3.9399792866656966`*^9}, {
   3.9399793178913207`*^9, 3.9399793603306403`*^9}, {3.939979683306926*^9, 
   3.9399796865665255`*^9}, {3.939979737702042*^9, 3.9399797502050686`*^9}, {
   3.939979995469081*^9, 3.9399800124431925`*^9}, {3.939980072118976*^9, 
   3.9399800925538197`*^9}, {3.939980135494196*^9, 3.939980137300462*^9}, {
   3.939980173051752*^9, 3.939980283039233*^9}, {3.939980339940259*^9, 
   3.9399803527073803`*^9}, {3.939981291073588*^9, 3.939981301100424*^9}, {
   3.939981406228774*^9, 3.939981418540986*^9}, {3.939981732415682*^9, 
   3.93998174286941*^9}, {3.9399821524220343`*^9, 3.939982232454856*^9}, {
   3.9400091735946517`*^9, 3.940009183225032*^9}, {3.940052369445591*^9, 
   3.9400523736081543`*^9}},
 CellLabel->
  "In[166]:=",ExpressionUUID->"f0145616-846b-4b17-8a37-a54eaf3c0aaf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"curvaturePointFilterParameters", "=", 
   RowBox[{"upsampleFactor", "*", 
    RowBox[{"{", 
     RowBox[{"0.85", ",", "0.25", ",", "0.001"}], "}"}], "*", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "smoothingWindowSize", ",", "gaussianFilterScale", ",", 
      "peakThreshold"}], "\[IndentingNewLine]", "}"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.939981818370903*^9, 3.939981848675268*^9}},
 CellLabel->
  "In[167]:=",ExpressionUUID->"e582cb34-3b7f-4c83-9b1e-c6a290d4b6ef"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"refinedCurvaturePoints", "=", 
     RowBox[{"Parallelize", "@", 
      RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Quiet", "@", 
          RowBox[{"getRefinedCurvaturePoints", "[", "\[IndentingNewLine]", 
           RowBox[{"#1", ",", "#2", ",", "curvaturePointFilterParameters"}], 
           "\[IndentingNewLine]", "]"}]}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{"uturnPoints", ",", "uturnPointsUpsampled"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}]}], ";"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"uturnEndPoints", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], "&"}], "/@", 
     "uturnPoints"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"refinedUturnPoints", "=", 
    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Complement", "[", 
        RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"refinedCurvaturePoints", ",", "uturnEndPoints"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uturnsWithTurnPoints", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Select", "[", "\[IndentingNewLine]", 
       RowBox[{"#", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", 
           RowBox[{"Last", "@", "#"}]}], "\[Equal]", "1"}], "&"}]}], 
       "\[IndentingNewLine]", "]"}], "&"}], "@", 
     RowBox[{"Transpose", "@", 
      RowBox[{"{", 
       RowBox[{"uturnPoints", ",", "refinedUturnPoints"}], "}"}]}]}]}], ";"}],
   "\[IndentingNewLine]"}], "\n", 
 RowBox[{"uturnsWithTurnPoints", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.939981924055212*^9, 3.939982009651331*^9}, {
  3.939982117539789*^9, 3.939982143699192*^9}, {3.939982864219385*^9, 
  3.9399828676036263`*^9}, {3.9399829076149693`*^9, 3.9399829486126003`*^9}, {
  3.939982996683054*^9, 3.9399830531866226`*^9}, {3.9399834085094852`*^9, 
  3.939983475717331*^9}, {3.9399837547411942`*^9, 3.939983756723618*^9}, {
  3.939983974285722*^9, 3.9399839768698015`*^9}, {3.9399842835166492`*^9, 
  3.9399842948643637`*^9}},
 CellLabel->
  "In[168]:=",ExpressionUUID->"51a815e5-14c8-43f0-9a54-c80cedaff15c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Get U-turn Data from Track Data", "Subsubsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852707680645`*^9}, {3.939283916115666*^9, 3.939283923995065*^9}, {
   3.9393072447188826`*^9, 3.9393072455718374`*^9}, {3.9393119536702523`*^9, 
   3.9393119572015734`*^9}, {3.939363180003191*^9, 3.939363226228035*^9}, {
   3.939379600317065*^9, 3.9393796243604383`*^9}, {3.9401603344449596`*^9, 
   3.9401603387149115`*^9}, {3.9401605185868945`*^9, 
   3.940160520914672*^9}},ExpressionUUID->"43fa8755-1d42-4702-b2e1-\
4ff16be2e268"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"trackCoordinatesClean", "=", 
    RowBox[{"getTrackCoordinates", "/@", "trackDataClean"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uturnData", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"monitorCounter", "++"}], ";", 
           RowBox[{"getUturnData", "@", "#"}]}], ")"}], "&"}], "/@", 
        "uturnsWithTurnPoints"}], "//", "Parallelize"}]}], ";"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"progress", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Length", "@", "uturnsWithTurnPoints"}]}], "]"}], "&"}], "@", 
     RowBox[{"Refresh", "[", 
      RowBox[{"monitorCounter", ",", 
       RowBox[{"UpdateInterval", "\[Rule]", "1"}], ",", 
       RowBox[{"TrackedSymbols", "\[Rule]", 
        RowBox[{"{", "}"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], "//",
   "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.940159556206032*^9, 3.9401596194580526`*^9}, {
   3.9401596498128257`*^9, 3.9401596841791534`*^9}, {3.9401597823608365`*^9, 
   3.9401598669470797`*^9}, {3.9401599766590242`*^9, 3.940159986140736*^9}, {
   3.9401602049579887`*^9, 3.9401602479597063`*^9}, 3.9405060329118767`*^9},
 CellLabel->
  "In[210]:=",ExpressionUUID->"c38e0865-ba69-4126-bc90-5f71afc0468a"]
}, Closed]],

Cell[CellGroupData[{

Cell["<< Export U-turn Data >>", "Subsubsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852842898235`*^9}, {3.917385345743088*^9, 3.9173853474802213`*^9}, {
   3.9174462057146387`*^9, 3.917446276705615*^9}, {3.928750055957734*^9, 
   3.928750123606418*^9}, {3.940072296732396*^9, 3.9400722974054394`*^9}, {
   3.940076155278675*^9, 3.9400761705527935`*^9}, {3.9400780759444604`*^9, 
   3.940078080583084*^9}, {3.940083646268532*^9, 3.940083656122978*^9}, 
   3.9401603986748195`*^9},ExpressionUUID->"7a55ba57-5ee2-4053-b843-\
e85d75051c97"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "fileFolder", "<>", "$PathnameSeparator", "<>", 
     "\"\<U-turn Data Unified.txt\>\""}], ",", "\[IndentingNewLine]", 
    RowBox[{"Compress", "@", "uturnData"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.940079975075952*^9, 3.940080026337555*^9}, {
   3.9400835552555246`*^9, 3.940083563182511*^9}, {3.9400835986371517`*^9, 
   3.940083631292641*^9}, {3.9400836872565866`*^9, 3.9400836875811577`*^9}, 
   3.940160417251506*^9, 3.940160454173286*^9},
 CellLabel->
  "In[482]:=",ExpressionUUID->"a611ef39-21df-43c3-b44a-519ef32980ae"]
}, Closed]],

Cell[CellGroupData[{

Cell[">> Import U-turn Data <<", "Subsubsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852842898235`*^9}, {3.917385345743088*^9, 3.9173853474802213`*^9}, {
   3.9174462057146387`*^9, 3.917446276705615*^9}, {3.928750055957734*^9, 
   3.928750123606418*^9}, {3.940072296732396*^9, 3.9400722974054394`*^9}, {
   3.940076155278675*^9, 3.9400761705527935`*^9}, {3.9400780759444604`*^9, 
   3.940078080583084*^9}, {3.940083646268532*^9, 3.9400836679951687`*^9}, 
   3.940160400226385*^9},ExpressionUUID->"7c391228-9ac0-4cab-adc6-\
795c4ae354d6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"uturnData", "=", 
   RowBox[{"Uncompress", "@", 
    RowBox[{"Import", "[", "\[IndentingNewLine]", 
     RowBox[{
     "fileFolder", "<>", "$PathnameSeparator", "<>", 
      "\"\<U-turn Data Unified.txt\>\""}], "\[IndentingNewLine]", "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.940083672106782*^9, 3.9400836847969847`*^9}, 
   3.9401604219240985`*^9, 3.9401604581160173`*^9},
 CellLabel->
  "In[483]:=",ExpressionUUID->"5e80baa1-83ce-4eef-8aab-96df5277ddc5"]
}, Closed]],

Cell[CellGroupData[{

Cell["Translate & Symmetrize U-turns", "Subsubsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852707680645`*^9}, {3.939283916115666*^9, 3.939283923995065*^9}, {
   3.9393072447188826`*^9, 3.9393072455718374`*^9}, {3.9393119536702523`*^9, 
   3.9393119572015734`*^9}, {3.939363180003191*^9, 3.939363226228035*^9}, {
   3.939379600317065*^9, 
   3.9393796243604383`*^9}},ExpressionUUID->"c0e16877-88bc-4cc9-8875-\
4faf81637a74"],

Cell["\<\
Defaults:

branchCutFactor=0.15;\
\>", "Abstract",
 CellChangeTimes->{{3.9392949906710997`*^9, 3.9392950001954107`*^9}, {
   3.939295066046317*^9, 3.9392950927342014`*^9}, {3.939307022230593*^9, 
   3.9393071606539865`*^9}, {3.939307217411355*^9, 3.9393072206830053`*^9}, {
   3.9393076234521294`*^9, 3.9393076368191233`*^9}, {3.9393078800360575`*^9, 
   3.939307900060156*^9}, {3.9393658470997615`*^9, 3.9393658827170153`*^9}, 
   3.9393794139921265`*^9},ExpressionUUID->"e893e1e3-585d-4c11-bb74-\
25d87d9e491f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"branchCutFactor", "=", "0.15"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.939376950622003*^9, 3.9393769624212437`*^9}, {
  3.9400109912339783`*^9, 3.9400110006105328`*^9}},
 CellLabel->
  "In[215]:=",ExpressionUUID->"dfed39cd-3946-4d42-a0b6-0a420a208a87"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Manipulator", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Dynamic", "@", "x"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"Length", "@", "uturnsWithTurnPoints"}], ",", "1"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Appearance", "\[Rule]", "\"\<DownArrow\>\""}]}], 
     "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Dynamic", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"uturnsWithTurnPoints", "[", 
          RowBox[{"[", "x", "]"}], "]"}], "//", "ListLinePlot"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"getTranslatedSymmetrizedUturn", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"First", "@", 
            RowBox[{"uturnsWithTurnPoints", "[", 
             RowBox[{"[", "x", "]"}], "]"}]}], ",", 
           RowBox[{"Flatten", "@", 
            RowBox[{"Last", "@", 
             RowBox[{"uturnsWithTurnPoints", "[", 
              RowBox[{"[", "x", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
          "]"}], "//", "ListLinePlot"}]}], "\[IndentingNewLine]", "}"}], "//", 
      RowBox[{
       RowBox[{"ImageCollage", "[", 
        RowBox[{"#", ",", 
         RowBox[{"ImageSize", "\[Rule]", "Full"}], ",", 
         RowBox[{"Background", "\[Rule]", "None"}], ",", 
         RowBox[{"ImagePadding", "\[Rule]", "5"}]}], "]"}], "&"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}], "//", 
  "TableForm"}]], "Input",
 CellChangeTimes->{{3.94000915340802*^9, 3.9400091658578806`*^9}, {
  3.9400103242808094`*^9, 3.9400104992210584`*^9}, {3.940052365113345*^9, 
  3.940052376526616*^9}, {3.9400619454238195`*^9, 3.940061961759718*^9}},
 CellLabel->
  "In[216]:=",ExpressionUUID->"395292c2-2723-4215-a36c-fe69b1ed36af"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uturnsSymmetrizedTranslated", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"getTranslatedSymmetrizedUturn", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"First", "@", "#"}], ",", 
          RowBox[{"Flatten", "@", 
           RowBox[{"Last", "@", "#"}]}]}], "\[IndentingNewLine]", "]"}], 
        "&"}], "/@", "uturnsWithTurnPoints"}], "//", "Parallelize"}]}], ";"}],
    "//", "AbsoluteTiming"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Length", "/@", "uturnsSymmetrizedTranslated"}], "//", 
  RowBox[{
   RowBox[{"Histogram", "[", 
    RowBox[{"#", ",", "histogramBinningMethod", ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}]}]}], "Input",
 CellChangeTimes->{{3.9400108492111344`*^9, 3.9400109826986465`*^9}, {
  3.940011060049634*^9, 3.9400110603552394`*^9}, {3.9400569954365034`*^9, 
  3.9400570020573416`*^9}, {3.940151661688568*^9, 3.940151662230789*^9}},
 CellLabel->
  "In[217]:=",ExpressionUUID->"676831a7-b857-4f8f-92d8-5ab2bb680259"]
}, Closed]],

Cell[CellGroupData[{

Cell["Get Symmetrized/Translated U-turn Data", "Subsubsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852707680645`*^9}, {3.939283916115666*^9, 3.939283923995065*^9}, {
   3.9393072447188826`*^9, 3.9393072455718374`*^9}, {3.9393119536702523`*^9, 
   3.9393119572015734`*^9}, {3.939363180003191*^9, 3.939363226228035*^9}, {
   3.939379600317065*^9, 3.9393796243604383`*^9}, {3.9401617206752815`*^9, 
   3.9401617294200635`*^9}},ExpressionUUID->"c520922e-bf8e-44a0-bc6b-\
a79ad0a32d9b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"uturnDataCoordinates", "=", 
   RowBox[{"getTrackCoordinates", "/@", "uturnData"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uturnsDataTurnPoints", "=", 
    RowBox[{"Last", "@", 
     RowBox[{"Transpose", "@", "uturnsWithTurnPoints"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uturnDataCoordinatesTranslated", "=", 
    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"getTranslatedUturn", "[", 
        RowBox[{"#1", ",", 
         RowBox[{"Flatten", "@", "#2"}]}], "]"}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"uturnDataCoordinates", ",", "uturnsDataTurnPoints"}], "}"}]}],
      "\[IndentingNewLine]", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"uturnDataOriginalMatched", "=", 
    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"#1", "[", 
        RowBox[{"[", 
         RowBox[{"Flatten", "@", 
          RowBox[{"Position", "[", 
           RowBox[{"#2", ",", 
            RowBox[{"Alternatives", "@@", "#3"}]}], "]"}]}], "]"}], "]"}], 
       "&"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "uturnData", ",", "uturnDataCoordinatesTranslated", ",", 
        "uturnsSymmetrizedTranslated"}], "}"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"uturnDataTranslated", "=", 
   RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Flatten", "/@", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"First", "@", 
           RowBox[{"Transpose", "@", "#1"}]}], ",", "#2", ",", 
          RowBox[{"Last", "@", 
           RowBox[{"Transpose", "@", "#1"}]}]}], "}"}], "]"}]}], "&"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "uturnDataOriginalMatched", ",", "uturnsSymmetrizedTranslated"}], 
      "}"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.94016138339914*^9, 3.9401614442204494`*^9}, {
   3.940161480022355*^9, 3.940161606227908*^9}, 3.940168951179491*^9, 
   3.9401705475543756`*^9, 3.9401708511320004`*^9, {3.9401710159637527`*^9, 
   3.940171019090923*^9}, {3.940171057522545*^9, 3.940171066581236*^9}, {
   3.9401711437952003`*^9, 3.9401711581865416`*^9}, {3.940171215611546*^9, 
   3.940171330906519*^9}, {3.940171372236088*^9, 3.940171380898607*^9}},
 CellLabel->
  "In[219]:=",ExpressionUUID->"0af5c2cb-81e7-4c91-916b-d8e101a1d124"]
}, Closed]],

Cell[CellGroupData[{

Cell["Filter U-turns by Length", "Subsubsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852707680645`*^9}, {3.939283916115666*^9, 3.939283923995065*^9}, {
   3.9393072447188826`*^9, 3.9393072455718374`*^9}, {3.9393119536702523`*^9, 
   3.9393119572015734`*^9}, {3.939363180003191*^9, 3.939363226228035*^9}, {
   3.939379600317065*^9, 3.9393796243604383`*^9}, {3.9400570530265174`*^9, 
   3.9400570576422358`*^9}},ExpressionUUID->"2e7a1815-cf16-4173-8c04-\
5fa7e8a71ce5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"uturnsSymmetrizedTranslatedThresholded", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Select", "[", "\[IndentingNewLine]", 
       RowBox[{"#", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "#"}], ">", "trackLengthThreshold"}], 
         "&"}]}], "\[IndentingNewLine]", "]"}], "&"}], "@", 
     "uturnsSymmetrizedTranslated"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{"uturnsSymmetrizedTranslatedThresholded", "//", 
  RowBox[{
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"#", ",", 
     RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}], 
   "&"}]}], "\[IndentingNewLine]", 
 RowBox[{"uturnsSymmetrizedTranslatedThresholded", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.940057066123557*^9, 3.9400570688974776`*^9}, {
  3.9400571904901066`*^9, 3.940057217437127*^9}, {3.9400572622436323`*^9, 
  3.9400572645053587`*^9}, {3.9400716325184*^9, 3.9400716364009953`*^9}, {
  3.940076396633751*^9, 3.9400763993753433`*^9}},
 CellLabel->
  "In[224]:=",ExpressionUUID->"cf0fdb8a-2da2-4c8c-85c0-89a49f48d56c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Filter by Misalignment with MF", "Subsubsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852707680645`*^9}, {3.939283916115666*^9, 3.939283923995065*^9}, {
   3.9393072447188826`*^9, 3.9393072455718374`*^9}, {3.9393119536702523`*^9, 
   3.9393119572015734`*^9}, {3.939363180003191*^9, 3.939363226228035*^9}, {
   3.939379600317065*^9, 3.9393796243604383`*^9}, {3.9400570530265174`*^9, 
   3.9400570576422358`*^9}, {3.940057313841945*^9, 3.9400573141226287`*^9}, {
   3.9400582838819513`*^9, 3.94005829299159*^9}, {3.9400601945039263`*^9, 
   3.940060195476585*^9}},ExpressionUUID->"dcfdc934-7a76-4e22-86e7-\
113822f7235e"],

Cell["\<\
Defaults:

alignmentFactorThreshold=2;\
\>", "Abstract",
 CellChangeTimes->{{3.9392949906710997`*^9, 3.9392950001954107`*^9}, {
   3.939295066046317*^9, 3.9392950927342014`*^9}, {3.939307022230593*^9, 
   3.9393071606539865`*^9}, {3.939307217411355*^9, 3.9393072206830053`*^9}, {
   3.9393076234521294`*^9, 3.9393076368191233`*^9}, {3.9393078800360575`*^9, 
   3.939307900060156*^9}, {3.9393658470997615`*^9, 3.9393658827170153`*^9}, 
   3.9393794139921265`*^9, 
   3.9400670630245404`*^9},ExpressionUUID->"95e4fa73-c697-48ee-b607-\
2cb42842186c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"alignmentFactorThreshold", "=", "2"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9400594024637213`*^9, 3.94005940973151*^9}},
 CellLabel->
  "In[227]:=",ExpressionUUID->"8843cd24-87c7-4f39-8421-cd2da201e285"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
      RowBox[{"#", ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"getUturnAlignmentFactor", "@", "#"}]}]}], 
      "\[IndentingNewLine]", "]"}], "&"}], "@", 
    RowBox[{"uturnsSymmetrizedTranslatedThresholded", "[", 
     RowBox[{"[", "checkID", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"checkID", ",", "1", ",", 
     RowBox[{"Length", "@", "uturnsSymmetrizedTranslatedThresholded"}], ",", 
     "1"}], "}"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.9400139578430133`*^9, 3.9400141109787054`*^9}, {
   3.9400603060008993`*^9, 3.940060306764432*^9}, {3.9400604867102895`*^9, 
   3.9400604875636706`*^9}, 3.9400616225303307`*^9},
 CellLabel->
  "In[228]:=",ExpressionUUID->"fbdeeb40-bdff-4ed1-af87-743a0d601fa7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"uturnsAligned", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Select", "[", "\[IndentingNewLine]", 
       RowBox[{"#", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"getUturnAlignmentFactor", "@", "#"}], ">", 
          "alignmentFactorThreshold"}], "&"}]}], "\[IndentingNewLine]", "]"}],
       "&"}], "@", "uturnsSymmetrizedTranslatedThresholded"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"uturnsAligned", "//", 
  RowBox[{
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"#", ",", 
     RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], 
   "&"}]}], "\[IndentingNewLine]", 
 RowBox[{"uturnsAligned", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.940058310062276*^9, 3.9400583123862405`*^9}, {
   3.9400593436346025`*^9, 3.940059388381256*^9}, {3.940060232432716*^9, 
   3.9400602343644934`*^9}, 3.940060297880818*^9, {3.9400605080856075`*^9, 
   3.940060527756757*^9}, {3.940060676198248*^9, 3.940060736806139*^9}, {
   3.9400616394854937`*^9, 3.940061642662079*^9}, {3.9400716554368143`*^9, 
   3.9400716575372076`*^9}, {3.940076408947201*^9, 3.9400764119104867`*^9}, {
   3.940506087578656*^9, 3.9405060990273633`*^9}},
 CellLabel->
  "In[229]:=",ExpressionUUID->"8f7e05cc-f1d3-41e8-8e53-07bd0306b584"]
}, Closed]],

Cell[CellGroupData[{

Cell["Filter by Temporal Undersampling of Branches", "Subsubsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852707680645`*^9}, {3.939283916115666*^9, 3.939283923995065*^9}, {
   3.9393072447188826`*^9, 3.9393072455718374`*^9}, {3.9393119536702523`*^9, 
   3.9393119572015734`*^9}, {3.939363180003191*^9, 3.939363226228035*^9}, {
   3.939379600317065*^9, 3.9393796243604383`*^9}, {3.9400570530265174`*^9, 
   3.9400570576422358`*^9}, {3.940057313841945*^9, 3.9400573141226287`*^9}, {
   3.9400582838819513`*^9, 3.94005829299159*^9}, {3.9400601945039263`*^9, 
   3.940060195476585*^9}, {3.940063843191608*^9, 3.940063870295066*^9}, {
   3.9400639235297594`*^9, 
   3.9400639425526047`*^9}},ExpressionUUID->"db77de4f-0f14-4891-8d9b-\
10e3048579fb"],

Cell["\<\
Defaults:

branchSamplingRatioCritical=1.75;\
\>", "Abstract",
 CellChangeTimes->{{3.9392949906710997`*^9, 3.9392950001954107`*^9}, {
   3.939295066046317*^9, 3.9392950927342014`*^9}, {3.939307022230593*^9, 
   3.9393071606539865`*^9}, {3.939307217411355*^9, 3.9393072206830053`*^9}, {
   3.9393076234521294`*^9, 3.9393076368191233`*^9}, {3.9393078800360575`*^9, 
   3.939307900060156*^9}, {3.9393658470997615`*^9, 3.9393658827170153`*^9}, 
   3.9393794139921265`*^9, {3.9400670630245404`*^9, 3.9400670716168714`*^9}, {
   3.9400747556302776`*^9, 
   3.940074756646418*^9}},ExpressionUUID->"a6e35318-ecdd-4a30-bad2-\
c7e8714e59a8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"branchSamplingRatioCritical", "=", "1.75"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9400670173639097`*^9, 3.94006703953533*^9}, {
  3.94006943035528*^9, 3.940069432360961*^9}},
 CellLabel->
  "In[232]:=",ExpressionUUID->"b4b6ccf7-8167-4d65-96e6-8ee719da4ee6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ListLinePlot", "[", 
       RowBox[{"#", ",", 
        RowBox[{"PlotLabel", "\[Rule]", 
         RowBox[{"uturnBranchSamplingRatio", "@", "#"}]}]}], "]"}], "&"}], 
     "@", 
     RowBox[{"uturnsAligned", "[", 
      RowBox[{"[", "checkID", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"checkID", ",", "1", ",", 
      RowBox[{"Length", "@", "uturnsAligned"}], ",", "1"}], "}"}]}], 
   "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uturnBranchSamplingRatio", "/@", "uturnsAligned"}], "//", 
  RowBox[{
   RowBox[{"Histogram", "[", 
    RowBox[{"#", ",", "histogramBinningMethod", ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}]}]}], "Input",
 CellChangeTimes->{{3.9400139578430133`*^9, 3.9400141109787054`*^9}, {
   3.9400603060008993`*^9, 3.940060306764432*^9}, {3.9400604867102895`*^9, 
   3.9400604875636706`*^9}, 3.9400616225303307`*^9, {3.940065811355883*^9, 
   3.940065819919969*^9}, {3.9400714697399225`*^9, 3.940071482908182*^9}, {
   3.940151678175432*^9, 3.940151678341074*^9}},
 CellLabel->
  "In[233]:=",ExpressionUUID->"cbdf3033-9c25-4b58-a231-f58fd32708b8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"uturnsAlignedSampled", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Select", "[", "\[IndentingNewLine]", 
       RowBox[{"#", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"uturnBranchSamplingRatio", "@", "#"}], "\[LessEqual]", 
          "branchSamplingRatioCritical"}], "&"}]}], "\[IndentingNewLine]", 
       "]"}], "&"}], "@", "uturnsAligned"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"uturnsAlignedSampled", "//", 
  RowBox[{
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"#", ",", 
     RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}], 
   "&"}]}], "\[IndentingNewLine]", 
 RowBox[{"uturnsAlignedSampled", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.940071500915644*^9, 3.9400715649508843`*^9}, {
  3.9400716742199907`*^9, 3.940071676373118*^9}, {3.9400764181121006`*^9, 
  3.940076420926649*^9}},
 CellLabel->
  "In[235]:=",ExpressionUUID->"0671024e-ce5f-4d78-a576-0cafd5328895"]
}, Closed]],

Cell[CellGroupData[{

Cell["Remove Multi-Peak U-turns -- Second Pass", "Subsubsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852707680645`*^9}, {3.939283916115666*^9, 3.939283923995065*^9}, {
   3.9393072447188826`*^9, 3.9393072455718374`*^9}, {3.9393119536702523`*^9, 
   3.9393119572015734`*^9}, {3.939363180003191*^9, 3.939363226228035*^9}, {
   3.939379600317065*^9, 3.9393796243604383`*^9}, {3.9400570530265174`*^9, 
   3.9400570576422358`*^9}, {3.940057313841945*^9, 3.9400573141226287`*^9}, {
   3.9400582838819513`*^9, 3.94005829299159*^9}, {3.9400601945039263`*^9, 
   3.940060195476585*^9}, {3.940063843191608*^9, 3.940063870295066*^9}, {
   3.9400734786999874`*^9, 3.9400734813568144`*^9}, {3.9400738490525627`*^9, 
   3.940073856102356*^9}},ExpressionUUID->"85218a33-edd7-42b3-be86-\
531634b705d3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uturnsAlignedUpsampled", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"uniformlyUpsampleCurve", "[", "\[IndentingNewLine]", 
         RowBox[{"#", ",", "splineOrder", ",", 
          RowBox[{"upsampleFactor", "*", 
           RowBox[{"Length", "@", "#"}]}]}], "\[IndentingNewLine]", "]"}], 
        "&"}], "/@", "uturnsAlignedSampled"}], "//", "Parallelize"}]}], ";"}],
    "//", "Quiet"}], "//", "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.939976745448863*^9, 3.939976962791937*^9}, {
   3.939977032329233*^9, 3.93997707700793*^9}, {3.939977149049133*^9, 
   3.9399771829658313`*^9}, {3.93997802241074*^9, 3.9399780293768945`*^9}, 
   3.9399828168277903`*^9, {3.940062037607647*^9, 3.940062044541256*^9}, {
   3.9400621297598896`*^9, 3.9400621316946135`*^9}, 3.9400717410878496`*^9},
 CellLabel->
  "In[238]:=",ExpressionUUID->"a113abc5-1b06-44d2-b5a5-04535be65932"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Manipulator", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Dynamic", "@", "x"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"Length", "@", "uturnsAlignedSampled"}], ",", "1"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Appearance", "\[Rule]", "\"\<DownArrow\>\""}]}], 
     "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Dynamic", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"testParameters", "=", 
       RowBox[{"upsampleFactor", "*", 
        RowBox[{"{", 
         RowBox[{"0.25", ",", "0.25", ",", "0.00175"}], "}"}], "*", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
         "smoothingWindowSize", ",", "gaussianFilterScale", ",", 
          "peakThreshold"}], "\[IndentingNewLine]", "}"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"testUturn", "=", 
       RowBox[{"uturnsAlignedSampled", "[", 
        RowBox[{"[", "x", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"testRefinedCurvaturePoints", "=", 
       RowBox[{"getRefinedCurvaturePoints", "[", "\[IndentingNewLine]", 
        RowBox[{"testUturn", ",", 
         RowBox[{"uturnsAlignedUpsampled", "[", 
          RowBox[{"[", "x", "]"}], "]"}], ",", "testParameters"}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"testTrackEndPoints", "=", 
       RowBox[{"testUturn", "[", 
        RowBox[{"[", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"testRefinedUturnPoints", "=", 
       RowBox[{"Complement", "[", 
        RowBox[{"testRefinedCurvaturePoints", ",", "testTrackEndPoints"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"testUturn", "//", "ListLinePlot"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"ListPlot", "[", 
             RowBox[{"#", ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"Directive", "[", 
                RowBox[{
                 RowBox[{"Darker", "@", "Green"}], ",", 
                 RowBox[{"PointSize", "@", "0.03"}]}], "]"}]}]}], "]"}], 
            "&"}], "@", "testRefinedUturnPoints"}]}], "\[IndentingNewLine]", 
         "}"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "}"}], "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.9399613256973343`*^9, 3.939961400880833*^9}, {
   3.9399615356196775`*^9, 3.939961612243009*^9}, {3.9399616596509333`*^9, 
   3.939961667511138*^9}, {3.9399617131421127`*^9, 3.939961761419031*^9}, {
   3.9399628736087146`*^9, 3.9399629074069786`*^9}, {3.9399719502640076`*^9, 
   3.939971956655987*^9}, {3.939972016630646*^9, 3.939972056109325*^9}, {
   3.9399721254791517`*^9, 3.939972209188609*^9}, {3.939972309193261*^9, 
   3.939972366156869*^9}, {3.9399727100140285`*^9, 3.939972710760316*^9}, {
   3.93997274580751*^9, 3.939972780262348*^9}, {3.9399728352948856`*^9, 
   3.9399728988390822`*^9}, 3.9399773891857*^9, {3.939978441570321*^9, 
   3.9399784745216875`*^9}, {3.9399785965696735`*^9, 
   3.9399790267303843`*^9}, {3.939979060283292*^9, 3.9399790612016797`*^9}, {
   3.939979092517418*^9, 3.939979132025433*^9}, {3.9399791698112144`*^9, 
   3.939979204601454*^9}, {3.939979250700565*^9, 3.9399792866656966`*^9}, {
   3.9399793178913207`*^9, 3.9399793603306403`*^9}, {3.939979683306926*^9, 
   3.9399796865665255`*^9}, {3.939979737702042*^9, 3.9399797502050686`*^9}, {
   3.939979995469081*^9, 3.9399800124431925`*^9}, {3.939980072118976*^9, 
   3.9399800925538197`*^9}, {3.939980135494196*^9, 3.939980137300462*^9}, {
   3.939980173051752*^9, 3.939980283039233*^9}, {3.939980339940259*^9, 
   3.9399803527073803`*^9}, {3.939981291073588*^9, 3.939981301100424*^9}, {
   3.939981406228774*^9, 3.939981418540986*^9}, {3.939981732415682*^9, 
   3.93998174286941*^9}, {3.9399821524220343`*^9, 3.939982232454856*^9}, {
   3.9400091735946517`*^9, 3.940009183225032*^9}, {3.940052369445591*^9, 
   3.9400523736081543`*^9}, {3.9400621430945115`*^9, 3.940062232523304*^9}, {
   3.9400622829841633`*^9, 3.9400623217809577`*^9}, 3.940062371207802*^9, {
   3.9400625287432723`*^9, 3.9400626215911007`*^9}, {3.9400628074419737`*^9, 
   3.9400628186307573`*^9}, {3.940063164953763*^9, 3.940063191063942*^9}, 
   3.9400632577769947`*^9, {3.9400637859282913`*^9, 3.94006378613601*^9}, {
   3.940071744775522*^9, 3.940071745436508*^9}, {3.9400717801325483`*^9, 
   3.9400717968358564`*^9}, {3.940071988664255*^9, 3.940072018899912*^9}, {
   3.940072065005205*^9, 3.940072122863464*^9}},
 CellLabel->
  "In[239]:=",ExpressionUUID->"fd75f0c9-7267-4209-b1ec-fa2301536a53"],

Cell["\<\
Defaults:

secondaryCurvaturePointFilterParameters=upsampleFactor*{0.25,0.25,0.00175}*{
smoothingWindowSize,gaussianFilterScale,peakThreshold
};\
\>", "Abstract",
 CellChangeTimes->{{3.9392949906710997`*^9, 3.9392950001954107`*^9}, {
   3.939295066046317*^9, 3.9392950927342014`*^9}, {3.939307022230593*^9, 
   3.9393071606539865`*^9}, {3.939307217411355*^9, 3.9393072206830053`*^9}, {
   3.9393076234521294`*^9, 3.9393076368191233`*^9}, {3.9393078800360575`*^9, 
   3.939307900060156*^9}, {3.9393658470997615`*^9, 3.9393658827170153`*^9}, 
   3.9393794139921265`*^9, {3.9400670630245404`*^9, 3.9400670716168714`*^9}, 
   3.9400747859741125`*^9},ExpressionUUID->"fe86763f-7a8b-4f9b-a3a8-\
9162537daeb1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"secondaryCurvaturePointFilterParameters", "=", 
   RowBox[{"upsampleFactor", "*", 
    RowBox[{"{", 
     RowBox[{"0.25", ",", "0.25", ",", "0.00175"}], "}"}], "*", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "smoothingWindowSize", ",", "gaussianFilterScale", ",", 
      "peakThreshold"}], "\[IndentingNewLine]", "}"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9400747322414107`*^9, 3.9400747791930485`*^9}},
 CellLabel->
  "In[240]:=",ExpressionUUID->"b495359d-31c9-4ba1-b6df-54f5bf5ecd2f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"secondaryCurvaturePoints", "=", 
     RowBox[{"Parallelize", "@", 
      RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Quiet", "@", 
          RowBox[{"getRefinedCurvaturePoints", "[", "\[IndentingNewLine]", 
           RowBox[{
           "#1", ",", "#2", ",", "secondaryCurvaturePointFilterParameters"}], 
           "\[IndentingNewLine]", "]"}]}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{"uturnsAlignedSampled", ",", "uturnsAlignedUpsampled"}], 
         "}"}]}], "\[IndentingNewLine]", "]"}]}]}], ";"}], "//", 
   "AbsoluteTiming"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uturnEndPointsSecondary", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], "&"}], "/@", 
     "uturnsAlignedSampled"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"secondaryUturnPoints", "=", 
    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Complement", "[", 
        RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"secondaryCurvaturePoints", ",", "uturnEndPointsSecondary"}], 
       "}"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uturnsClean", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"First", "@", 
       RowBox[{"Transpose", "@", 
        RowBox[{"Select", "[", 
         RowBox[{"#", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Last", "@", "#"}], "\[LessEqual]", "0"}], "&"}]}], 
         "]"}]}]}], "&"}], "@", 
     RowBox[{"Transpose", "@", 
      RowBox[{"{", 
       RowBox[{"uturnsAlignedSampled", ",", 
        RowBox[{
         RowBox[{"Length", "/@", "secondaryUturnPoints"}], "-", "1"}]}], 
       "}"}]}]}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"uturnsClean", "//", 
  RowBox[{
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"#", ",", 
     RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}], 
   "&"}]}], "\[IndentingNewLine]", 
 RowBox[{"uturnsClean", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.939981924055212*^9, 3.939982009651331*^9}, {
   3.939982117539789*^9, 3.939982143699192*^9}, {3.939982864219385*^9, 
   3.9399828676036263`*^9}, {3.9399829076149693`*^9, 
   3.9399829486126003`*^9}, {3.939982996683054*^9, 3.9399830531866226`*^9}, {
   3.9399834085094852`*^9, 3.939983475717331*^9}, {3.9399837547411942`*^9, 
   3.939983756723618*^9}, {3.939983974285722*^9, 3.9399839768698015`*^9}, {
   3.9399842835166492`*^9, 3.9399842948643637`*^9}, {3.940074178646406*^9, 
   3.9400742262139*^9}, {3.9400747910296087`*^9, 3.940074871149445*^9}, 
   3.9400749081930137`*^9, {3.940074954126408*^9, 3.9400749613905764`*^9}, {
   3.940075082021718*^9, 3.940075141646021*^9}, 3.94007547004659*^9, 
   3.9400764273201513`*^9},
 CellLabel->
  "In[241]:=",ExpressionUUID->"13157b82-98d2-4193-bd3c-451e6d0b0a84"]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["MTB Magnetic Moment from U-turns", "Section",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852533120594`*^9}, {3.939282491291642*^9, 3.9392824968283243`*^9}, {
   3.9393119812062926`*^9, 3.939311985870982*^9}, {3.9393638268049383`*^9, 
   3.939363856468144*^9}},ExpressionUUID->"12760c06-8c74-4d75-8dac-\
082d8aac9188"],

Cell[CellGroupData[{

Cell["Determine the L Values for U-turns", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852842898235`*^9}, {3.917385345743088*^9, 3.9173853474802213`*^9}, {
   3.9174462057146387`*^9, 3.917446276705615*^9}, {3.940072906684471*^9, 
   3.940072915843356*^9}},ExpressionUUID->"9a04b81c-02c0-4364-945f-\
d4eec3bd074a"],

Cell[CellGroupData[{

Cell["Theoretical U-turn Shape Function", "Subsubsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852842898235`*^9}, {3.917385345743088*^9, 3.9173853474802213`*^9}, {
   3.9174462057146387`*^9, 3.917446276705615*^9}, {3.928750055957734*^9, 
   3.9287500593085237`*^9}, {3.9400728900516157`*^9, 
   3.940072895598485*^9}},ExpressionUUID->"2be56988-0a58-4bdc-a34f-\
8b3c59f9e90b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"trackTheoryFunction", "[", 
    RowBox[{"x_", ",", "x0_", ",", "y0_", ",", "L_"}], "]"}], ":=", 
   RowBox[{"y0", "-", 
    RowBox[{
     RowBox[{"L", "/", "Pi"}], "*", 
     RowBox[{"Log", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"Tan", "[", 
           RowBox[{"Pi", "*", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"x", "-", "x0"}], ")"}], "/", "2"}], "/", "L"}]}], 
           "]"}], "^", "2"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"Tan", "[", 
           RowBox[{"Pi", "*", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"x", "-", "x0"}], ")"}], "/", "2"}], "/", "L"}]}], 
           "]"}], "^", "2"}]}], ")"}]}], "]"}]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"trackTheoryFunction", "@@", 
    RowBox[{"{", 
     RowBox[{"x1", ",", "x0", ",", "y0", ",", "L"}], "}"}]}], "//", 
   "TeXForm"}], "//", "getLatexStyling"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"trackTheoryFunction", "@@", 
      RowBox[{"{", 
       RowBox[{"x1", ",", "x0", ",", "y0", ",", "L"}], "}"}]}], "//", 
     "Simplify"}], "//", "TeXForm"}], "//", "getLatexStyling"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"trackTheoryFunctionInverse", "[", 
    RowBox[{"y_", ",", "x0_", ",", "y0_", ",", "L_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Simplify", "@", 
       RowBox[{"InverseFunction", "[", "\[IndentingNewLine]", 
        RowBox[{"trackTheoryFunction", ",", "1", ",", "4"}], 
        "\[IndentingNewLine]", "]"}]}], "@@", 
      RowBox[{"{", 
       RowBox[{"x", ",", "x0", ",", "y0", ",", "L"}], "}"}]}], "/.", 
     RowBox[{"x", "\[Rule]", "y"}]}], "//", "Quiet"}]}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"trackTheoryFunctionInverse", "@@", 
    RowBox[{"{", 
     RowBox[{"y", ",", "x0", ",", "y0", ",", "L"}], "}"}]}], "//", 
   "TeXForm"}], "//", "getLatexStyling"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9120499530237055`*^9, 3.912049976281886*^9}, {
   3.9120505589732833`*^9, 3.9120506247650814`*^9}, {3.9120611092171993`*^9, 
   3.912061112086233*^9}, {3.912065017805363*^9, 3.9120650240948353`*^9}, {
   3.912065063041912*^9, 3.9120650729869604`*^9}, {3.9131872370022*^9, 
   3.9131872403774853`*^9}, {3.913187336018282*^9, 3.9131873964142275`*^9}, {
   3.913193061859541*^9, 3.913193106709131*^9}, {3.9131932674531536`*^9, 
   3.9131932822963543`*^9}, {3.913193448398198*^9, 3.9131934488890853`*^9}, {
   3.913193545566886*^9, 3.913193547161867*^9}, {3.9131942273782597`*^9, 
   3.91319424564592*^9}, {3.91319623100205*^9, 3.913196231464664*^9}, {
   3.913196739948304*^9, 3.91319674041123*^9}, {3.913196831661765*^9, 
   3.913196832043769*^9}, {3.9131968885290537`*^9, 3.913196889063735*^9}, {
   3.913197277713873*^9, 3.913197280782032*^9}, {3.913264822321871*^9, 
   3.913264823807911*^9}, {3.9132652326918163`*^9, 3.913265233153818*^9}, {
   3.91326554395722*^9, 3.913265544621597*^9}, {3.9132656160075502`*^9, 
   3.9132656177315893`*^9}, {3.9132678991517024`*^9, 3.9132678998665953`*^9}, 
   3.9173559643427887`*^9, {3.917357169543005*^9, 3.9173571785556726`*^9}, {
   3.9173694267137985`*^9, 3.917369443431907*^9}, {3.91737095500947*^9, 
   3.9173709632242117`*^9}, {3.917436505722941*^9, 3.9174365172936077`*^9}, 
   3.9174469800433445`*^9, {3.928739349842855*^9, 3.928739358559154*^9}, {
   3.928739427409311*^9, 3.9287395301776133`*^9}, {3.928739630104554*^9, 
   3.9287396594620514`*^9}, {3.928740073883556*^9, 3.928740080059108*^9}, {
   3.940071102838719*^9, 3.94007110300356*^9}, {3.9400755503993464`*^9, 
   3.9400755509617124`*^9}},
 CellLabel->
  "In[247]:=",ExpressionUUID->"0ac7b002-5c13-4edb-afd4-9743b9fcc792"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"testBranchLength", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"testZeroX", ",", "testZeroY"}], "}"}], "=", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"testReferencePlot", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Plot", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"trackTheoryFunction", "[", 
       RowBox[{"x", ",", "testZeroX", ",", "testZeroY", ",", 
        RowBox[{"2", "*", "#"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{
         RowBox[{"-", "#"}], "+", "testZeroX"}], ",", 
        RowBox[{"#", "+", "testZeroX"}]}], "}"}], ",", "\[IndentingNewLine]", 
      " ", 
      RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
      RowBox[{"Epilog", "\[Rule]", 
       RowBox[{"Point", "[", 
        RowBox[{"{", 
         RowBox[{"testZeroX", ",", "testZeroY"}], "}"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}], "&"}], "@", 
   "testBranchLength"}]}]}], "Input",
 CellChangeTimes->{{3.9173582922067986`*^9, 3.917358326834155*^9}, {
   3.9173687106648445`*^9, 3.9173687497103977`*^9}, {3.917369451121724*^9, 
   3.917369533881149*^9}, {3.917369564848442*^9, 3.9173695703035975`*^9}, {
   3.9173696153595915`*^9, 3.9173697261030464`*^9}, {3.9173704018968706`*^9, 
   3.9173704134083805`*^9}, 3.917370967731613*^9, 3.917371359192417*^9, {
   3.917436562630316*^9, 3.917436604940059*^9}, {3.928826381075378*^9, 
   3.928826396813319*^9}},
 CellLabel->
  "In[252]:=",ExpressionUUID->"15b84317-d51e-46a8-8717-6f93c3cb2880"]
}, Closed]],

Cell[CellGroupData[{

Cell["Set Up the Optimization Parameters", "Subsubsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852842898235`*^9}, {3.917385345743088*^9, 3.9173853474802213`*^9}, {
   3.9174462057146387`*^9, 3.917446276705615*^9}, {3.928750055957734*^9, 
   3.9287500985145893`*^9}, {3.9400735144121656`*^9, 
   3.9400735248630686`*^9}, {3.9400757030373373`*^9, 
   3.9400757043947783`*^9}, {3.940078006992259*^9, 
   3.940078007249323*^9}},ExpressionUUID->"2f714c8f-e940-4bcc-bf69-\
c7c259467ba8"],

Cell["\<\
Defaults :
   
{zeroX,zeroY}={0,-1};
theorySampleCount=2250;
epsilonX=5*10^-4;
penaltyWeight=1;

uturnBoxSizeFactor=2;
initialRangeFactorWidth=0.75;
initialWidthResolution=15;
initialAngleResolution=15;

refinementRangeFactorAngle=0.05;
refinementRangeFactorWidth=0.075;
refinementAngleResolution=25;
refinementWidthResolution=25;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.890210387568242*^9, {3.8907334164048786`*^9, 3.8907334344441056`*^9}, 
   3.9157368454102073`*^9, 3.91573884230005*^9, {3.9170181261303744`*^9, 
   3.91701812778405*^9}, {3.917374947355131*^9, 3.9173749593748264`*^9}, {
   3.917375407792037*^9, 3.917375408800247*^9}, {3.9287561533860874`*^9, 
   3.9287561587200356`*^9}, {3.928807429163335*^9, 3.9288074490169783`*^9}, {
   3.9400755708794165`*^9, 3.940075597509433*^9}, {3.9400756418134203`*^9, 
   3.9400756425712814`*^9}, 3.9400766312321825`*^9},
 FontSize->16,ExpressionUUID->"4d80c19d-5cc5-4d46-879e-cecfa69f946d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"fitnessLabels", "=", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Nearest Neigbor Fitness Function\>\"", ",", 
      "\"\<Y Sign Penalty Function\>\"", ",", 
      "\"\<Combined Fitness Function\>\"", ",", 
      RowBox[{"getLatexStyling", "@", "\"\<L, \\\\mu m\>\""}]}], "}"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"zeroX", ",", "zeroY"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "1"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"theorySampleCount", "=", "2250"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"epsilonX", "=", 
   RowBox[{"5", "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "4"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"penaltyWeight", "=", "1"}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"uturnBoxSizeFactor", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"initialRangeFactorWidth", "=", "0.75"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"initialWidthResolution", "=", "15"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"initialAngleResolution", "=", "15"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"refinementRangeFactorAngle", "=", "0.05"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"refinementRangeFactorWidth", "=", "0.075"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"refinementAngleResolution", "=", "25"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"refinementWidthResolution", "=", "25"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9173703915457*^9, 3.9173706410294085`*^9}, {
   3.917370737415636*^9, 3.917370762895576*^9}, {3.917370796544736*^9, 
   3.917370797407057*^9}, 3.917371142745513*^9, {3.917371225160968*^9, 
   3.917371293496992*^9}, {3.9173713266634245`*^9, 3.9173715618557916`*^9}, {
   3.9173715982100444`*^9, 3.9173716864918566`*^9}, {3.9173717241923165`*^9, 
   3.917371933276264*^9}, {3.917372183336007*^9, 3.917372234179821*^9}, {
   3.917372557801721*^9, 3.9173725660042706`*^9}, {3.9173726570339327`*^9, 
   3.917372657886131*^9}, {3.9173726888252745`*^9, 3.917372689614261*^9}, 
   3.917372948114046*^9, {3.9173731040959077`*^9, 3.917373105320768*^9}, {
   3.9173731394564075`*^9, 3.9173731477016945`*^9}, {3.917373385657028*^9, 
   3.9173734136544714`*^9}, {3.917373460577216*^9, 3.9173736004875417`*^9}, {
   3.9173736385514336`*^9, 3.917373745584104*^9}, {3.917373917683817*^9, 
   3.9173739756727114`*^9}, {3.9173740320554943`*^9, 
   3.9173740492720127`*^9}, {3.917374735853089*^9, 3.9173747796168175`*^9}, {
   3.917375245457662*^9, 3.9173752502904334`*^9}, {3.917375485633931*^9, 
   3.917375587912936*^9}, {3.917375649392336*^9, 3.917375669151954*^9}, {
   3.91737786633661*^9, 3.9173778691595907`*^9}, {3.91737883242386*^9, 
   3.917378843849354*^9}, {3.917380568185474*^9, 3.917380589783831*^9}, 
   3.917380669256355*^9, {3.9173808170178595`*^9, 3.9173808173275537`*^9}, {
   3.9173809086958227`*^9, 3.917380967455777*^9}, 3.9173886131799235`*^9, 
   3.91738864767445*^9, {3.9173886838019648`*^9, 3.9173887298648634`*^9}, {
   3.9173887800894175`*^9, 3.9173887832658854`*^9}, {3.917388916779002*^9, 
   3.917388942693818*^9}, {3.9173891000843296`*^9, 3.9173891006568627`*^9}, {
   3.9173891373706183`*^9, 3.9173891677441616`*^9}, {3.917389300586628*^9, 
   3.9173893140500383`*^9}, {3.9173893813889804`*^9, 3.917389430139213*^9}, {
   3.9173894855321198`*^9, 3.9173895127401323`*^9}, {3.917389682531948*^9, 
   3.917389701218162*^9}, {3.917389936281823*^9, 3.9173899632085857`*^9}, {
   3.9173901351240997`*^9, 3.91739019992262*^9}, {3.917390287856534*^9, 
   3.9173903192921853`*^9}, {3.91743574282644*^9, 3.917435743692275*^9}, {
   3.9174360567181206`*^9, 3.9174360570415*^9}, 3.9174367459255486`*^9, {
   3.917436830638093*^9, 3.917436830713188*^9}, {3.917436911322138*^9, 
   3.9174369639070363`*^9}, {3.9174370649866714`*^9, 
   3.9174370963144464`*^9}, {3.917437145618822*^9, 3.91743722365306*^9}, {
   3.9174372935498996`*^9, 3.917437312109289*^9}, {3.9174373795810423`*^9, 
   3.9174373796380835`*^9}, {3.9174374352830014`*^9, 
   3.9174374661472626`*^9}, {3.917438795027147*^9, 3.9174387959789777`*^9}, {
   3.917440055829748*^9, 3.917440216627867*^9}, {3.917440265190096*^9, 
   3.9174403136998425`*^9}, {3.9174403652029915`*^9, 
   3.9174404431145306`*^9}, {3.917440475646488*^9, 3.917440532379839*^9}, {
   3.9174405824848595`*^9, 3.9174405952295184`*^9}, {3.9174406348423214`*^9, 
   3.9174406553396254`*^9}, {3.9174409953635406`*^9, 3.917441022442642*^9}, {
   3.9174411496038017`*^9, 3.9174411931252728`*^9}, {3.9174419450148964`*^9, 
   3.917441998236452*^9}, {3.9174444806982884`*^9, 3.9174444917630973`*^9}, {
   3.917444899324567*^9, 3.91744491617944*^9}, 3.917445397923635*^9, {
   3.9174454365149927`*^9, 3.9174454366769147`*^9}, {3.9174454723892746`*^9, 
   3.91744560405884*^9}, {3.9174456520033216`*^9, 3.917445718010948*^9}, {
   3.917445751275566*^9, 3.9174458384706135`*^9}, {3.917445886333576*^9, 
   3.9174459712863474`*^9}, {3.917446080179015*^9, 3.9174461026602526`*^9}, {
   3.917446148146455*^9, 3.917446184988134*^9}, {3.917446532850391*^9, 
   3.9174466608602643`*^9}, {3.917447117970607*^9, 3.9174471420030403`*^9}, 
   3.9174471926956253`*^9, {3.9174472536917872`*^9, 3.9174473053158035`*^9}, {
   3.9174474210196943`*^9, 3.917447490275578*^9}, {3.917447548769739*^9, 
   3.9174475615171137`*^9}, {3.91744760039019*^9, 3.917447669524233*^9}, {
   3.917447721339379*^9, 3.9174478505050488`*^9}, {3.9174479496768246`*^9, 
   3.917447988291336*^9}, {3.917448041203642*^9, 3.917448051859317*^9}, {
   3.9177303824093666`*^9, 3.9177305107212577`*^9}, {3.9177307752278085`*^9, 
   3.9177307828255663`*^9}, {3.9287376669070053`*^9, 
   3.9287376748689613`*^9}, {3.9287377049924593`*^9, 3.928737714195104*^9}, {
   3.9287377909820194`*^9, 3.9287378215481567`*^9}, {3.9287379037542443`*^9, 
   3.928737928613713*^9}, {3.9287380024309893`*^9, 3.928738054940983*^9}, {
   3.9287397707099257`*^9, 3.9287398458985887`*^9}, {3.9287401307302237`*^9, 
   3.9287401312682486`*^9}, {3.928740294257975*^9, 3.928740360250144*^9}, {
   3.928740786128336*^9, 3.9287407862681265`*^9}, {3.9287414534799185`*^9, 
   3.9287415301053295`*^9}, {3.9287416500035686`*^9, 
   3.9287416503282013`*^9}, {3.928743282041048*^9, 3.928743311967419*^9}, {
   3.928751427445941*^9, 3.928751482058256*^9}, {3.928751623196481*^9, 
   3.928751671762863*^9}, {3.9287558341151586`*^9, 3.928755845674638*^9}, {
   3.928756168306304*^9, 3.928756168743182*^9}, 3.9287568451783466`*^9, {
   3.9288072741049066`*^9, 3.9288072743287745`*^9}, {3.9288076807738223`*^9, 
   3.928807680877192*^9}, 3.92880777768054*^9, {3.9288079461243896`*^9, 
   3.928807967687829*^9}, {3.928808068887474*^9, 3.9288080734202833`*^9}, {
   3.928808206778433*^9, 3.928808207794753*^9}, {3.9288083536814547`*^9, 
   3.928808353924155*^9}, {3.928808534347372*^9, 3.928808536774379*^9}, {
   3.9288091165479393`*^9, 3.9288091217524643`*^9}, {3.9288092348343925`*^9, 
   3.9288092360864153`*^9}, {3.928809838346114*^9, 3.9288098394018784`*^9}, 
   3.92881003037473*^9, 3.928811545358881*^9, 3.9288116348118353`*^9, 
   3.9288118219930816`*^9, {3.928812207862749*^9, 3.9288122171926203`*^9}, {
   3.9288155919329095`*^9, 3.928815606681059*^9}, 3.9288156975047846`*^9, {
   3.9288167882568464`*^9, 3.928816789690613*^9}, 3.9288169024857116`*^9, 
   3.9288172888821845`*^9, {3.928818349607647*^9, 3.9288183567848673`*^9}, {
   3.9288184690782833`*^9, 3.92881847169075*^9}, {3.9288263380547056`*^9, 
   3.92882633998431*^9}, {3.928826426210227*^9, 3.9288264266190453`*^9}, 
   3.9288265254597836`*^9, 3.9288279930594997`*^9, 3.9288281106158333`*^9, {
   3.9288297880650454`*^9, 3.9288297881320806`*^9}, 3.9288342694952745`*^9, 
   3.9288345235380507`*^9, 3.928834761342395*^9, {3.9288433167492514`*^9, 
   3.928843316824154*^9}, 3.9289038734704957`*^9, 3.9400130008679104`*^9, {
   3.9400554515062237`*^9, 3.940055451608774*^9}, 3.9400634849915767`*^9, {
   3.9400728773990965`*^9, 3.940072878164173*^9}, {3.940075584168617*^9, 
   3.9400756491686735`*^9}},
 CellLabel->
  "In[255]:=",ExpressionUUID->"ab3ca144-ec3d-4d85-a415-a982f73195b2"]
}, Closed]],

Cell[CellGroupData[{

Cell["Optimization Test Module Definition (RUN)", "Subsubsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852842898235`*^9}, {3.917385345743088*^9, 3.9173853474802213`*^9}, {
   3.9174462057146387`*^9, 3.917446276705615*^9}, {3.928750055957734*^9, 
   3.9287500985145893`*^9}, {3.9400735144121656`*^9, 
   3.9400735248630686`*^9}, {3.94007571136057*^9, 
   3.9400757449897738`*^9}},ExpressionUUID->"42979179-e336-4c14-bbfb-\
4326d68704b8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"optimizationTestModule", "[", "uturn_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"inputUturn", "=", "uturn"}], ",", "translatedData", ",", 
      "\[IndentingNewLine]", "testUturnBoxSize", ",", "testWidthRange", ",", 
      "testAngleRange", ",", "testFitnessRange", ",", "\[IndentingNewLine]", 
      "testOptimalInstances", ",", "testOptimalAngles", ",", 
      "testOptimalWidths", ",", "\[IndentingNewLine]", "firstEstimateAngle", 
      ",", "firstEstimateWidth", ",", "referenceFitness", ",", 
      "\[IndentingNewLine]", "optimalWidth", ",", "optimalAngle", ",", 
      "optimalRotationMatrix", ",", "optimalRotatedData", ",", "sampleData", 
      ",", "\[IndentingNewLine]", "testFitnessFunction", ",", 
      "testPenaltyFunction", ",", "plotFitResult", ",", 
      "uturnWidthMicrometers"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"translatedData", "=", "inputUturn"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"translatedData", "//", "ListLinePlot"}], "//", "Print"}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"testUturnBoxSize", "=", 
          RowBox[{
           RowBox[{"Times", "@@", 
            RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"Differences", "/@", 
                RowBox[{"Sort", "/@", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"First", "@", "#"}], ",", 
                   RowBox[{"Last", "@", "#"}]}], "}"}]}]}], "&"}], "@", 
              RowBox[{"BoundingRegion", "@", "translatedData"}]}], 
             "\[IndentingNewLine]", "]"}]}], "//", "Sqrt"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"testWidthRange", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Range", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"#", ">", "0"}], ",", "#", ",", "0"}], "]"}], "&"}],
                "@", 
               RowBox[{"(", 
                RowBox[{"#1", "-", 
                 RowBox[{"#2", "*", "#1"}]}], ")"}]}], ",", 
              RowBox[{"#1", "+", 
               RowBox[{"#2", "*", "#1"}]}], ",", 
              RowBox[{"2", "*", "#2", "*", 
               RowBox[{"#1", "/", "initialWidthResolution"}]}]}], 
             "\[IndentingNewLine]", "]"}], "&"}], "@@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"uturnBoxSizeFactor", "*", "testUturnBoxSize"}], ",", 
             "initialRangeFactorWidth"}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"testAngleRange", "=", 
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", 
            RowBox[{"2", "*", "\[Pi]"}], ",", 
            RowBox[{"\[Pi]", "/", "initialAngleResolution"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"testFitnessRange", "=", 
          RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"fitnessFunctionTotal", "[", "\[IndentingNewLine]", 
             RowBox[{
             "translatedData", ",", "angle", ",", "zeroX", ",", "zeroY", ",", 
              "testBranchWidth", ",", "penaltyWeight"}], 
             "\[IndentingNewLine]", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"angle", ",", "testAngleRange"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"testBranchWidth", ",", "testWidthRange"}], "}"}]}], 
           "\[IndentingNewLine]", "]"}]}], ";"}], "//", "AbsoluteTiming"}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Min", "@", "testFitnessRange"}], "//", "Print"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"testOptimalInstances", "=", 
        RowBox[{"Position", "[", 
         RowBox[{"testFitnessRange", ",", 
          RowBox[{"Min", "@", "testFitnessRange"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"testOptimalAngles", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"testAngleRange", "[", 
            RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
          RowBox[{"First", "/@", "testOptimalInstances"}]}], "//", "N"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"testOptimalWidths", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"testWidthRange", "[", 
           RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
         RowBox[{"Last", "/@", "testOptimalInstances"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"firstEstimateAngle", ",", "firstEstimateWidth"}], "}"}], 
        "=", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{"testOptimalAngles", ",", "testOptimalWidths"}], "}"}]}]}], 
       ";", "\n", "\[IndentingNewLine]", 
       RowBox[{"referenceFitness", "=", 
        RowBox[{"fitnessFunctionTotal", "[", "\[IndentingNewLine]", 
         RowBox[{
         "translatedData", ",", "firstEstimateAngle", ",", "zeroX", ",", 
          "zeroY", ",", "firstEstimateWidth", ",", "penaltyWeight"}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\n", "\[IndentingNewLine]", 
       RowBox[{"testAngleRange", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Range", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"#1", "-", 
             RowBox[{"#2", "*", "#1"}]}], ",", 
            RowBox[{"#1", "+", 
             RowBox[{"#2", "*", "#1"}]}], ",", 
            RowBox[{"2", "*", "#2", "*", 
             RowBox[{"#1", "/", "refinementAngleResolution"}]}]}], 
           "\[IndentingNewLine]", "]"}], "&"}], "@@", 
         RowBox[{"{", 
          RowBox[{"firstEstimateAngle", ",", "refinementRangeFactorAngle"}], 
          "}"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"testWidthRange", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Range", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"#1", "-", 
             RowBox[{"#2", "*", "#1"}]}], ",", 
            RowBox[{"#1", "+", 
             RowBox[{"#2", "*", "#1"}]}], ",", 
            RowBox[{"2", "*", "#2", "*", 
             RowBox[{"#1", "/", "refinementWidthResolution"}]}]}], 
           "\[IndentingNewLine]", "]"}], "&"}], "@@", 
         RowBox[{"{", 
          RowBox[{"firstEstimateWidth", ",", "refinementRangeFactorWidth"}], 
          "}"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"testFitnessRange", "=", 
        RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"fitnessFunctionTotal", "[", "\[IndentingNewLine]", 
           RowBox[{
           "translatedData", ",", "angle", ",", "zeroX", ",", "zeroY", ",", 
            "testBranchWidth", ",", "penaltyWeight"}], "\[IndentingNewLine]", 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"angle", ",", "testAngleRange"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"testBranchWidth", ",", "testWidthRange"}], "}"}]}], 
         "\[IndentingNewLine]", "]"}]}], ";"}], "//", "AbsoluteTiming"}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Min", "@", "testFitnessRange"}], "//", "Print"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"testOptimalInstances", "=", 
      RowBox[{"Position", "[", 
       RowBox[{"testFitnessRange", ",", 
        RowBox[{"Min", "@", "testFitnessRange"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"testOptimalAngles", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"testAngleRange", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
        RowBox[{"First", "/@", "testOptimalInstances"}]}], "//", "N"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"testOptimalWidths", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"testWidthRange", "[", 
         RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
       RowBox[{"Last", "/@", "testOptimalInstances"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"optimalWidth", ",", "optimalAngle"}], "}"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{"testOptimalWidths", ",", "testOptimalAngles"}], "}"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"optimalWidth", ",", "optimalAngle"}], "}"}], "//", "Print"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"optimalRotationMatrix", "=", 
      RowBox[{"RotationMatrix", "@", "optimalAngle"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"optimalRotatedData", "=", 
      RowBox[{"translatedData", ".", "optimalRotationMatrix"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sampleData", "=", "optimalRotatedData"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"testFitnessFunction", "=", 
      RowBox[{"fitnessFunctionNearestNeigbor", "[", "\[IndentingNewLine]", 
       RowBox[{
       "sampleData", ",", "zeroX", ",", "zeroY", ",", "optimalWidth"}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"testPenaltyFunction", "=", 
      RowBox[{"penaltyFunctionSignY", "@", "sampleData"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fontSize", "=", "16"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"plotFitResult", "=", 
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Plot", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"trackTheoryFunction", "[", 
               RowBox[{"x", ",", "zeroX", ",", "zeroY", ",", 
                RowBox[{"2", "*", "#"}]}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{
                 RowBox[{"-", "#"}], "+", "zeroX"}], ",", 
                RowBox[{"#", "+", "zeroX"}]}], "}"}], ",", 
              RowBox[{"PlotRange", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"All", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"1.1", "*", 
                    RowBox[{"Min", "@", 
                    RowBox[{"Last", "@", 
                    RowBox[{"Transpose", "@", "optimalRotatedData"}]}]}]}], 
                   ",", 
                   RowBox[{"5", "+", 
                    RowBox[{"Abs", "[", 
                    RowBox[{"2", "*", "zeroY"}], "]"}]}]}], "}"}]}], "}"}]}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"PlotPoints", "\[Rule]", 
               RowBox[{"3", "*", 
                RowBox[{"10", "^", "4"}]}]}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"Directive", "[", 
                RowBox[{"Red", ",", "Dashed", ",", "Thick"}], "]"}]}]}], 
             "\[IndentingNewLine]", "]"}], "&"}], "@", "optimalWidth"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"ListLinePlot", "[", 
             RowBox[{"#", ",", 
              RowBox[{"PlotStyle", "\[Rule]", "Gray"}]}], "]"}], "&"}], "@", 
           "sampleData"}]}], "\[IndentingNewLine]", "}"}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"getLatexStyling", "/@", 
          RowBox[{"{", 
           RowBox[{"\"\<x,~\\\\mu m\>\"", ",", "\"\<y,~\\\\mu m\>\""}], 
           "}"}]}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Black", ",", "Bold", ",", "fontSize"}], "}"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"plotFitResult", "//", "Print"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"TableForm", "[", 
        RowBox[{
         RowBox[{"N", "@", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"testFitnessFunction", "//", "ScientificForm"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"testPenaltyFunction", "//", "ScientificForm"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"penaltyWeight", "*", "testPenaltyFunction"}], "+", 
              "testFitnessFunction"}], "//", "ScientificForm"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"uturnWidthMicrometers", "=", 
             RowBox[{
              RowBox[{"optimalWidth", "*", "pixelSizeMicroMeters"}], "//", 
              "N"}]}]}], "\[IndentingNewLine]", "}"}]}], ",", 
         RowBox[{"TableHeadings", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"fitnessLabels", ",", "None"}], "}"}]}]}], 
        "\[IndentingNewLine]", "]"}], "//", "TraditionalForm"}], "//", 
      RowBox[{
       RowBox[{"Rasterize", "[", 
        RowBox[{"#", ",", 
         RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "500"}]}], "]"}], "&"}]}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.940075685152706*^9, 3.9400756941397743`*^9}, {
  3.9400757633983917`*^9, 3.940076136003603*^9}, {3.9400761933378124`*^9, 
  3.9400761936688232`*^9}, {3.9400762351135645`*^9, 3.9400762670884914`*^9}, {
  3.9400786813895764`*^9, 3.940078727828797*^9}},
 CellLabel->
  "In[268]:=",ExpressionUUID->"dcdcd476-9edd-49b3-9138-174f6404a5c9"]
}, Closed]],

Cell[CellGroupData[{

Cell["[[ Preview Optimized L Values & Shape Functions ]]", "Subsubsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852842898235`*^9}, {3.917385345743088*^9, 3.9173853474802213`*^9}, {
   3.9174462057146387`*^9, 3.917446276705615*^9}, {3.928750055957734*^9, 
   3.928750123606418*^9}, {3.940072296732396*^9, 3.9400722974054394`*^9}, {
   3.940076155278675*^9, 
   3.9400761705527935`*^9}},ExpressionUUID->"3ce919ce-608e-440c-9dfd-\
40d5fd859ce3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"uturnsClean", "//", 
   RowBox[{
    RowBox[{"ListLinePlot", "[", 
     RowBox[{"#", ",", 
      RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}], "&"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"uturnsClean", "[", 
     RowBox[{"[", "k", "]"}], "]"}], "//", 
    RowBox[{
     RowBox[{"ListLinePlot", "[", 
      RowBox[{"#", ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}], "&"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "@", "uturnsClean"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.9400763197980533`*^9, 3.9400763822952566`*^9}, {
  3.940150033116282*^9, 3.940150035655723*^9}},
 CellLabel->
  "In[269]:=",ExpressionUUID->"6ab41b48-f7db-4933-a787-882db29aa555"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"checkID", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"optimizationTestModule", "@", 
  RowBox[{"uturnsClean", "[", 
   RowBox[{"[", "checkID", "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.9400762092540665`*^9, 3.9400762224726176`*^9}, {
   3.9400765593285117`*^9, 3.940076606038879*^9}, 3.9403110773373055`*^9, 
   3.940312155243455*^9, {3.9403124374059854`*^9, 3.9403124384486275`*^9}, {
   3.940506175017274*^9, 3.9405061888011203`*^9}},
 CellLabel->
  "In[271]:=",ExpressionUUID->"b7f27454-9fec-49eb-9157-5328328e41ff"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"exportImagesTwoFormat", "[", 
    RowBox[{
    "plotFitResult", ",", "\"\<U_turn_fit_result_example\>\"", ",", "100"}], 
    "]"}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.917730837874729*^9, 3.9177308423873143`*^9}, {
   3.917730901777834*^9, 3.917730930112277*^9}, 3.9288094949561825`*^9},
 CellLabel->
  "In[209]:=",ExpressionUUID->"6e3e16d2-4ffb-44df-837b-987bf7bd38a3"]
}, Closed]],

Cell[CellGroupData[{

Cell["Run Optimization", "Subsubsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852842898235`*^9}, {3.917385345743088*^9, 3.9173853474802213`*^9}, {
   3.9174462057146387`*^9, 3.917446276705615*^9}, {3.928750055957734*^9, 
   3.928750123606418*^9}, {3.940072296732396*^9, 3.9400722974054394`*^9}, {
   3.940076155278675*^9, 3.9400761705527935`*^9}, {3.9400780759444604`*^9, 
   3.940078080583084*^9}},ExpressionUUID->"342de1cf-a128-46be-a0ba-\
4d1e1b706c6d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uturnShapeFitData", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"monitorCounter", "++"}], ";", 
          RowBox[{"getUturnShapeFit", "@", "#"}]}], ")"}], "&"}], "/@", 
       "uturnsClean"}]}], ";"}], ",", "\[IndentingNewLine]", 
    RowBox[{"progress", "[", 
     RowBox[{"monitorCounter", ",", 
      RowBox[{"Length", "@", "uturnsClean"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.940079466653104*^9, 3.9400795746558332`*^9}, {
   3.9400796210649567`*^9, 3.9400796406641564`*^9}, {3.94007972028446*^9, 
   3.9400797554653063`*^9}, 3.940079894057228*^9},
 CellLabel->
  "In[273]:=",ExpressionUUID->"4e16c39c-bdd8-4743-a5a1-a4cf6968f55e"]
}, Closed]],

Cell[CellGroupData[{

Cell["<< Export U-turn Fit Data >>", "Subsubsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852842898235`*^9}, {3.917385345743088*^9, 3.9173853474802213`*^9}, {
   3.9174462057146387`*^9, 3.917446276705615*^9}, {3.928750055957734*^9, 
   3.928750123606418*^9}, {3.940072296732396*^9, 3.9400722974054394`*^9}, {
   3.940076155278675*^9, 3.9400761705527935`*^9}, {3.9400780759444604`*^9, 
   3.940078080583084*^9}, {3.940083646268532*^9, 
   3.940083656122978*^9}},ExpressionUUID->"6d27c093-9a21-4667-bea6-\
1732ccbccb81"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "fileFolder", "<>", "$PathnameSeparator", "<>", 
     "\"\<U-turn Fit Data Unified.txt\>\""}], ",", "\[IndentingNewLine]", 
    RowBox[{"Compress", "@", "uturnShapeFitData"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.940079975075952*^9, 3.940080026337555*^9}, {
  3.9400835552555246`*^9, 3.940083563182511*^9}, {3.9400835986371517`*^9, 
  3.940083631292641*^9}, {3.9400836872565866`*^9, 3.9400836875811577`*^9}},
 CellLabel->
  "In[484]:=",ExpressionUUID->"d96fe2b2-316b-442c-9546-7f933ae19e32"]
}, Closed]],

Cell[CellGroupData[{

Cell[">> Import U-turn Fit Data <<", "Subsubsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852842898235`*^9}, {3.917385345743088*^9, 3.9173853474802213`*^9}, {
   3.9174462057146387`*^9, 3.917446276705615*^9}, {3.928750055957734*^9, 
   3.928750123606418*^9}, {3.940072296732396*^9, 3.9400722974054394`*^9}, {
   3.940076155278675*^9, 3.9400761705527935`*^9}, {3.9400780759444604`*^9, 
   3.940078080583084*^9}, {3.940083646268532*^9, 
   3.9400836679951687`*^9}},ExpressionUUID->"e0e1a717-1422-4786-9e37-\
d0726f304eed"],

Cell[BoxData[
 RowBox[{
  RowBox[{"uturnShapeFitData", "=", 
   RowBox[{"Uncompress", "@", 
    RowBox[{"Import", "[", "\[IndentingNewLine]", 
     RowBox[{
     "fileFolder", "<>", "$PathnameSeparator", "<>", 
      "\"\<U-turn Fit Data Unified.txt\>\""}], "\[IndentingNewLine]", 
     "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.940083672106782*^9, 3.9400836847969847`*^9}},
 CellLabel->
  "In[598]:=",ExpressionUUID->"12106f5d-178c-4a0e-a184-e73a3147a21b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["[[ Preview U-turn Fit Results ]]", "Subsubsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852842898235`*^9}, {3.917385345743088*^9, 3.9173853474802213`*^9}, {
   3.9174462057146387`*^9, 3.917446276705615*^9}, {3.940072906684471*^9, 
   3.940072915843356*^9}, {3.940083814371114*^9, 
   3.94008382169104*^9}},ExpressionUUID->"a17d8d31-1bcb-4f51-838a-\
6867599c1c36"],

Cell["\<\
Data structure:

getUturnShapeFit : uturn -> {
  uturnWidthMicrometers,
  fitnessFunctionCombined,
  penaltyFunction,
  fitnessFunction,
  inputUturn (before rotation optimization),
  optimalRotatedData,
  optimalWidth
  }\
\>", "Abstract",
 CellChangeTimes->{{3.9400837100346518`*^9, 3.9400837464906235`*^9}, {
  3.9401701114415283`*^9, 
  3.94017013198514*^9}},ExpressionUUID->"20a2bebf-27ca-4915-856f-\
b766c17d2488"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"#", "[", 
     RowBox[{"[", 
      RowBox[{"-", "2"}], "]"}], "]"}], "&"}], "@", 
   RowBox[{"Transpose", "@", "uturnShapeFitData"}]}], "//", 
  RowBox[{
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"#", ",", 
     RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}], "&"}]}]], "Input",
 CellLabel->
  "In[275]:=",ExpressionUUID->"724a29d8-c8b7-4ede-be14-13a484e8f452"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Histogram", "[", 
      RowBox[{"#", ",", "histogramBinningMethod"}], "]"}], "&"}], "/@", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", 
         RowBox[{"2", ";;", "3"}], "]"}], "]"}], "&"}], "@", 
      RowBox[{"Transpose", "@", "uturnShapeFitData"}]}], 
     "\[IndentingNewLine]", ")"}]}], "//", 
   RowBox[{
    RowBox[{"ImageCollage", "[", 
     RowBox[{"#", ",", 
      RowBox[{"ImageSize", "\[Rule]", "Full"}], ",", 
      RowBox[{"Background", "\[Rule]", "None"}], ",", 
      RowBox[{"ImagePadding", "\[Rule]", "5"}]}], "]"}], "&"}]}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Histogram", "[", 
      RowBox[{"#", ",", "histogramBinningMethod", ",", 
       RowBox[{"ScalingFunctions", "\[Rule]", "\"\<Log10\>\""}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "/@", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", 
         RowBox[{"2", ";;", "3"}], "]"}], "]"}], "&"}], "@", 
      RowBox[{"Transpose", "@", "uturnShapeFitData"}]}], 
     "\[IndentingNewLine]", ")"}]}], "//", 
   RowBox[{
    RowBox[{"ImageCollage", "[", 
     RowBox[{"#", ",", 
      RowBox[{"ImageSize", "\[Rule]", "Full"}], ",", 
      RowBox[{"Background", "\[Rule]", "None"}], ",", 
      RowBox[{"ImagePadding", "\[Rule]", "5"}]}], "]"}], "&"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"First", "@", 
   RowBox[{"Transpose", "@", "uturnShapeFitData"}]}], "//", 
  RowBox[{
   RowBox[{"Histogram", "[", "\[IndentingNewLine]", 
    RowBox[{"#", ",", "histogramBinningMethod", ",", 
     RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]", "]"}], 
   "&"}]}]}], "Input",
 CellChangeTimes->{{3.94015191222058*^9, 3.9401519401657248`*^9}, {
  3.940153221871914*^9, 3.9401532325743694`*^9}},
 CellLabel->
  "In[276]:=",ExpressionUUID->"342385db-c2e4-4737-9394-da55c8f58972"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"testThresholdYsign", "=", 
    RowBox[{"1", "*", 
     RowBox[{"10", "^", 
      RowBox[{"-", "5"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testSelection", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", 
          RowBox[{"-", "2"}], "]"}], "]"}], "&"}], "@", 
       RowBox[{"Transpose", "@", 
        RowBox[{"Select", "[", "\[IndentingNewLine]", 
         RowBox[{"#", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ">", "testThresholdYsign"}], 
           "&"}]}], "\[IndentingNewLine]", "]"}]}]}], "&"}], "@", 
     "uturnShapeFitData"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testSelection", "//", 
   RowBox[{
    RowBox[{"ListLinePlot", "[", 
     RowBox[{"#", ",", 
      RowBox[{"Mesh", "\[Rule]", "None"}]}], "]"}], "&"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ListLinePlot", "@", 
     RowBox[{"testSelection", "[", 
      RowBox[{"[", "k", "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "1", ",", 
      RowBox[{"Length", "@", "testSelection"}], ",", "1"}], "}"}]}], 
   "\[IndentingNewLine]", "]"}], "//", "Quiet"}]}], "Input",
 CellChangeTimes->{{3.9401520536292477`*^9, 3.940152134444403*^9}, {
   3.940152208373747*^9, 3.94015224751698*^9}, {3.9401522822778583`*^9, 
   3.940152301379424*^9}, {3.9401523366714773`*^9, 3.9401525003499165`*^9}, {
   3.940152603799525*^9, 3.9401526298058863`*^9}, {3.940152660999183*^9, 
   3.9401527198151293`*^9}, 3.94015286627859*^9, {3.9401529394942904`*^9, 
   3.9401529398135324`*^9}, {3.940152994710641*^9, 3.9401530239740105`*^9}, {
   3.94015307110225*^9, 3.940153082534336*^9}, {3.940153478304367*^9, 
   3.9401535607830544`*^9}},
 CellLabel->
  "In[279]:=",ExpressionUUID->"68bdf351-b33d-4d1b-9f80-e5b57d7387b1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"testThresholdFitness", "=", "0.01"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testSelectionFitness", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", 
          RowBox[{"-", "2"}], "]"}], "]"}], "&"}], "@", 
       RowBox[{"Transpose", "@", 
        RowBox[{"Select", "[", "\[IndentingNewLine]", 
         RowBox[{"#", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ">", "testThresholdFitness"}], 
           "&"}]}], "\[IndentingNewLine]", "]"}]}]}], "&"}], "@", 
     "uturnShapeFitData"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testSelectionFitness", "//", 
   RowBox[{
    RowBox[{"ListLinePlot", "[", 
     RowBox[{"#", ",", 
      RowBox[{"Mesh", "\[Rule]", "None"}]}], "]"}], "&"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ListLinePlot", "@", 
     RowBox[{"testSelectionFitness", "[", 
      RowBox[{"[", "k", "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "1", ",", 
      RowBox[{"Length", "@", "testSelectionFitness"}], ",", "1"}], "}"}]}], 
   "\[IndentingNewLine]", "]"}], "//", "Quiet"}]}], "Input",
 CellChangeTimes->{{3.9401520536292477`*^9, 3.940152134444403*^9}, {
   3.940152208373747*^9, 3.94015224751698*^9}, {3.9401522822778583`*^9, 
   3.940152301379424*^9}, {3.9401523366714773`*^9, 3.9401525003499165`*^9}, {
   3.940152603799525*^9, 3.9401526298058863`*^9}, {3.940152660999183*^9, 
   3.9401527198151293`*^9}, 3.94015286627859*^9, {3.9401529394942904`*^9, 
   3.9401529398135324`*^9}, {3.940152994710641*^9, 3.9401530239740105`*^9}, {
   3.94015307110225*^9, 3.940153082534336*^9}, {3.940153478304367*^9, 
   3.9401535607830544`*^9}, {3.9401538404480157`*^9, 3.940153875287112*^9}, 
   3.940153979032916*^9, {3.940154087168398*^9, 3.9401541097443852`*^9}, {
   3.940154728418132*^9, 3.9401547288161907`*^9}, {3.940154809112398*^9, 
   3.940154809287874*^9}},
 CellLabel->
  "In[283]:=",ExpressionUUID->"da5a20bf-90fc-4300-8b8e-c3e311a59048"]
}, Closed]],

Cell[CellGroupData[{

Cell["Threshold the L Value Data by Total Fitness & Penalty", "Subsubsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852842898235`*^9}, {3.917385345743088*^9, 3.9173853474802213`*^9}, {
   3.9174462057146387`*^9, 3.917446276705615*^9}, {3.940072906684471*^9, 
   3.940072915843356*^9}, {3.940083814371114*^9, 3.94008382169104*^9}, {
   3.940155017783043*^9, 
   3.9401550450972347`*^9}},ExpressionUUID->"37a1f0e8-8858-467d-a298-\
15b3f080b2cd"],

Cell["\<\
Defaults :
   
penaltyFunctionThreshold=1*10^-5;
totalFitnessFunctionThreshold=1*10^-2;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.890210387568242*^9, {3.8907334164048786`*^9, 3.8907334344441056`*^9}, 
   3.9157368454102073`*^9, 3.91573884230005*^9, {3.9170181261303744`*^9, 
   3.91701812778405*^9}, {3.917374947355131*^9, 3.9173749593748264`*^9}, {
   3.917375407792037*^9, 3.917375408800247*^9}, {3.9287561533860874`*^9, 
   3.9287561587200356`*^9}, {3.928807429163335*^9, 3.9288074490169783`*^9}, {
   3.9400755708794165`*^9, 3.940075597509433*^9}, {3.9400756418134203`*^9, 
   3.9400756425712814`*^9}, 3.9400766312321825`*^9, 3.9401551052566795`*^9},
 FontSize->16,ExpressionUUID->"9b90dcd5-9af4-4589-a776-f63c3d686ce6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"penaltyFunctionThreshold", "=", 
   RowBox[{"1", "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "5"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"totalFitnessFunctionThreshold", "=", 
   RowBox[{"1", "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "2"}]}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.940153148448674*^9, 3.940153176437272*^9}, {
  3.9401534478459907`*^9, 3.9401534581343713`*^9}, {3.9401548214875526`*^9, 
  3.940154824439636*^9}, {3.940155101272377*^9, 3.9401551016152983`*^9}},
 CellLabel->
  "In[287]:=",ExpressionUUID->"53873217-3dc6-4822-a1cc-75f3c2a5ecda"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"uturnShapeFitDataClean", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Select", "[", "\[IndentingNewLine]", 
       RowBox[{"#", ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "<", 
           "totalFitnessFunctionThreshold"}], "&&", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "<", 
           "penaltyFunctionThreshold"}]}], "&"}]}], "\[IndentingNewLine]", 
       "]"}], "&"}], "@", "uturnShapeFitData"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uturnShapeFitDataClean", "//", "Length"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", 
       RowBox[{"-", "2"}], "]"}], "]"}], "&"}], "@", 
    RowBox[{"Transpose", "@", "uturnShapeFitDataClean"}]}], "//", 
   RowBox[{
    RowBox[{"ListLinePlot", "[", 
     RowBox[{"#", ",", 
      RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}], "&"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"First", "@", 
   RowBox[{"Transpose", "@", "uturnShapeFitDataClean"}]}], "//", 
  RowBox[{
   RowBox[{"Histogram", "[", "\[IndentingNewLine]", 
    RowBox[{"#", ",", "histogramBinningMethod", ",", 
     RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]", "]"}], 
   "&"}]}]}], "Input",
 CellChangeTimes->{{3.940155229720209*^9, 3.940155280233739*^9}, 
   3.9401553362557144`*^9, {3.9401553725208836`*^9, 3.9401553877934775`*^9}, {
   3.9401554279199033`*^9, 3.940155451373763*^9}, {3.9401556156744566`*^9, 
   3.9401556241170893`*^9}},
 CellLabel->
  "In[289]:=",ExpressionUUID->"af5fd58e-0814-4f56-81de-a10161e5790f"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute Magnetic Moment", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852842898235`*^9}, {3.917385345743088*^9, 3.9173853474802213`*^9}, {
   3.9174462057146387`*^9, 3.917446276705615*^9}, {3.928750150697092*^9, 
   3.9287501543542643`*^9}},ExpressionUUID->"5a8f0c2a-b04d-4a58-8673-\
051e3cd51770"],

Cell[CellGroupData[{

Cell["Match Timestamp & Radii Data to U-turns with L Values", "Subsubsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852842898235`*^9}, {3.917385345743088*^9, 3.9173853474802213`*^9}, {
   3.9174462057146387`*^9, 3.917446276705615*^9}, {3.928750055957734*^9, 
   3.9287500985145893`*^9}, {3.9287501310652156`*^9, 3.928750133465344*^9}, {
   3.928750231365877*^9, 3.9287502502547045`*^9}, {3.940155501144105*^9, 
   3.9401555118873005`*^9}, {3.940155791567976*^9, 
   3.9401557991197824`*^9}},ExpressionUUID->"6db8b855-91bb-41c0-b29f-\
0939c1302f8d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fitDataInitialUturns", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", "5", "]"}], "]"}], "&"}], "@", 
    RowBox[{"Transpose", "@", "uturnShapeFitDataClean"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"initialUturnsAll", "=", 
    RowBox[{"getTrackCoordinates", "/@", "uturnDataTranslated"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"initialUturnsAll", "//", 
     RowBox[{
      RowBox[{"ListLinePlot", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"fitDataInitialUturns", "//", 
     RowBox[{
      RowBox[{"ListLinePlot", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Mesh", "\[Rule]", "None"}]}], "]"}], "&"}]}]}], 
   "\[IndentingNewLine]", "}"}], "//", 
  RowBox[{
   RowBox[{"ImageCollage", "[", 
    RowBox[{"#", ",", 
     RowBox[{"ImageSize", "\[Rule]", "Full"}], ",", 
     RowBox[{"Background", "\[Rule]", "None"}], ",", 
     RowBox[{"ImagePadding", "\[Rule]", "5"}]}], "]"}], "&"}]}]}], "Input",
 CellChangeTimes->{{3.9401701818337784`*^9, 3.9401702127298603`*^9}, {
  3.940170255596219*^9, 3.9401704830985174`*^9}, {3.940171517614573*^9, 
  3.9401715236694365`*^9}, {3.940172476852042*^9, 3.940172528699439*^9}, {
  3.9402288756239395`*^9, 3.940228881816997*^9}},
 CellLabel->
  "In[293]:=",ExpressionUUID->"49b736a0-3641-42db-adc3-7c9ad2eb4ce1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uturnDataClean", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"uturnDataTranslated", "[", 
        RowBox[{"[", "#", "]"}], "]"}], "&"}], "@", 
      RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"initialUturnsAll", ",", "#"}], "]"}], "&"}], "/@", 
        "fitDataInitialUturns"}], "\[IndentingNewLine]", "]"}]}]}], ";"}], "//",
    "AbsoluteTiming"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uturnTimeStamps", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"First", "@", 
      RowBox[{"Transpose", "@", "#"}]}], "&"}], "/@", "uturnDataClean"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uturnRadii", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Last", "@", 
      RowBox[{"Transpose", "@", "#"}]}], "&"}], "/@", "uturnDataClean"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uturnWidthsMicrometers", "=", 
   RowBox[{"First", "@", 
    RowBox[{"Transpose", "@", "uturnShapeFitDataClean"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uturnsFinal", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", 
       RowBox[{"-", "2"}], "]"}], "]"}], "&"}], "/@", 
    "uturnShapeFitDataClean"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.940172225045227*^9, 3.9401723532522593`*^9}, {
   3.940172554613578*^9, 3.9401725565234203`*^9}, {3.940173159356021*^9, 
   3.9401731712833843`*^9}, {3.9401732020054493`*^9, 
   3.9401732022675543`*^9}, {3.940173822748551*^9, 3.940173822911149*^9}, 
   3.940225427775648*^9, 3.940228483203947*^9, 3.9402285637305903`*^9, 
   3.9402288894876533`*^9},
 CellLabel->
  "In[296]:=",ExpressionUUID->"7d2df90e-f7be-455d-a747-958b687a629c"]
}, Closed]],

Cell[CellGroupData[{

Cell["<< Export U-turn Shapes, Timestamps, Radii & L Values >>", \
"Subsubsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852842898235`*^9}, {3.917385345743088*^9, 3.9173853474802213`*^9}, {
   3.9174462057146387`*^9, 3.917446276705615*^9}, {3.928750055957734*^9, 
   3.9287500985145893`*^9}, {3.9287501310652156`*^9, 3.928750133465344*^9}, {
   3.928750231365877*^9, 3.9287502502547045`*^9}, {3.940155501144105*^9, 
   3.9401555118873005`*^9}, {3.940155791567976*^9, 3.9401557991197824`*^9}, {
   3.9401732255235233`*^9, 3.940173251835372*^9}, {3.9401737891715403`*^9, 
   3.9401737911641603`*^9}},ExpressionUUID->"f3a61191-9f52-4058-92b9-\
b629752e4cff"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{
     "fileFolder", "<>", "$PathnameSeparator", "<>", 
      "\"\<U-turns Final.txt\>\""}], ",", 
     RowBox[{"Compress", "@", "uturnsFinal"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "fileFolder", "<>", "$PathnameSeparator", "<>", 
     "\"\<U-turn Time Radii L-values.txt\>\""}], ",", "\[IndentingNewLine]", 
    RowBox[{"Compress", "@", 
     RowBox[{"{", 
      RowBox[{
      "uturnTimeStamps", ",", "uturnRadii", ",", "uturnWidthsMicrometers"}], 
      "}"}]}]}], "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9401738050115843`*^9, 3.940173807803929*^9}, {
  3.9401738521646905`*^9, 3.9401738675400743`*^9}},
 CellLabel->
  "In[486]:=",ExpressionUUID->"804334ba-52ac-49b3-8730-31e411808c79"]
}, Closed]],

Cell[CellGroupData[{

Cell[">> Import U-turn Shapes, Timestamps, Radii & L Values <<", \
"Subsubsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852842898235`*^9}, {3.917385345743088*^9, 3.9173853474802213`*^9}, {
   3.9174462057146387`*^9, 3.917446276705615*^9}, {3.928750055957734*^9, 
   3.9287500985145893`*^9}, {3.9287501310652156`*^9, 3.928750133465344*^9}, {
   3.928750231365877*^9, 3.9287502502547045`*^9}, {3.940155501144105*^9, 
   3.9401555118873005`*^9}, {3.940155791567976*^9, 3.9401557991197824`*^9}, {
   3.9401732553198905`*^9, 3.940173261595177*^9}, 
   3.940173923382888*^9},ExpressionUUID->"a9592315-d30d-4987-9aa6-\
3f3ac4f545dd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"uturnsFinal", "=", 
    RowBox[{"Uncompress", "@", 
     RowBox[{"Import", "[", 
      RowBox[{
      "fileFolder", "<>", "$PathnameSeparator", "<>", 
       "\"\<U-turns Final.txt\>\""}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "uturnTimeStamps", ",", "uturnRadii", ",", "uturnWidthsMicrometers"}], 
    "}"}], "=", 
   RowBox[{"Uncompress", "@", 
    RowBox[{"Import", "[", "\[IndentingNewLine]", 
     RowBox[{
     "fileFolder", "<>", "$PathnameSeparator", "<>", 
      "\"\<U-turn Time Radii L-values.txt\>\""}], "\[IndentingNewLine]", 
     "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9401733923556786`*^9, 3.940173405060215*^9}, {
  3.9401734476458282`*^9, 3.94017345313319*^9}, {3.9401738703811646`*^9, 
  3.9401739002279615`*^9}},
 CellLabel->
  "In[599]:=",ExpressionUUID->"fff78587-2041-4f32-8477-a3b1224f9dc2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Magnetic Field & Angular Drag Coefficient", "Subsubsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852842898235`*^9}, {3.917385345743088*^9, 3.9173853474802213`*^9}, {
   3.9174462057146387`*^9, 3.917446276705615*^9}, {3.928750055957734*^9, 
   3.9287500985145893`*^9}, {3.9287501310652156`*^9, 3.928750133465344*^9}, {
   3.928750231365877*^9, 
   3.9287502502547045`*^9}},ExpressionUUID->"57a6af00-8214-4595-8e13-\
bf53939a9b7d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"magneticMomentEquation", "[", 
   RowBox[{"\[Alpha]_", ",", "v_", ",", "H_", ",", "L_"}], "]"}], ":=", 
  RowBox[{"\[Pi]", "*", "\[Alpha]", "*", 
   RowBox[{
    RowBox[{"v", "/", "H"}], "/", "L"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"magneticMomentEquation", "[", 
    RowBox[{"\[Alpha]", ",", "v", ",", "H", ",", "L"}], "]"}], "//", 
   "TeXForm"}], "//", "getLatexStyling"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9287431322166176`*^9, 3.928743232333584*^9}},
 CellLabel->
  "In[301]:=",ExpressionUUID->"41178d9f-9207-484a-a380-11852398dc6f"],

Cell["\<\
MF parameters for COCCI:
   
viscosity=8.9*10^(-4);
miliTeslaPerAmpere=1.7;
fieldAmperes=0.15;
vacuumPermeability=4*\[Pi]*10^(-7);

fieldTesla=fieldAmperes*miliTeslaPerAmpere/1000\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.890210387568242*^9, {3.8907334164048786`*^9, 3.8907334344441056`*^9}, 
   3.9157368454102073`*^9, 3.91573884230005*^9, {3.9170181261303744`*^9, 
   3.91701812778405*^9}, {3.917374947355131*^9, 3.9173749593748264`*^9}, {
   3.917375407792037*^9, 3.917375408800247*^9}, {3.9287561533860874`*^9, 
   3.9287561587200356`*^9}, {3.928807429163335*^9, 3.9288074490169783`*^9}, {
   3.9400755708794165`*^9, 3.940075597509433*^9}, {3.9400756418134203`*^9, 
   3.9400756425712814`*^9}, 3.9400766312321825`*^9, 3.9401551052566795`*^9, {
   3.9401726667788258`*^9, 3.940172710725813*^9}},
 FontSize->16,ExpressionUUID->"19ff6f4e-cd66-4587-ae2f-7dcd509a9e38"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"miliTeslaPerAmpere", "=", "1.7"}], ";", "\[IndentingNewLine]", 
    RowBox[{"fieldAmperes", "=", "0.15"}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"viscosity", "=", 
     RowBox[{"8.9", "*", 
      RowBox[{"10", "^", 
       RowBox[{"(", 
        RowBox[{"-", "4"}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vacuumPermeability", "=", 
     RowBox[{"4", "*", "\[Pi]", "*", 
      RowBox[{"10", "^", 
       RowBox[{"(", 
        RowBox[{"-", "7"}], ")"}]}]}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.928744043689191*^9, {3.928744114847763*^9, 3.928744168417572*^9}, {
   3.9287442536710052`*^9, 3.928744253992269*^9}, {3.928744304804602*^9, 
   3.9287443177116575`*^9}, {3.928744878218734*^9, 3.9287448785297227`*^9}, 
   3.9287502140051527`*^9, {3.940172637300288*^9, 3.940172638867093*^9}, {
   3.940172721483693*^9, 3.940172728275417*^9}, {3.94017628879084*^9, 
   3.9401762890796504`*^9}},
 CellLabel->
  "In[303]:=",ExpressionUUID->"5e9e3057-d51d-4016-8729-cb3dc3bb321e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fieldTesla", "=", 
   RowBox[{"2", "/", "1000"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fieldIntensity", "=", 
    RowBox[{"fieldTesla", "/", "vacuumPermeability"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"bacteriaRadiiMicrometers", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"pixelSizeMicroMeters", "*", 
       RowBox[{"Around", "@@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Mean", "@", "#"}], ",", 
          RowBox[{"StandardDeviation", "@", "#"}]}], "}"}]}]}], "&"}], "/@", 
     "uturnRadii"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{"bacteriaRadiiMicrometers", "//", 
  RowBox[{
   RowBox[{"Histogram", "[", 
    RowBox[{"#", ",", "histogramBinningMethod", ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], 
   "&"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dragCoefficientsRotational", "=", 
   RowBox[{"8", "*", "\[Pi]", "*", "viscosity", "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"bacteriaRadiiMicrometers", "*", 
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{"-", "6"}], ")"}]}]}], ")"}], "^", "3"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.928743068362152*^9, 3.9287430722009087`*^9}, {
   3.928744158563193*^9, 3.928744158966607*^9}, {3.9287442610600133`*^9, 
   3.928744261733349*^9}, {3.928744348148548*^9, 3.928744376050117*^9}, 
   3.940012817348787*^9, {3.940172738907429*^9, 3.9401727608114257`*^9}, {
   3.940173484894232*^9, 3.940173486524864*^9}, {3.940173533771681*^9, 
   3.9401735525818977`*^9}, {3.9401762747903075`*^9, 
   3.9401762869817796`*^9}, {3.940176439207012*^9, 3.940176440689666*^9}},
 CellLabel->
  "In[305]:=",ExpressionUUID->"993e32a3-2493-40aa-bfac-614c30efc254"]
}, Closed]],

Cell[CellGroupData[{

Cell["U-turn Mean Velocity", "Subsubsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852842898235`*^9}, {3.917385345743088*^9, 3.9173853474802213`*^9}, {
   3.9174462057146387`*^9, 3.917446276705615*^9}, {3.928750055957734*^9, 
   3.9287500985145893`*^9}, {3.9287501310652156`*^9, 3.928750133465344*^9}, {
   3.928750231365877*^9, 
   3.9287502669894705`*^9}},ExpressionUUID->"fd66c98c-2c9a-4923-8504-\
223b0034ece7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"uturnDisplacements", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Norm", "/@", 
       RowBox[{"Differences", "@", "#"}]}], ")"}], "&"}], "/@", 
    "uturnsFinal"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uturnTimeDifferences", "=", 
    RowBox[{"Differences", "/@", "uturnTimeStamps"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"uturnVelocityMetersPerSecond", "=", 
   RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"pixelSizeMicroMeters", "/", 
          RowBox[{"10", "^", "6"}]}], "/", "frameDurationSeconds"}], ")"}], 
       "*", 
       RowBox[{"(", 
        RowBox[{"#1", "/", "#2"}], ")"}]}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"uturnDisplacements", ",", "uturnTimeDifferences"}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.940173606911726*^9, 3.940173614331971*^9}, {
  3.9401739320443473`*^9, 3.9401740383096285`*^9}, {3.940174130870553*^9, 
  3.940174132691925*^9}},
 CellLabel->
  "In[310]:=",ExpressionUUID->"bae152c9-a69b-4ac4-bd45-a3715a7b6ba9"],

Cell["\<\
Defaults :
   
velocityFilterScaleMedian=1;
velocityFilterScaleMean=1;
smoothingWindowSizeUturn=0.25;
velocityMeasurementCurvatureThreshold=0.25;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.890210387568242*^9, {3.8907334164048786`*^9, 3.8907334344441056`*^9}, 
   3.9157368454102073`*^9, 3.91573884230005*^9, {3.9170181261303744`*^9, 
   3.91701812778405*^9}, {3.917374947355131*^9, 3.9173749593748264`*^9}, {
   3.917375407792037*^9, 3.917375408800247*^9}, {3.9287560975497837`*^9, 
   3.928756105537388*^9}, 3.9287569377338142`*^9, {3.928810896783847*^9, 
   3.928810898946413*^9}, {3.940176886662093*^9, 3.9401769016860037`*^9}, {
   3.940176945390079*^9, 3.9401769455735893`*^9}, {3.9401785531695614`*^9, 
   3.940178560272842*^9}},
 FontSize->16,ExpressionUUID->"53159f15-7325-4753-bec4-a40752f4ba5d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"velocityFilterScaleMedian", "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"velocityFilterScaleMean", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"smoothingWindowSizeUturn", "=", "0.25"}], ";", 
  RowBox[{"velocityMeasurementCurvatureThreshold", "=", "0.25"}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.928746562634351*^9, 3.9287465867181287`*^9}, {
   3.9287493596822834`*^9, 3.9287493600618114`*^9}, {3.928756920512779*^9, 
   3.9287569215736837`*^9}, 3.928808913016641*^9, {3.928809139896825*^9, 
   3.9288091401042023`*^9}, {3.9288106408995805`*^9, 
   3.9288106474148703`*^9}, {3.9288108846279078`*^9, 
   3.9288108916625843`*^9}, {3.928815798670453*^9, 3.9288157987557416`*^9}, 
   3.9288158350392694`*^9, {3.9288186703156013`*^9, 3.928818675458256*^9}, {
   3.9288193810289245`*^9, 3.9288194065570545`*^9}, 3.928826653311365*^9, 
   3.92882671492411*^9, 3.9288269368419495`*^9, {3.92882996596735*^9, 
   3.9288299678069005`*^9}, {3.9288302913900356`*^9, 
   3.9288303008984456`*^9}, {3.9288306471319036`*^9, 3.928830673081399*^9}, {
   3.9288349587440166`*^9, 3.928834963575126*^9}, {3.9401743456933217`*^9, 
   3.940174352356884*^9}, {3.9401743939970846`*^9, 3.940174402613077*^9}, {
   3.940176906290825*^9, 3.9401769218890543`*^9}, {3.9401785375200143`*^9, 
   3.9401785498556547`*^9}, 3.940308854838971*^9, {3.9403089325994406`*^9, 
   3.9403089382302103`*^9}, {3.9405098183305526`*^9, 3.9405098193054867`*^9}, 
   3.940509897050271*^9},
 CellLabel->
  "In[313]:=",ExpressionUUID->"288af667-34bc-48cd-aba3-6237fffe9848"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"testID", "=", "3"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"colorPalette", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"\"\<RedBlueTones\>\"", ",", "\"\<Reverse\>\""}], "}"}], "}"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dotSize", "=", "0.025"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"limitingIndex", "=", 
   RowBox[{"-", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testUturnVel", "=", 
    RowBox[{"uturnsFinal", "[", 
     RowBox[{"[", "testID", "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testUturnVelocityFiltered", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"MeanFilter", "[", 
         RowBox[{"#", ",", "velocityFilterScaleMean"}], "]"}], "&"}], "@", 
       RowBox[{"MedianFilter", "[", 
        RowBox[{"#", ",", "velocityFilterScaleMedian"}], "]"}]}], "&"}], "@", 
     RowBox[{"uturnVelocityMetersPerSecond", "[", 
      RowBox[{"[", "testID", "]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"colorGrading", "=", 
   RowBox[{"Rescale", "@", "testUturnVelocityFiltered"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dotColors", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ColorData", "@", 
           RowBox[{"colorPalette", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "[", "#", "]"}], "&"}], "/@",
        "#"}], "&"}], "@", "colorGrading"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dotsGotStyle", "=", 
    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"#1", ",", "#2", ",", 
         RowBox[{"PointSize", "@", "dotSize"}]}], "]"}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"testUturnVel", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "limitingIndex"}], "]"}], "]"}], ",", 
        "dotColors"}], "}"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testUturnCurvatureProfile", "=", 
    RowBox[{"Rescale", "@", 
     RowBox[{"Abs", "@", 
      RowBox[{"getCurvatureProfile", "[", "\[IndentingNewLine]", 
       RowBox[{"testUturnVel", ",", "smoothingWindowSizeUturn"}], 
       "\[IndentingNewLine]", "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testVelocityMeasurementIndices", "=", 
    RowBox[{"Flatten", "@", 
     RowBox[{"Position", "[", "\[IndentingNewLine]", 
      RowBox[{"testUturnCurvatureProfile", ",", 
       RowBox[{"_", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"#", ">", "velocityMeasurementCurvatureThreshold"}], "&"}], 
         ")"}]}]}], "\[IndentingNewLine]", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ListLinePlot", "[", 
     RowBox[{"#", ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "@", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"uturnVelocityMetersPerSecond", "[", 
      RowBox[{"[", "testID", "]"}], "]"}], ",", "testUturnVelocityFiltered"}],
     "}"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ListLinePlot", "[", 
     RowBox[{"#", ",", 
      RowBox[{"PlotStyle", "\[Rule]", "Gray"}]}], "]"}], "&"}], "@", 
   "dotsGotStyle"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Show", "[", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"testUturnCurvatureProfile", "//", "ListLinePlot"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"ConstantArray", "[", 
          RowBox[{"#", ",", 
           RowBox[{"Length", "@", "testUturnCurvatureProfile"}]}], "]"}], 
         "&"}], "@", "velocityMeasurementCurvatureThreshold"}], ",", 
       RowBox[{"Mesh", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"{", 
          RowBox[{"Red", ",", "Thick", ",", "Dashed"}], "}"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}], 
   "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Around", "@@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Mean", "@", "#"}], ",", 
        RowBox[{"StandardDeviation", "@", "#"}]}], "}"}]}], "&"}], "@", 
    RowBox[{"testUturnVelocityFiltered", "[", 
     RowBox[{"[", "#", "]"}], "]"}]}], "&"}], "@", 
  "testVelocityMeasurementIndices"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.9399613256973343`*^9, 3.939961400880833*^9}, {
   3.9399615356196775`*^9, 3.939961612243009*^9}, {3.9399616596509333`*^9, 
   3.939961667511138*^9}, {3.9399617131421127`*^9, 3.939961761419031*^9}, {
   3.9399628736087146`*^9, 3.9399629074069786`*^9}, {3.9399719502640076`*^9, 
   3.939971956655987*^9}, {3.939972016630646*^9, 3.939972056109325*^9}, {
   3.9399721254791517`*^9, 3.939972209188609*^9}, {3.939972309193261*^9, 
   3.939972366156869*^9}, {3.9399727100140285`*^9, 3.939972710760316*^9}, {
   3.93997274580751*^9, 3.939972780262348*^9}, {3.9399728352948856`*^9, 
   3.9399728988390822`*^9}, 3.9399773891857*^9, {3.939978441570321*^9, 
   3.9399784745216875`*^9}, {3.9399785965696735`*^9, 
   3.9399790267303843`*^9}, {3.939979060283292*^9, 3.9399790612016797`*^9}, {
   3.939979092517418*^9, 3.939979132025433*^9}, {3.9399791698112144`*^9, 
   3.939979204601454*^9}, {3.939979250700565*^9, 3.9399792866656966`*^9}, {
   3.9399793178913207`*^9, 3.9399793603306403`*^9}, {3.939979683306926*^9, 
   3.9399796865665255`*^9}, {3.939979737702042*^9, 3.9399797502050686`*^9}, {
   3.939979995469081*^9, 3.9399800124431925`*^9}, {3.939980072118976*^9, 
   3.9399800925538197`*^9}, {3.939980135494196*^9, 3.939980137300462*^9}, {
   3.939980173051752*^9, 3.939980283039233*^9}, {3.939980339940259*^9, 
   3.9399803527073803`*^9}, {3.939981291073588*^9, 3.939981301100424*^9}, {
   3.939981406228774*^9, 3.939981418540986*^9}, {3.939981732415682*^9, 
   3.93998174286941*^9}, {3.9399821524220343`*^9, 3.939982232454856*^9}, {
   3.9400091735946517`*^9, 3.940009183225032*^9}, {3.940052369445591*^9, 
   3.9400523736081543`*^9}, {3.940176711214218*^9, 3.940176863606966*^9}, {
   3.9401769096782436`*^9, 3.9401769314250097`*^9}, {3.940176997179348*^9, 
   3.940177102536439*^9}, {3.940177136193425*^9, 3.9401771526559143`*^9}, 
   3.9401771948257275`*^9, 3.940177260792491*^9, {3.940177342152184*^9, 
   3.9401773460890565`*^9}, 3.94017743509634*^9, {3.940177472089404*^9, 
   3.9401775262005773`*^9}, {3.940177566608758*^9, 3.940177731822793*^9}, {
   3.9401778178012295`*^9, 3.9401778641286273`*^9}, {3.940177907456393*^9, 
   3.940177934431737*^9}, {3.940178062478715*^9, 3.940178159623962*^9}, {
   3.94017824604887*^9, 3.9401782502523303`*^9}, 3.940178585460672*^9, 
   3.9402286475220704`*^9, {3.9402540053704967`*^9, 3.940254019282959*^9}, {
   3.940255876923664*^9, 3.9402558822906904`*^9}, 3.940311366817809*^9, 
   3.940509836996607*^9, {3.940516469047409*^9, 3.940516511775896*^9}, {
   3.9405165518564653`*^9, 3.9405165710239434`*^9}},
 CellLabel->
  "In[467]:=",ExpressionUUID->"f2ab5609-5c53-4f66-8b95-6171b63e6080"],

Cell[BoxData[
 RowBox[{
  RowBox[{"uturnMeanVelocity", "=", 
   RowBox[{
    RowBox[{"Parallelize", "@", 
     RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Quiet", "@", 
         RowBox[{"getUturnMeanVelocity", "[", 
          RowBox[{"#1", ",", "#2"}], "]"}]}], "&"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"uturnsFinal", ",", "uturnVelocityMetersPerSecond"}], "}"}]}],
       "\[IndentingNewLine]", "]"}]}], "//", "Quiet"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.940178754982063*^9, 3.940178885991644*^9}, {
  3.94017896174304*^9, 3.9401791089622974`*^9}, {3.940179444272849*^9, 
  3.9401794490821085`*^9}},
 CellLabel->
  "In[331]:=",ExpressionUUID->"43811dda-514f-4981-b9ec-034fb5971da2"]
}, Closed]],

Cell[CellGroupData[{

Cell["Magnetic Moment", "Subsubsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852842898235`*^9}, {3.917385345743088*^9, 3.9173853474802213`*^9}, {
   3.9174462057146387`*^9, 3.917446276705615*^9}, {3.928750055957734*^9, 
   3.9287500985145893`*^9}, {3.9287501310652156`*^9, 3.928750133465344*^9}, {
   3.928750231365877*^9, 
   3.9287502790484867`*^9}},ExpressionUUID->"c4bf4a22-1fb3-4cd7-be28-\
c8cf21aed1d3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"magneticMomentEquation", "[", 
    RowBox[{"\[Alpha]", ",", "v", ",", "H", ",", "L"}], "]"}], "//", 
   "TeXForm"}], "//", "getLatexStyling"}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[602]:=",ExpressionUUID->"94a51ca0-1645-4cb5-b34f-0e443fb3c90d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"momentPlotScalingFactor", "=", 
    RowBox[{"10", "^", "16"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"frameLabelMomentHistogram", "=", 
   RowBox[{"getLatexStyling", "/@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<m,~ 10^{-\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"Log10", "@", "momentPlotScalingFactor"}], "]"}], "<>", 
       "\"\<}~ A \\\\cdot m^2\>\""}], ",", "\"\<N\>\""}], 
     "\[IndentingNewLine]", "}"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.940180630772488*^9, 3.9401806579602284`*^9}, {
   3.9402569549472485`*^9, 3.940256994380246*^9}, {3.94025707733963*^9, 
   3.9402571552019234`*^9}, 3.940263479759145*^9, 3.940311412001548*^9, 
   3.9405091001059923`*^9},
 CellLabel->
  "In[603]:=",ExpressionUUID->"5c4b2203-14f0-4922-97c3-b207025ad020"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"uturnDataMoment", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"#", ",", 
        RowBox[{
         RowBox[{"NumberQ", "@", 
          RowBox[{"Last", "@", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "&"}]}], "]"}], "&"}], "@", 
     RowBox[{"Select", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{
         "dragCoefficientsRotational", ",", "uturnMeanVelocity", ",", 
          "uturnWidthsMicrometers"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", 
          RowBox[{"First", "@", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "\[Equal]", "0"}], "&"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"magneticMoment", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"magneticMomentEquation", "[", 
       RowBox[{
        RowBox[{"First", "@", "#"}], ",", 
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", "fieldTesla", ",", 
        RowBox[{
         RowBox[{"Last", "@", "#"}], "/", 
         RowBox[{"10", "^", "6"}]}]}], "]"}], "&"}], "/@", 
     "uturnDataMoment"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"magneticMoment", "//", "Length"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{"plotMagneticMomentHistogram", "=", 
  RowBox[{"magneticMoment", "//", 
   RowBox[{
    RowBox[{"Histogram", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"#", "*", "momentPlotScalingFactor"}], ",", 
      "histogramBinningMethod", ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
      RowBox[{"FrameLabel", "\[Rule]", "frameLabelMomentHistogram"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", 
       RowBox[{"Scaled", "@", "1"}]}]}], "\[IndentingNewLine]", "]"}], 
    "&"}]}]}]}], "Input",
 CellChangeTimes->{{3.940179158128522*^9, 3.940179256896523*^9}, {
  3.9401793257881536`*^9, 3.9401793571400213`*^9}, {3.940179388458791*^9, 
  3.940179418679448*^9}, {3.9401794571457453`*^9, 3.940179472169236*^9}, {
  3.9401800154918013`*^9, 3.940180033608857*^9}, {3.9401804778046875`*^9, 
  3.940180492625392*^9}, {3.9401805268659554`*^9, 3.9401805888889165`*^9}, {
  3.9401806619990034`*^9, 3.940180670958691*^9}, {3.9402569602535954`*^9, 
  3.9402569619149313`*^9}, {3.9402634553115196`*^9, 3.940263459199648*^9}, {
  3.9403113989780755`*^9, 3.940311410729212*^9}},
 CellLabel->
  "In[605]:=",ExpressionUUID->"1157439b-0fe5-4392-a9a3-ea4c75eb86da"],

Cell[BoxData[
 RowBox[{"output", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"StringDelete", "[", 
     RowBox[{"#", ",", "\"\<Compressed Data\>\""}], "]"}], "&"}], "@", 
   "fileFolder"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9401808154639244`*^9, 3.940180867296712*^9}, {
  3.940180996276642*^9, 3.940181003722473*^9}, {3.94026336219965*^9, 
  3.9402633629164524`*^9}},
 CellLabel->
  "In[609]:=",ExpressionUUID->"f5c24aa4-e1c5-4d76-847b-57e23bb85bc2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"exportImagesTwoFormat", "[", "\[IndentingNewLine]", 
   RowBox[{
   "plotMagneticMomentHistogram", ",", "\"\<Magnetic_moment_histogram\>\"", 
    ",", "400"}], "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.915648115010803*^9, 3.9156481330422773`*^9}, 
   3.915708275405222*^9, {3.9157353754428544`*^9, 3.9157353759778137`*^9}, {
   3.91573687019776*^9, 3.9157368813252993`*^9}, {3.915737073877739*^9, 
   3.9157370748919*^9}, {3.915737115254693*^9, 3.915737116261586*^9}, 
   3.9164925678010235`*^9, {3.916492628624577*^9, 3.9164926432548285`*^9}, {
   3.916493721425295*^9, 3.916493723399071*^9}, 3.9173491447733283`*^9, 
   3.9173491823031673`*^9, {3.917351776998371*^9, 3.917351792633855*^9}, {
   3.94026321485338*^9, 3.9402632707172437`*^9}, 3.9402633965437264`*^9, {
   3.9402635172956576`*^9, 3.9402635277180324`*^9}},
 CellLabel->
  "In[610]:=",ExpressionUUID->"87c00d1d-4158-487e-a16a-a21a5dd47fd0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["<< Export Final Magnetic Moment & Radii Data >>", "Subsubsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852842898235`*^9}, {3.917385345743088*^9, 3.9173853474802213`*^9}, {
   3.9174462057146387`*^9, 3.917446276705615*^9}, {3.928750055957734*^9, 
   3.9287500985145893`*^9}, {3.9287501310652156`*^9, 3.928750133465344*^9}, {
   3.928750231365877*^9, 3.9287502790484867`*^9}, {3.9401809073606477`*^9, 
   3.94018093137879*^9}},ExpressionUUID->"ee572be8-8c03-4a09-907f-\
06003f363967"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "fileFolder", "<>", "$PathnameSeparator", "<>", 
     "\"\<MTB Moment Radii Data Final.txt\>\""}], ",", 
    RowBox[{"Compress", "@", 
     RowBox[{"{", 
      RowBox[{"bacteriaRadiiMicrometersClean", ",", "magneticMoment"}], 
      "}"}]}]}], "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.940182311239862*^9, 3.940182328417664*^9}, {
  3.9401823584654818`*^9, 3.940182423626892*^9}},
 CellLabel->
  "In[554]:=",ExpressionUUID->"91eea689-506b-41b5-875e-2f27d78a561a"]
}, Closed]],

Cell[CellGroupData[{

Cell[">> Import Final Magnetic Moment & Radii Data <<", "Subsubsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852842898235`*^9}, {3.917385345743088*^9, 3.9173853474802213`*^9}, {
   3.9174462057146387`*^9, 3.917446276705615*^9}, {3.928750055957734*^9, 
   3.9287500985145893`*^9}, {3.9287501310652156`*^9, 3.928750133465344*^9}, {
   3.928750231365877*^9, 3.9287502790484867`*^9}, {3.9401809073606477`*^9, 
   3.94018093137879*^9}, {3.940182417169337*^9, 
   3.9401824210929565`*^9}},ExpressionUUID->"d7bfcedc-43ef-4b44-844c-\
48683cb9456b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"bacteriaRadiiMicrometersClean", ",", "magneticMoment"}], "}"}], 
   "=", 
   RowBox[{"Uncompress", "@", 
    RowBox[{"Import", "[", "\[IndentingNewLine]", 
     RowBox[{
     "fileFolder", "<>", "$PathnameSeparator", "<>", 
      "\"\<MTB Moment Radii Data Final.txt\>\""}], "\[IndentingNewLine]", 
     "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.940182432915201*^9, 3.940182446510269*^9}},
 CellLabel->
  "In[601]:=",ExpressionUUID->"fdd4d390-d31c-4ed3-bcd8-d8fd8e99e010"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Magnetic Moment VS Radii", "Subsubsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 3.868722172427369*^9, {
   3.8905086678244915`*^9, 3.890508677778922*^9}, {3.9173852418883343`*^9, 
   3.9173852842898235`*^9}, {3.917385345743088*^9, 3.9173853474802213`*^9}, {
   3.9174462057146387`*^9, 3.917446276705615*^9}, {3.928750055957734*^9, 
   3.9287500985145893`*^9}, {3.9287501310652156`*^9, 3.928750133465344*^9}, {
   3.928750231365877*^9, 3.9287502790484867`*^9}, {3.9401809073606477`*^9, 
   3.94018093137879*^9}, {3.9402556905866284`*^9, 
   3.9402556963201213`*^9}},ExpressionUUID->"432b72e5-5852-41e2-b768-\
0e434b3e88ec"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"bacteriaRadiiMicrometersClean", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"First", "@", 
       RowBox[{"Transpose", "@", 
        RowBox[{"Select", "[", 
         RowBox[{"#", ",", 
          RowBox[{
           RowBox[{"NumberQ", "@", 
            RowBox[{"Last", "@", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "&"}]}], "]"}]}]}], "&"}], 
     "@", 
     RowBox[{"Select", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{"bacteriaRadiiMicrometers", ",", "uturnMeanVelocity"}], 
         "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", 
          RowBox[{"First", "@", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "\[Equal]", "0"}], "&"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bacteriaRadiiMicrometersFormatted", "=", 
    RowBox[{"Transpose", "@", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"bacteriaRadiiMicrometersClean", ",", 
       RowBox[{"momentPlotScalingFactor", "*", "magneticMoment"}]}], 
      "\[IndentingNewLine]", "}"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SortBy", "[", 
     RowBox[{"#", ",", "First"}], "]"}], "&"}], "@", 
   "bacteriaRadiiMicrometersFormatted"}], "//", 
  RowBox[{
   RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
    RowBox[{"#", ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", "\[IndentingNewLine]", 
     RowBox[{"IntervalMarkersStyle", "\[Rule]", 
      RowBox[{"Lighter", "@", "Gray"}]}], ",", 
     RowBox[{"IntervalMarkers", "\[Rule]", "\"\<Fences\>\""}]}], 
    "\[IndentingNewLine]", "]"}], "&"}]}]}], "Input",
 CellChangeTimes->{{3.940180178873721*^9, 3.940180235442382*^9}, {
  3.940180717269575*^9, 3.9401807195561943`*^9}, {3.9402557098193493`*^9, 
  3.9402557111129684`*^9}, {3.9402578986196976`*^9, 3.9402579162044744`*^9}, {
  3.9402622980867567`*^9, 3.9402623888152585`*^9}, {3.940263848120093*^9, 
  3.9402638511990156`*^9}},
 CellLabel->
  "In[611]:=",ExpressionUUID->"5d051d12-354d-4b05-a973-c88283477d86"],

Cell["\<\
Defaults :
   
envelopeQuantile={0.95};
envelopeAngularResolution=250;
envelopeSimplificationFactor=0.865;\
\>", "Abstract",
 CellChangeTimes->{{3.8336126894893217`*^9, 3.8336127027264314`*^9}, 
   3.8336129815881867`*^9, 3.847780280478504*^9, {3.8886956066872177`*^9, 
   3.888695615762748*^9}, 3.8890162665268717`*^9, 3.8890344344241023`*^9, {
   3.890210264738263*^9, 3.890210267809043*^9}, 3.8902103237896137`*^9, 
   3.890210387568242*^9, {3.8907334164048786`*^9, 3.8907334344441056`*^9}, 
   3.9157368454102073`*^9, 3.91573884230005*^9, {3.9170181261303744`*^9, 
   3.91701812778405*^9}, {3.917374947355131*^9, 3.9173749593748264`*^9}, {
   3.917375407792037*^9, 3.917375408800247*^9}, {3.9287560975497837`*^9, 
   3.928756105537388*^9}, 3.9287569377338142`*^9, {3.928810896783847*^9, 
   3.928810898946413*^9}, {3.940176886662093*^9, 3.9401769016860037`*^9}, {
   3.940176945390079*^9, 3.9401769455735893`*^9}, {3.9401785531695614`*^9, 
   3.940178560272842*^9}, 3.9402559083095083`*^9, 3.9405167407103677`*^9},
 FontSize->16,ExpressionUUID->"b4120ef9-a2f5-499e-aa5b-c4352410fd45"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"envelopeQuantile", "=", 
   RowBox[{"{", "0.95", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"envelopeAngularResolution", "=", "250"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"envelopeSimplificationFactor", "=", "0.865"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9402548133147583`*^9, 3.9402548256720276`*^9}, {
  3.9402549107715845`*^9, 3.9402549554727926`*^9}, {3.940255327232248*^9, 
  3.9402553295123243`*^9}, {3.940255412995533*^9, 3.9402554304047794`*^9}, {
  3.9402562079554014`*^9, 3.9402562431529264`*^9}, {3.9402640088976603`*^9, 
  3.940264150770298*^9}, {3.9402642130009303`*^9, 3.940264229694968*^9}, {
  3.940308897847696*^9, 3.9403089050873647`*^9}, {3.9403089751927533`*^9, 
  3.940309012711191*^9}, {3.9403100308325367`*^9, 3.9403100752089844`*^9}, {
  3.9403101426414022`*^9, 3.940310189271285*^9}, {3.940311436354038*^9, 
  3.9403114899997344`*^9}, {3.940509014410144*^9, 3.9405090531213017`*^9}, {
  3.940516727014866*^9, 3.9405167316231976`*^9}},
 CellLabel->
  "In[614]:=",ExpressionUUID->"aea4a4c2-a499-43a3-9594-5836922b88e9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bacteriaRadiiLimiters", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"First", "@", "#"}], "-", 
        RowBox[{"Last", "@", "#"}]}], ",", 
       RowBox[{
        RowBox[{"First", "@", "#"}], "+", 
        RowBox[{"Last", "@", "#"}]}]}], "}"}], "&"}], "/@", 
    "bacteriaRadiiMicrometersClean"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bacteriaMomentLimiters", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"momentPlotScalingFactor", "*", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"First", "@", "#"}], "-", 
          RowBox[{"Last", "@", "#"}]}], ",", 
         RowBox[{
          RowBox[{"First", "@", "#"}], "+", 
          RowBox[{"Last", "@", "#"}]}]}], "}"}]}], "&"}], "/@", 
     "magneticMoment"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"limiterPointsRadiiMoment", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{"#", ",", "1"}], "]"}], "&"}], "@", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"#", ",", "1"}], "]"}], "&"}], "@", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Mean", "@", 
               RowBox[{"bacteriaRadiiLimiters", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], ",", "#"}], "}"}], "&"}], "/@", 
           RowBox[{"bacteriaMomentLimiters", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"#", ",", 
              RowBox[{"Mean", "@", 
               RowBox[{"bacteriaMomentLimiters", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}]}], "}"}], "&"}], "/@", 
           RowBox[{"bacteriaRadiiLimiters", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
         "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"Length", "@", "bacteriaMomentLimiters"}]}], "}"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"quantileEnvelopePoints", "=", 
     RowBox[{"First", "@", 
      RowBox[{"QuantileEnvelope", "[", "\[IndentingNewLine]", 
       RowBox[{
       "limiterPointsRadiiMoment", ",", "envelopeQuantile", ",", 
        "envelopeAngularResolution"}], "\[IndentingNewLine]", "]"}]}]}], 
    ";"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"quantileEnvelopeSimplified", "=", 
    RowBox[{"getSimplifiedClosedCurve", "@", "quantileEnvelopePoints"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"ListLinePlot", "[", 
        RowBox[{"#", ",", 
         RowBox[{"PlotStyle", "\[Rule]", "Gray"}]}], "]"}], "&"}], "@", 
      "quantileEnvelopePoints"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"ListPlot", "[", 
        RowBox[{"#", ",", 
         RowBox[{"PlotStyle", "\[Rule]", "Black"}]}], "]"}], "&"}], "@", 
      "limiterPointsRadiiMoment"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"ListLinePlot", "[", 
        RowBox[{"#", ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Red", ",", "Thick"}], "]"}]}], ",", 
         RowBox[{"Mesh", "\[Rule]", "None"}]}], "]"}], "&"}], "@", 
      "quantileEnvelopeSimplified"}]}], "\[IndentingNewLine]", "}"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.9401811334677815`*^9, 3.9401812564332085`*^9}, {
  3.9401815549157743`*^9, 3.940181557106279*^9}, {3.9401815889904356`*^9, 
  3.9401815914903092`*^9}, {3.9401816348191233`*^9, 3.9401816395136437`*^9}, {
  3.9402569006365547`*^9, 3.940256919106043*^9}, {3.9402638595604324`*^9, 
  3.9402638669113874`*^9}, {3.9402641760081773`*^9, 3.940264205622138*^9}, {
  3.940311475890114*^9, 3.9403114767129154`*^9}, {3.940516742754876*^9, 
  3.94051674732859*^9}},
 CellLabel->
  "In[617]:=",ExpressionUUID->"c23e50e9-64e5-41cb-9bcb-99eb6baee35e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"frameLabelMomentradii", "=", 
   RowBox[{"getLatexStyling", "/@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"\"\<r,~\\\\mu m\>\"", ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<m,~ 10^{-\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"Log10", "@", "momentPlotScalingFactor"}], "]"}], "<>", 
       "\"\<}~ A \\\\cdot m^2\>\""}]}], "\[IndentingNewLine]", "}"}]}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.940257562779189*^9, 3.9402575922660866`*^9}, 
   3.94050912617447*^9},
 CellLabel->
  "In[623]:=",ExpressionUUID->"4ba87c9e-71f1-4f79-957f-ebc150cdbc28"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bacteriaRadiiMicrometersValues", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"First", "/@", "#"}], "&"}], "/@", 
    "bacteriaRadiiMicrometersFormatted"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bacteriaRadiiMicrometersErrors", "=", 
    RowBox[{"Norm", "/@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Last", "/@", "#"}], "&"}], "/@", 
       "bacteriaRadiiMicrometersFormatted"}], ")"}]}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"linearModel", "=", 
    RowBox[{"LinearModelFit", "[", "\[IndentingNewLine]", 
     RowBox[{"bacteriaRadiiMicrometersValues", ",", "r", ",", "r", ",", 
      RowBox[{"Weights", "\[Rule]", 
       RowBox[{"1", "/", 
        RowBox[{"bacteriaRadiiMicrometersErrors", "^", "2"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"linearModelSquaredR", "=", 
    RowBox[{"linearModel", "[", "\"\<AdjustedRSquared\>\"", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"linearModelSlopeError", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Last", "@", 
        RowBox[{"#", "[", "\"\<ParameterErrors\>\"", "]"}]}], "/", 
       RowBox[{"Abs", "@", 
        RowBox[{"Last", "@", 
         RowBox[{"#", "[", "\"\<BestFitParameters\>\"", "]"}]}]}]}], "&"}], 
     "@", "linearModel"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"plotLabelFitError", "=", 
    RowBox[{"getLatexStyling", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\"\<R^2 = \>\"", "<>", 
         RowBox[{"ToString", "@", 
          RowBox[{"Round", "[", 
           RowBox[{"#", ",", "0.001"}], "]"}]}]}], "&"}], "@", 
       "linearModelSquaredR"}], "<>", 
      "\"\<;~ \\\\delta \\\\left( \\\\frac{dm}{dr} \\\\right) = \>\"", "<>", 
      RowBox[{"ToString", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Round", "[", 
          RowBox[{"#", ",", "0.01"}], "]"}], "&"}], "@", 
        RowBox[{"(", 
         RowBox[{"100", "*", "linearModelSlopeError"}], ")"}]}], "]"}], "<>", 
      "\"\<~ \\\\%\>\""}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"fitErrorBandSlopes", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
        "linearModelSlopeError"}], "+", 
       RowBox[{"Abs", "@", 
        RowBox[{"Last", "@", 
         RowBox[{"#", "[", "\"\<BestFitParameters\>\"", "]"}]}]}]}], "&"}], 
     "@", "linearModel"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"linearModelBoundCurves", "[", "r_", "]"}], "=", 
    RowBox[{
     RowBox[{"fitErrorBandSlopes", "*", "r"}], "+", 
     RowBox[{"First", "@", 
      RowBox[{"linearModel", "@", "r"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{"plotMagneticMomentRadiusFit", "=", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
         RowBox[{"#", ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"Darker", "@", "Green"}]}], ",", 
          RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
          RowBox[{"InterpolationOrder", "\[Rule]", "1"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Filling", "\[Rule]", "Axis"}], ",", 
          RowBox[{"FillingStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{"LightGray", ",", 
             RowBox[{"Opacity", "@", "0.25"}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], "&"}], "@", 
       "quantileEnvelopeSimplified"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"ListPlot", "[", 
         RowBox[{"#", ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"Darker", "@", "Gray"}]}], ",", 
          RowBox[{"IntervalMarkers", "\[Rule]", "None"}]}], "]"}], "&"}], "@",
        "bacteriaRadiiMicrometersFormatted"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Plot", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"linearModel", "[", "r", "]"}], ",", 
            RowBox[{"linearModelBoundCurves", "[", "r", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"r", ",", 
            RowBox[{"Min", "@", "#"}], ",", 
            RowBox[{"Max", "@", "#"}]}], "}"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", "Thick", ",", "Dashed"}], "]"}], ",", 
             RowBox[{"Directive", "[", 
              RowBox[{
               RowBox[{"Lighter", "@", "Orange"}], ",", "Thin"}], "]"}]}], 
            "}"}]}], ",", 
          RowBox[{"Filling", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"1", "\[Rule]", 
             RowBox[{"{", "2", "}"}]}], "}"}]}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"FrameLabel", "\[Rule]", "frameLabelMomentradii"}], ",", 
          RowBox[{"LabelStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", "Bold", ",", "fontSize"}], "]"}]}], ",", 
          RowBox[{"ImageSize", "\[Rule]", 
           RowBox[{"Scaled", "@", "1"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"PlotLabel", "\[Rule]", "plotLabelFitError"}]}], 
         "\[IndentingNewLine]", "]"}], "&"}], "@", 
       RowBox[{"First", "@", 
        RowBox[{"Transpose", "@", "bacteriaRadiiMicrometersValues"}]}]}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"All", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1.80"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"Scaled", "@", "1"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", "frameLabelMomentradii"}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", "plotLabelFitError"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.940257957877157*^9, 3.9402580305355015`*^9}, {
   3.9402622133754473`*^9, 3.940262251215554*^9}, {3.9402624301638975`*^9, 
   3.9402624448551435`*^9}, {3.9402626079047375`*^9, 3.940262615342662*^9}, {
   3.940262687904399*^9, 3.9402626889594917`*^9}, {3.940263178401162*^9, 
   3.940263180478513*^9}, {3.940263877234273*^9, 3.9402638787922893`*^9}, {
   3.940303187975623*^9, 3.940303194717481*^9}, {3.940310265745715*^9, 
   3.9403102757463207`*^9}, 3.9403115280348864`*^9, {3.9405090668116755`*^9, 
   3.9405090711147733`*^9}},
 CellLabel->
  "In[624]:=",ExpressionUUID->"7a6bee2f-dc00-44cb-8166-744217ad11fc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"exportImagesTwoFormat", "[", "\[IndentingNewLine]", 
   RowBox[{
   "plotMagneticMomentRadiusFit", ",", 
    "\"\<Magnetic_moment_versus_radius\>\"", ",", "350"}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.915648115010803*^9, 3.9156481330422773`*^9}, 
   3.915708275405222*^9, {3.9157353754428544`*^9, 3.9157353759778137`*^9}, {
   3.91573687019776*^9, 3.9157368813252993`*^9}, {3.915737073877739*^9, 
   3.9157370748919*^9}, {3.915737115254693*^9, 3.915737116261586*^9}, 
   3.9164925678010235`*^9, {3.916492628624577*^9, 3.9164926432548285`*^9}, {
   3.916493721425295*^9, 3.916493723399071*^9}, 3.9173491447733283`*^9, 
   3.9173491823031673`*^9, {3.917351776998371*^9, 3.917351792633855*^9}, {
   3.94026321485338*^9, 3.9402632707172437`*^9}, {3.9402633965437264`*^9, 
   3.9402634305739193`*^9}, {3.9402635437850895`*^9, 3.940263544335528*^9}},
 CellLabel->
  "In[634]:=",ExpressionUUID->"849eff91-8ce3-4723-8f7f-5f800ed9aef2"],

Cell[BoxData[
 RowBox[{"plotMagneticMomentRadiusHistogram", "=", 
  RowBox[{"SmoothDensityHistogram", "[", "\[IndentingNewLine]", 
   RowBox[{"bacteriaRadiiMicrometersValues", ",", 
    RowBox[{"{", 
     RowBox[{"\"\<SheatherJones\>\"", ",", "\"\<Epanechnikov\>\""}], "}"}], 
    ",", "\"\<Intensity\>\"", ",", "\[IndentingNewLine]", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.5", ",", "0.95"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1.8"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Full"}], ",", "\[IndentingNewLine]", 
    RowBox[{"PlotPoints", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"MaxRecursion", "\[Rule]", "4"}], ",", 
    RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Quality\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"FrameLabel", "\[Rule]", "frameLabelMomentradii"}], ",", 
    RowBox[{"ColorFunction", "\[Rule]", "\"\<BlueGreenYellow\>\""}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.940509963396613*^9, 3.940510285348582*^9}, {
  3.9405103208626328`*^9, 3.9405103858204255`*^9}, {3.940510444347831*^9, 
  3.9405105216033664`*^9}, {3.9405167776157274`*^9, 3.9405168089188027`*^9}},
 CellLabel->
  "In[635]:=",ExpressionUUID->"4af071a5-ae57-4d8c-b3ae-0a4155b30b84"],

Cell[BoxData[
 RowBox[{
  RowBox[{"exportImagesTwoFormat", "[", "\[IndentingNewLine]", 
   RowBox[{
   "plotMagneticMomentRadiusHistogram", ",", 
    "\"\<Magnetic_moment_versus_radius_histogram\>\"", ",", "300"}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.915648115010803*^9, 3.9156481330422773`*^9}, 
   3.915708275405222*^9, {3.9157353754428544`*^9, 3.9157353759778137`*^9}, {
   3.91573687019776*^9, 3.9157368813252993`*^9}, {3.915737073877739*^9, 
   3.9157370748919*^9}, {3.915737115254693*^9, 3.915737116261586*^9}, 
   3.9164925678010235`*^9, {3.916492628624577*^9, 3.9164926432548285`*^9}, {
   3.916493721425295*^9, 3.916493723399071*^9}, 3.9173491447733283`*^9, 
   3.9173491823031673`*^9, {3.917351776998371*^9, 3.917351792633855*^9}, {
   3.94026321485338*^9, 3.9402632707172437`*^9}, {3.9402633965437264`*^9, 
   3.9402634305739193`*^9}, {3.9402635437850895`*^9, 3.940263544335528*^9}, {
   3.940516817343064*^9, 3.940516822254815*^9}, 3.9405168736153517`*^9, {
   3.940519253529778*^9, 3.9405192548958006`*^9}},
 CellLabel->
  "In[636]:=",ExpressionUUID->"d0b5b111-d287-4dae-a628-b455736b8297"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Export Notebook With Parameters", "Section",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
  3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
  3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
  3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
  3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
  3.842969150048052*^9, 3.8429691537910447`*^9}, {3.8615435122762966`*^9, 
  3.861543517725723*^9}, {3.890209056062702*^9, 
  3.89020905769811*^9}},ExpressionUUID->"f7a0c101-cc0e-47ca-b791-\
d508d42a5216"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"notebookID", "=", "1"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "FrontEndTokenExecute", "[", "\"\<DeleteGeneratedCells\>\"", "]"}], ";"}],
    "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NotebookSave", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"notebookSnapshot", "=", 
    RowBox[{"NotebookOpen", "@", 
     RowBox[{"NotebookFileName", "[", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"output", "<>", 
            RowBox[{"StringDelete", "[", 
             RowBox[{"#", ",", "\"\<.nb\>\""}], "]"}]}], "&"}], "@", 
          RowBox[{"StringReplace", "[", 
           RowBox[{"#", ",", 
            RowBox[{"Whitespace", "\[Rule]", "\"\<_\>\""}]}], "]"}]}], "&"}], 
        "@", 
        RowBox[{"Last", "@", 
         RowBox[{"StringSplit", "[", 
          RowBox[{"#", ",", "$PathnameSeparator"}], "]"}]}]}], "&"}], "@", 
      RowBox[{"NotebookFileName", "[", "]"}]}], "<>", "\"\<_Run_\>\"", "<>", 
     RowBox[{"ToString", "@", "notebookID"}], "<>", "\"\<.pdf\>\""}], ",", 
    "notebookSnapshot"}], "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.861543175536664*^9, 3.8615432357785387`*^9}, {
   3.86154342636442*^9, 3.861543447540553*^9}, {3.861543590796198*^9, 
   3.8615435924374075`*^9}, {3.861798817780515*^9, 3.861798818319141*^9}, {
   3.88928857082766*^9, 3.8892885935714035`*^9}, {3.889300824400525*^9, 
   3.889300826019042*^9}, {3.8900794555092363`*^9, 3.8900794592661676`*^9}, 
   3.8902083844570394`*^9, 3.890209069048913*^9, 3.8902093067789917`*^9, {
   3.8905940957431183`*^9, 3.890594096652687*^9}, 3.8905942440505*^9, {
   3.8941325023793926`*^9, 3.8941325032889395`*^9}, {3.89469919779359*^9, 
   3.894699197823932*^9}, {3.8947136469968*^9, 3.8947136482268553`*^9}, 
   3.8948274270813093`*^9, 3.8948275185738883`*^9, 3.896442076226533*^9, 
   3.9100898814482017`*^9, 3.910425786437649*^9, 3.9126150068030386`*^9, 
   3.912688067441677*^9, {3.912689997393589*^9, 3.912689998663714*^9}, 
   3.915226205688525*^9, 3.915645567121797*^9, 3.9278080508718495`*^9, 
   3.9287563033212876`*^9, 3.9287565002154694`*^9, 3.9287565466329207`*^9, {
   3.928756967955947*^9, 3.928756968052355*^9}, 3.928811121903471*^9, 
   3.928811296066916*^9, 3.9288121631087666`*^9, 3.928812626105528*^9, 
   3.9288135947347307`*^9, 3.928815894025139*^9, 3.928817450600507*^9, {
   3.9288187659295316`*^9, 3.928818766015087*^9}, {3.9288191190902605`*^9, 
   3.928819119235565*^9}, {3.928826171509473*^9, 3.928826171664942*^9}, {
   3.928827089282217*^9, 3.9288270893734827`*^9}, {3.928827660453759*^9, 
   3.9288276605809393`*^9}, {3.928828841524688*^9, 3.928828841787171*^9}, {
   3.9288289212587576`*^9, 3.9288289218604307`*^9}, {3.9288300355959835`*^9, 
   3.92883003696344*^9}, {3.92883032717974*^9, 3.928830327564537*^9}, {
   3.9288307496466937`*^9, 3.9288307504950304`*^9}, {3.928834397652745*^9, 
   3.928834397722993*^9}, {3.9288352291116076`*^9, 3.9288352292566147`*^9}, {
   3.9288434830341177`*^9, 3.9288434831850586`*^9}, 3.940180945259203*^9, {
   3.9401809801143885`*^9, 3.940180985740844*^9}, 3.9402635783384037`*^9, 
   3.9402636452241917`*^9, {3.940264280274062*^9, 3.940264280350822*^9}, {
   3.940264314919778*^9, 3.940264316382847*^9}, 3.940310374850587*^9, {
   3.9403125270703907`*^9, 3.9403125280898743`*^9}, 3.9405169099668694`*^9, 
   3.9405181705105205`*^9},ExpressionUUID->"f15f7b0c-8708-4841-aaa8-\
d150f94aa333"]
}, Closed]]
},
WindowSize->{766.8, 795.5999999999999},
WindowMargins->{{Automatic, -4.7999999999999545`}, {Automatic, 0}},
TaggingRules->{"TryRealOnly" -> False},
Magnification:>1. Inherited,
FrontEndVersion->"12.1 for Microsoft Windows (64-bit) (June 9, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"fb09c831-d7f5-4e56-afff-f6ce70fbe93e"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 591, 9, 67, "Section",ExpressionUUID->"c917926f-99ec-4cc3-94b7-d5273eea8586"],
Cell[1174, 33, 6454, 154, 1001, "Input",ExpressionUUID->"d8bfe76c-e101-44b5-bc53-db823bfbcde6",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[7665, 192, 634, 9, 53, "Section",ExpressionUUID->"b6d1af6e-d128-4453-a93e-468d160f228b"],
Cell[CellGroupData[{
Cell[8324, 205, 695, 10, 54, "Subsection",ExpressionUUID->"888d5458-5331-4700-9276-a934792c66d9"],
Cell[9022, 217, 69132, 1730, 10536, "Input",ExpressionUUID->"a61e590c-04a9-4cf6-a3fc-32cb5f055d6a",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[78191, 1952, 689, 10, 38, "Subsection",ExpressionUUID->"44edc8b1-509b-4471-921f-77540503fea2"],
Cell[78883, 1964, 2123, 47, 182, "Input",ExpressionUUID->"0b998fb2-a1ce-4bff-8c66-d1b106561cb9",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[81055, 2017, 696, 10, 67, "Section",ExpressionUUID->"251bc731-31dd-4327-94e1-1c057044d74a"],
Cell[CellGroupData[{
Cell[81776, 2031, 809, 11, 54, "Subsection",ExpressionUUID->"2dc9e86c-4886-419f-88a7-99745c4a627e"],
Cell[82588, 2044, 2142, 37, 315, "Abstract",ExpressionUUID->"6d541f13-203d-43b4-8a26-d68b0a96ef9f"],
Cell[84733, 2083, 1979, 49, 318, "Input",ExpressionUUID->"25b72481-4ea2-4cce-b1bc-7581e71fb0c3",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[86749, 2137, 762, 11, 54, "Subsection",ExpressionUUID->"658b2db2-476c-4998-9a46-7cf4c753e75c"],
Cell[87514, 2150, 1460, 38, 185, "Input",ExpressionUUID->"296a4537-12b3-41d9-9128-4d9c4fe03358"],
Cell[88977, 2190, 679, 14, 49, "Input",ExpressionUUID->"1db7823c-1164-465d-b02d-12dcd28537dd"],
Cell[89659, 2206, 665, 14, 154, "Abstract",ExpressionUUID->"f83084b4-a8c7-41dd-8046-7b7aa30c0908"]
}, Closed]],
Cell[CellGroupData[{
Cell[90361, 2225, 801, 11, 38, "Subsection",ExpressionUUID->"03837fc2-9be2-475b-b683-12eba96a955d"],
Cell[CellGroupData[{
Cell[91187, 2240, 864, 12, 45, "Subsubsection",ExpressionUUID->"21f30b6f-ac38-4d12-ab13-5b79f46616be"],
Cell[92054, 2254, 548, 12, 108, "Abstract",ExpressionUUID->"de03ec6b-cb52-4527-8ed1-bad031ee8c95"],
Cell[92605, 2268, 513, 9, 44, "Input",ExpressionUUID->"aafec580-c6f2-4c1b-ba1b-eb8701155b7e",
 InitializationCell->True],
Cell[93121, 2279, 1389, 32, 166, "Input",ExpressionUUID->"711a5b9f-4558-4a6a-bdf0-50c25b03103d"],
Cell[94513, 2313, 1304, 32, 146, "Input",ExpressionUUID->"f88b986c-9599-4772-819e-96116b81e82e"]
}, Closed]],
Cell[CellGroupData[{
Cell[95854, 2350, 868, 12, 37, "Subsubsection",ExpressionUUID->"d1b98fde-5faf-4faa-ac13-08f6e917b3a6"],
Cell[96725, 2364, 1017, 19, 107, "Input",ExpressionUUID->"862f0cef-c8fa-400f-b68c-3e9f301c711d"],
Cell[97745, 2385, 532, 11, 108, "Abstract",ExpressionUUID->"ed6f3c1a-4446-4905-ae27-6f0eb8d1a902"],
Cell[98280, 2398, 574, 9, 44, "Input",ExpressionUUID->"7dc85ed3-957c-4d9b-afb5-fffbebd312c9",
 InitializationCell->True],
Cell[98857, 2409, 2427, 55, 322, "Input",ExpressionUUID->"243abe2b-25c3-48ab-a4a6-b2a2e7384404"],
Cell[101287, 2466, 1368, 33, 146, "Input",ExpressionUUID->"47def790-f795-4b35-b558-aded6e61bc0c"]
}, Closed]],
Cell[CellGroupData[{
Cell[102692, 2504, 869, 12, 37, "Subsubsection",ExpressionUUID->"e8674e99-f94f-460c-bc75-23c1fcfe3d18"],
Cell[103564, 2518, 512, 12, 131, "Abstract",ExpressionUUID->"497e42e4-52e7-47e5-bbd9-8b6e3911afce"],
Cell[104079, 2532, 619, 11, 65, "Input",ExpressionUUID->"21ba08e1-c778-4eaf-9a69-3b4f06612ba6",
 InitializationCell->True],
Cell[104701, 2545, 2471, 44, 185, "Input",ExpressionUUID->"742db6c7-f474-40ba-a2e8-b73176543faf"],
Cell[107175, 2591, 898, 22, 107, "Input",ExpressionUUID->"bb16ee16-7784-43a5-bf59-de890de9c78a"],
Cell[108076, 2615, 1224, 31, 146, "Input",ExpressionUUID->"840a7cb6-0711-4c39-9ed9-758ea4c36a44"],
Cell[109303, 2648, 888, 18, 177, "Abstract",ExpressionUUID->"aceab945-948c-41a7-b6b1-c7305372d255"]
}, Closed]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[110252, 2673, 851, 12, 67, "Section",ExpressionUUID->"70fe8269-0960-4108-927f-c817acfabaf7"],
Cell[CellGroupData[{
Cell[111128, 2689, 822, 11, 54, "Subsection",ExpressionUUID->"5a663362-3005-46c7-8d7c-29f04fef8305"],
Cell[111953, 2702, 13299, 309, 2018, "Input",ExpressionUUID->"8c9a789e-58c5-4d1d-a1e8-356445181bda",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[125289, 3016, 777, 11, 38, "Subsection",ExpressionUUID->"c3214b35-0882-4214-93c9-2aef917d42ec"],
Cell[126069, 3029, 1234, 29, 414, "Abstract",ExpressionUUID->"e10732a6-1782-42ac-87d2-8444dfdb929f"],
Cell[127306, 3060, 2090, 43, 279, "Input",ExpressionUUID->"fab85ce7-190c-442a-9609-02a3342f829a",
 InitializationCell->True],
Cell[129399, 3105, 836, 14, 28, "Input",ExpressionUUID->"f6341fa8-0306-4474-b416-95421a9b4264"]
}, Closed]],
Cell[CellGroupData[{
Cell[130272, 3124, 710, 10, 38, "Subsection",ExpressionUUID->"211cd941-583a-4169-8c53-fc4dd52883ba"],
Cell[CellGroupData[{
Cell[131007, 3138, 971, 13, 45, "Subsubsection",ExpressionUUID->"ca0bb7b1-a962-45c0-a4c0-b53783faa593"],
Cell[131981, 3153, 1234, 29, 414, "Abstract",ExpressionUUID->"759fdcd2-56d1-4d29-bc2b-2738e842e012"],
Cell[133218, 3184, 2094, 44, 279, "Input",ExpressionUUID->"0624fd88-1910-44f8-8f53-a37bf67346ac",
 InitializationCell->True],
Cell[135315, 3230, 252, 8, 108, "Abstract",ExpressionUUID->"8ca39f0c-d091-4b12-a275-a80c15711038"],
Cell[135570, 3240, 1039, 17, 49, "Input",ExpressionUUID->"758a09b9-6c00-4758-b7ce-23833c7d186d"],
Cell[136612, 3259, 989, 21, 127, "Input",ExpressionUUID->"2effeaa0-a5b1-48c8-bb83-97284221f606"]
}, Closed]],
Cell[CellGroupData[{
Cell[137638, 3285, 1028, 14, 37, "Subsubsection",ExpressionUUID->"173bbfb4-4e5c-4764-81fd-38c7ddc198eb"],
Cell[138669, 3301, 1024, 17, 114, "Abstract",ExpressionUUID->"b458be98-599a-4085-bfd2-04df9e81e661"],
Cell[139696, 3320, 266, 6, 44, "Input",ExpressionUUID->"e539a834-41da-4679-a467-a16ce57424ae",
 InitializationCell->True],
Cell[139965, 3328, 820, 18, 127, "Input",ExpressionUUID->"6d27ed7c-2709-407c-8d93-c0e42955a6ce"]
}, Closed]],
Cell[CellGroupData[{
Cell[140822, 3351, 961, 13, 37, "Subsubsection",ExpressionUUID->"c2a1776d-54f9-4e64-b0c2-721958ecf2ed"],
Cell[141786, 3366, 2242, 49, 205, "Input",ExpressionUUID->"e13852d0-0b68-48dd-b4b2-e87ebcc9feb2"]
}, Closed]],
Cell[CellGroupData[{
Cell[144065, 3420, 1036, 14, 37, "Subsubsection",ExpressionUUID->"a63b447e-c607-4dec-b27c-91ff84bc5956"],
Cell[145104, 3436, 1833, 42, 127, "Input",ExpressionUUID->"b437a73d-072b-406a-b089-8f8ae363f7b0"]
}, Closed]],
Cell[CellGroupData[{
Cell[146974, 3483, 971, 13, 37, "Subsubsection",ExpressionUUID->"f02705a5-f6a2-4904-9f4c-51a5161a3eda"],
Cell[147948, 3498, 992, 28, 107, "Input",ExpressionUUID->"23ce3ac3-ee01-4805-8029-7a84b6eaf3df"],
Cell[148943, 3528, 1823, 40, 146, "Input",ExpressionUUID->"0b4af3d0-8b4a-4ced-bdb3-4c5e4579395b"],
Cell[150769, 3570, 1291, 33, 166, "Input",ExpressionUUID->"26ee8138-f10d-4281-9877-28006f321e9e"],
Cell[152063, 3605, 1019, 25, 107, "Input",ExpressionUUID->"c08f2fb9-e8d9-4550-8445-be1738c73ab3"],
Cell[153085, 3632, 646, 15, 88, "Input",ExpressionUUID->"ec029f2f-7f9f-4c43-a32f-6e2c39bee5a6"]
}, Closed]],
Cell[CellGroupData[{
Cell[153768, 3652, 1044, 14, 37, "Subsubsection",ExpressionUUID->"4304a989-b404-45dc-b2b4-8fcf0e4db54a"],
Cell[154815, 3668, 1284, 26, 146, "Input",ExpressionUUID->"f3e3f6e3-27ed-4be8-8c7a-0542e8827fd8"],
Cell[156102, 3696, 907, 21, 127, "Input",ExpressionUUID->"38636246-96f4-40ca-98ef-5f17909e1e01"],
Cell[157012, 3719, 1872, 46, 224, "Input",ExpressionUUID->"bf389444-2f17-4936-8c5e-0de22a21cb96"],
Cell[158887, 3767, 710, 13, 108, "Abstract",ExpressionUUID->"76d5189a-a202-4b61-ba43-9b387e0714f0"],
Cell[159600, 3782, 545, 10, 44, "Input",ExpressionUUID->"2a305bdd-ac54-45f0-88e3-36418be58c49",
 InitializationCell->True],
Cell[160148, 3794, 1455, 33, 205, "Input",ExpressionUUID->"6b26357e-baf0-4357-8c09-b80fa759747c"],
Cell[161606, 3829, 913, 20, 68, "Input",ExpressionUUID->"e1cd3fd2-89e7-45b9-90b1-db19d0189916"],
Cell[162522, 3851, 765, 17, 88, "Input",ExpressionUUID->"63fef3f6-d746-4670-81af-42915cb6d98d"]
}, Closed]],
Cell[CellGroupData[{
Cell[163324, 3873, 1012, 14, 37, "Subsubsection",ExpressionUUID->"be6cf64c-37e5-4989-abdb-eea964f2e27f"],
Cell[164339, 3889, 1356, 30, 68, "Input",ExpressionUUID->"488172eb-099b-4160-8ce1-a7b8bfb7bf92"],
Cell[165698, 3921, 791, 19, 68, "Input",ExpressionUUID->"90200f4b-2c2f-4562-b1b8-e936b72672bc"],
Cell[166492, 3942, 865, 20, 68, "Input",ExpressionUUID->"966d08c4-3816-405e-b74c-79278229b10f"],
Cell[167360, 3964, 963, 24, 68, "Input",ExpressionUUID->"4eed6b90-0d2a-44ea-bdfd-a04780703092"],
Cell[168326, 3990, 630, 13, 108, "Abstract",ExpressionUUID->"4735dde7-f0f8-4570-9d40-ba4f1132b280"],
Cell[168959, 4005, 267, 6, 44, "Input",ExpressionUUID->"62c7972f-ccaf-4028-ad93-eade7a363cbf",
 InitializationCell->True],
Cell[169229, 4013, 760, 17, 107, "Input",ExpressionUUID->"37bc6a10-500f-4688-b736-9c469f2f414b"]
}, Closed]],
Cell[CellGroupData[{
Cell[170026, 4035, 1092, 15, 37, "Subsubsection",ExpressionUUID->"714f8f83-2a2a-4feb-9ab8-a2736d11a6ba"],
Cell[171121, 4052, 1091, 20, 139, "Abstract",ExpressionUUID->"787147d0-0530-429d-8373-a221ca6fea8f",
 InitializationCell->True],
Cell[172215, 4074, 1205, 20, 65, "Input",ExpressionUUID->"4cb2b20b-4eac-45dd-9e36-51d9b990712a",
 InitializationCell->True],
Cell[173423, 4096, 886, 20, 49, "Input",ExpressionUUID->"38c1a576-e33f-4319-a983-5d56cfcf9263"],
Cell[174312, 4118, 866, 19, 68, "Input",ExpressionUUID->"629ec48b-d815-4551-b17c-3acc29438c29"],
Cell[175181, 4139, 5222, 106, 556, "Input",ExpressionUUID->"f0145616-846b-4b17-8a37-a54eaf3c0aaf"],
Cell[180406, 4247, 558, 13, 84, "Input",ExpressionUUID->"e582cb34-3b7f-4c83-9b1e-c6a290d4b6ef",
 InitializationCell->True],
Cell[180967, 4262, 2495, 64, 341, "Input",ExpressionUUID->"51a815e5-14c8-43f0-9a54-c80cedaff15c"]
}, Closed]],
Cell[CellGroupData[{
Cell[183499, 4331, 1022, 14, 37, "Subsubsection",ExpressionUUID->"43fa8755-1d42-4702-b2e1-4ff16be2e268"],
Cell[184524, 4347, 1552, 39, 205, "Input",ExpressionUUID->"c38e0865-ba69-4126-bc90-5f71afc0468a"]
}, Closed]],
Cell[CellGroupData[{
Cell[186113, 4391, 1033, 14, 37, "Subsubsection",ExpressionUUID->"7a55ba57-5ee2-4053-b843-e85d75051c97"],
Cell[187149, 4407, 668, 14, 88, "Input",ExpressionUUID->"a611ef39-21df-43c3-b44a-519ef32980ae"]
}, Closed]],
Cell[CellGroupData[{
Cell[187854, 4426, 1033, 14, 37, "Subsubsection",ExpressionUUID->"7c391228-9ac0-4cab-adc6-795c4ae354d6"],
Cell[188890, 4442, 502, 12, 68, "Input",ExpressionUUID->"5e80baa1-83ce-4eef-8aab-96df5277ddc5"]
}, Closed]],
Cell[CellGroupData[{
Cell[189429, 4459, 919, 13, 37, "Subsubsection",ExpressionUUID->"c0e16877-88bc-4cc9-8875-4faf81637a74"],
Cell[190351, 4474, 523, 11, 108, "Abstract",ExpressionUUID->"e893e1e3-585d-4c11-bb74-25d87d9e491f"],
Cell[190877, 4487, 315, 7, 44, "Input",ExpressionUUID->"dfed39cd-3946-4d42-a0b6-0a420a208a87",
 InitializationCell->True],
Cell[191195, 4496, 1961, 44, 283, "Input",ExpressionUUID->"395292c2-2723-4215-a36c-fe69b1ed36af"],
Cell[193159, 4542, 1098, 25, 107, "Input",ExpressionUUID->"676831a7-b857-4f8f-92d8-5ab2bb680259"]
}, Closed]],
Cell[CellGroupData[{
Cell[194294, 4572, 977, 13, 37, "Subsubsection",ExpressionUUID->"c520922e-bf8e-44a0-bc6b-a79ad0a32d9b"],
Cell[195274, 4587, 2652, 67, 341, "Input",ExpressionUUID->"0af5c2cb-81e7-4c91-916b-d8e101a1d124"]
}, Closed]],
Cell[CellGroupData[{
Cell[197963, 4659, 963, 13, 37, "Subsubsection",ExpressionUUID->"2e7a1815-cf16-4173-8c04-5fa7e8a71ce5"],
Cell[198929, 4674, 1146, 26, 127, "Input",ExpressionUUID->"cf0fdb8a-2da2-4c8c-85c0-89a49f48d56c"]
}, Closed]],
Cell[CellGroupData[{
Cell[200112, 4705, 1120, 15, 37, "Subsubsection",ExpressionUUID->"dcfdc934-7a76-4e22-86e7-113822f7235e"],
Cell[201235, 4722, 557, 12, 108, "Abstract",ExpressionUUID->"95e4fa73-c697-48ee-b607-2cb42842186c"],
Cell[201795, 4736, 267, 6, 44, "Input",ExpressionUUID->"8843cd24-87c7-4f39-8421-cd2da201e285",
 InitializationCell->True],
Cell[202065, 4744, 945, 20, 127, "Input",ExpressionUUID->"fbdeeb40-bdff-4ed1-af87-743a0d601fa7"],
Cell[203013, 4766, 1406, 31, 127, "Input",ExpressionUUID->"8f7e05cc-f1d3-41e8-8e53-07bd0306b584"]
}, Closed]],
Cell[CellGroupData[{
Cell[204456, 4802, 1238, 17, 37, "Subsubsection",ExpressionUUID->"db77de4f-0f14-4891-8d9b-10e3048579fb"],
Cell[205697, 4821, 641, 13, 108, "Abstract",ExpressionUUID->"a6e35318-ecdd-4a30-bad2-c7e8714e59a8"],
Cell[206341, 4836, 321, 7, 44, "Input",ExpressionUUID->"b4b6ccf7-8167-4d65-96e6-8ee719da4ee6",
 InitializationCell->True],
Cell[206665, 4845, 1311, 30, 127, "Input",ExpressionUUID->"cbdf3033-9c25-4b58-a231-f58fd32708b8"],
Cell[207979, 4877, 1038, 26, 127, "Input",ExpressionUUID->"0671024e-ce5f-4d78-a576-0cafd5328895"]
}, Closed]],
Cell[CellGroupData[{
Cell[209054, 4908, 1282, 17, 37, "Subsubsection",ExpressionUUID->"85218a33-edd7-42b3-be86-531634b705d3"],
Cell[210339, 4927, 957, 20, 68, "Input",ExpressionUUID->"a113abc5-1b06-44d2-b5a5-04535be65932"],
Cell[211299, 4949, 5190, 98, 536, "Input",ExpressionUUID->"fd75f0c9-7267-4209-b1ec-fa2301536a53"],
Cell[216492, 5049, 713, 14, 154, "Abstract",ExpressionUUID->"fe86763f-7a8b-4f9b-a3a8-9162537daeb1"],
Cell[217208, 5065, 573, 13, 84, "Input",ExpressionUUID->"b495359d-31c9-4ba1-b6df-54f5bf5ecd2f",
 InitializationCell->True],
Cell[217784, 5080, 3182, 80, 341, "Input",ExpressionUUID->"13157b82-98d2-4193-bd3c-451e6d0b0a84"]
}, Closed]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[221027, 5167, 811, 11, 67, "Section",ExpressionUUID->"12760c06-8c74-4d75-8dac-082d8aac9188"],
Cell[CellGroupData[{
Cell[221863, 5182, 814, 11, 54, "Subsection",ExpressionUUID->"9a04b81c-02c0-4364-945f-d4eec3bd074a"],
Cell[CellGroupData[{
Cell[222702, 5197, 870, 12, 45, "Subsubsection",ExpressionUUID->"2be56988-0a58-4bdc-a34f-8b3c59f9e90b"],
Cell[223575, 5211, 4023, 92, 240, "Input",ExpressionUUID->"0ac7b002-5c13-4edb-afd4-9743b9fcc792",
 InitializationCell->True],
Cell[227601, 5305, 1683, 40, 166, "Input",ExpressionUUID->"15b84317-d51e-46a8-8717-6f93c3cb2880"]
}, Closed]],
Cell[CellGroupData[{
Cell[229321, 5350, 977, 14, 37, "Subsubsection",ExpressionUUID->"2f714c8f-e940-4bcc-bf69-c7c259467ba8"],
Cell[230301, 5366, 1228, 29, 439, "Abstract",ExpressionUUID->"4d80c19d-5cc5-4d46-879e-cecfa69f946d"],
Cell[231532, 5397, 8341, 141, 357, "Input",ExpressionUUID->"ab3ca144-ec3d-4d85-a415-a982f73195b2",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[239910, 5543, 931, 13, 37, "Subsubsection",ExpressionUUID->"42979179-e336-4c14-bbfb-4326d68704b8"],
Cell[240844, 5558, 14308, 322, 1898, "Input",ExpressionUUID->"dcdcd476-9edd-49b3-9138-174f6404a5c9",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[255189, 5885, 937, 13, 37, "Subsubsection",ExpressionUUID->"3ce919ce-608e-440c-9dfd-40d5fd859ce3"],
Cell[256129, 5900, 982, 26, 127, "Input",ExpressionUUID->"6ab41b48-f7db-4933-a787-882db29aa555"],
Cell[257114, 5928, 571, 11, 49, "Input",ExpressionUUID->"b7f27454-9fec-49eb-9157-5328328e41ff"],
Cell[257688, 5941, 434, 10, 28, "Input",ExpressionUUID->"6e3e16d2-4ffb-44df-837b-987bf7bd38a3"]
}, Closed]],
Cell[CellGroupData[{
Cell[258159, 5956, 951, 13, 37, "Subsubsection",ExpressionUUID->"342de1cf-a128-46be-a0ba-4d1e1b706c6d"],
Cell[259113, 5971, 989, 25, 127, "Input",ExpressionUUID->"4e16c39c-bdd8-4743-a5a1-a4cf6968f55e"]
}, Closed]],
Cell[CellGroupData[{
Cell[260139, 6001, 1013, 14, 37, "Subsubsection",ExpressionUUID->"6d27c093-9a21-4667-bea6-1732ccbccb81"],
Cell[261155, 6017, 631, 13, 88, "Input",ExpressionUUID->"d96fe2b2-316b-442c-9546-7f933ae19e32"]
}, Closed]],
Cell[CellGroupData[{
Cell[261823, 6035, 1015, 14, 37, "Subsubsection",ExpressionUUID->"e0e1a717-1422-4786-9e37-d0726f304eed"],
Cell[262841, 6051, 465, 11, 68, "Input",ExpressionUUID->"12106f5d-178c-4a0e-a184-e73a3147a21b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[263343, 6067, 864, 12, 45, "Subsubsection",ExpressionUUID->"a17d8d31-1bcb-4f51-838a-6867599c1c36"],
Cell[264210, 6081, 430, 16, 292, "Abstract",ExpressionUUID->"20a2bebf-27ca-4915-856f-b766c17d2488"],
Cell[264643, 6099, 476, 14, 28, "Input",ExpressionUUID->"724a29d8-c8b7-4ede-be14-13a484e8f452"],
Cell[265122, 6115, 2154, 57, 224, "Input",ExpressionUUID->"342385db-c2e4-4737-9394-da55c8f58972"],
Cell[267279, 6174, 2082, 54, 224, "Input",ExpressionUUID->"68bdf351-b33d-4d1b-9f80-e5b57d7387b1"],
Cell[269364, 6230, 2267, 54, 224, "Input",ExpressionUUID->"da5a20bf-90fc-4300-8b8e-c3e311a59048"]
}, Closed]],
Cell[CellGroupData[{
Cell[271668, 6289, 937, 13, 37, "Subsubsection",ExpressionUUID->"37a1f0e8-8858-467d-a298-15b3f080b2cd"],
Cell[272608, 6304, 1009, 17, 139, "Abstract",ExpressionUUID->"9b90dcd5-9af4-4589-a776-f63c3d686ce6"],
Cell[273620, 6323, 658, 16, 65, "Input",ExpressionUUID->"53873217-3dc6-4822-a1cc-75f3c2a5ecda",
 InitializationCell->True],
Cell[274281, 6341, 1930, 51, 224, "Input",ExpressionUUID->"af5fd58e-0814-4f56-81de-a10161e5790f"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[276260, 6398, 805, 11, 54, "Subsection",ExpressionUUID->"5a8f0c2a-b04d-4a58-8673-051e3cd51770"],
Cell[CellGroupData[{
Cell[277090, 6413, 1042, 14, 45, "Subsubsection",ExpressionUUID->"6db8b855-91bb-41c0-b29f-0939c1302f8d"],
Cell[278135, 6429, 1600, 41, 146, "Input",ExpressionUUID->"49b736a0-3641-42db-adc3-7c9ad2eb4ce1"],
Cell[279738, 6472, 1795, 50, 166, "Input",ExpressionUUID->"7d2df90e-f7be-455d-a747-958b687a629c"]
}, Closed]],
Cell[CellGroupData[{
Cell[281570, 6527, 1149, 16, 37, "Subsubsection",ExpressionUUID->"f3a61191-9f52-4058-92b9-b629752e4cff"],
Cell[282722, 6545, 910, 24, 127, "Input",ExpressionUUID->"804334ba-52ac-49b3-8730-31e411808c79"]
}, Closed]],
Cell[CellGroupData[{
Cell[283669, 6574, 1121, 16, 37, "Subsubsection",ExpressionUUID->"a9592315-d30d-4987-9aa6-3f3ac4f545dd"],
Cell[284793, 6592, 962, 26, 107, "Input",ExpressionUUID->"fff78587-2041-4f32-8477-a3b1224f9dc2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[285792, 6623, 930, 13, 45, "Subsubsection",ExpressionUUID->"57a6af00-8214-4595-8e13-bf53939a9b7d"],
Cell[286725, 6638, 628, 15, 65, "Input",ExpressionUUID->"41178d9f-9207-484a-a380-11852398dc6f",
 InitializationCell->True],
Cell[287356, 6655, 1153, 22, 239, "Abstract",ExpressionUUID->"19ff6f4e-cd66-4587-ae2f-7dcd509a9e38"],
Cell[288512, 6679, 1140, 29, 104, "Input",ExpressionUUID->"5e9e3057-d51d-4016-8729-cb3dc3bb321e",
 InitializationCell->True],
Cell[289655, 6710, 1795, 45, 166, "Input",ExpressionUUID->"993e32a3-2493-40aa-bfac-614c30efc254"]
}, Closed]],
Cell[CellGroupData[{
Cell[291487, 6760, 909, 13, 37, "Subsubsection",ExpressionUUID->"fd66c98c-2c9a-4923-8504-223b0034ece7"],
Cell[292399, 6775, 1221, 34, 146, "Input",ExpressionUUID->"bae152c9-a69b-4ac4-bd45-a3715a7b6ba9"],
Cell[293623, 6811, 1089, 20, 189, "Abstract",ExpressionUUID->"53159f15-7325-4753-bec4-a40752f4ba5d"],
Cell[294715, 6833, 1633, 29, 104, "Input",ExpressionUUID->"288af667-34bc-48cd-aba3-6237fffe9848",
 InitializationCell->True],
Cell[296351, 6864, 7678, 179, 887, "Input",ExpressionUUID->"f2ab5609-5c53-4f66-8b95-6171b63e6080"],
Cell[304032, 7045, 784, 19, 88, "Input",ExpressionUUID->"43811dda-514f-4981-b9ec-034fb5971da2"]
}, Closed]],
Cell[CellGroupData[{
Cell[304853, 7069, 904, 13, 37, "Subsubsection",ExpressionUUID->"c4bf4a22-1fb3-4cd7-be28-c8cf21aed1d3"],
Cell[305760, 7084, 310, 8, 44, "Input",ExpressionUUID->"94a51ca0-1645-4cb5-b34f-0e443fb3c90d",
 InitializationCell->True],
Cell[306073, 7094, 935, 22, 123, "Input",ExpressionUUID->"5c4b2203-14f0-4922-97c3-b207025ad020",
 InitializationCell->True],
Cell[307011, 7118, 2694, 65, 283, "Input",ExpressionUUID->"1157439b-0fe5-4392-a9a3-ea4c75eb86da"],
Cell[309708, 7185, 475, 12, 44, "Input",ExpressionUUID->"f5c24aa4-e1c5-4d76-847b-57e23bb85bc2",
 InitializationCell->True],
Cell[310186, 7199, 966, 16, 68, "Input",ExpressionUUID->"87c00d1d-4158-487e-a16a-a21a5dd47fd0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[311189, 7220, 983, 13, 45, "Subsubsection",ExpressionUUID->"ee572be8-8c03-4a09-907f-06003f363967"],
Cell[312175, 7235, 592, 14, 88, "Input",ExpressionUUID->"91eea689-506b-41b5-875e-2f27d78a561a"]
}, Closed]],
Cell[CellGroupData[{
Cell[312804, 7254, 1035, 14, 37, "Subsubsection",ExpressionUUID->"d7bfcedc-43ef-4b44-844c-48683cb9456b"],
Cell[313842, 7270, 545, 14, 68, "Input",ExpressionUUID->"fdd4d390-d31c-4ed3-bcd8-d8fd8e99e010"]
}, Open  ]],
Cell[CellGroupData[{
Cell[314424, 7289, 1014, 14, 45, "Subsubsection",ExpressionUUID->"432b72e5-5852-41e2-b768-0e434b3e88ec"],
Cell[315441, 7305, 2419, 61, 283, "Input",ExpressionUUID->"5d051d12-354d-4b05-a973-c88283477d86"],
Cell[317863, 7368, 1098, 19, 164, "Abstract",ExpressionUUID->"b4120ef9-a2f5-499e-aa5b-c4352410fd45"],
Cell[318964, 7389, 1107, 20, 84, "Input",ExpressionUUID->"aea4a4c2-a499-43a3-9594-5836922b88e9",
 InitializationCell->True],
Cell[320074, 7411, 4510, 118, 497, "Input",ExpressionUUID->"c23e50e9-64e5-41cb-9bcb-99eb6baee35e"],
Cell[324587, 7531, 652, 15, 104, "Input",ExpressionUUID->"4ba87c9e-71f1-4f79-957f-ebc150cdbc28",
 InitializationCell->True],
Cell[325242, 7548, 7252, 181, 887, "Input",ExpressionUUID->"7a6bee2f-dc00-44cb-8166-744217ad11fc"],
Cell[332497, 7731, 998, 17, 68, "Input",ExpressionUUID->"849eff91-8ce3-4723-8f7f-5f800ed9aef2"],
Cell[333498, 7750, 1407, 28, 127, "Input",ExpressionUUID->"4af071a5-ae57-4d8c-b3ae-0a4155b30b84"],
Cell[334908, 7780, 1140, 19, 68, "Input",ExpressionUUID->"d0b5b111-d287-4dae-a628-b455736b8297"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[336109, 7806, 622, 9, 67, "Section",ExpressionUUID->"f7a0c101-cc0e-47ca-b791-d508d42a5216"],
Cell[336734, 7817, 3767, 72, 244, "Input",ExpressionUUID->"f15f7b0c-8708-4841-aaa8-d150f94aa333"]
}, Closed]]
}
]
*)

